/*! For license information please see sdk.client.min.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.sdkClient=t():e.sdkClient=t()}(self,(()=>(()=>{var e={3570:e=>{function t(){}e.exports=function(e,r,n){var o=!1;return n=n||t,i.count=e,0===e?r():i;function i(e,t){if(i.count<=0)throw new Error("after called too many times");--i.count,e?(o=!0,r(e),r=n):0!==i.count||o||r(null,t)}}},1393:e=>{e.exports=function(e,t,r){var n=e.byteLength;if(t=t||0,r=r||n,e.slice)return e.slice(t,r);if(t<0&&(t+=n),r<0&&(r+=n),r>n&&(r=n),t>=n||t>=r||0===n)return new ArrayBuffer(0);for(var o=new Uint8Array(e),i=new Uint8Array(r-t),a=t,s=0;a<r;a++,s++)i[s]=o[a];return i.buffer}},9499:(e,t,r)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===n(i)?i:String(i)),o)}var i}Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=void 0;var i=r(1373),a="awaitqueue",s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t?(this._debug=(0,i.default)("".concat(a,":").concat(t)),this._warn=(0,i.default)("".concat(a,":WARN:").concat(t)),this._error=(0,i.default)("".concat(a,":ERROR:").concat(t))):(this._debug=(0,i.default)(a),this._warn=(0,i.default)("".concat(a,":WARN")),this._error=(0,i.default)("".concat(a,":ERROR"))),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}var t,r;return t=e,(r=[{key:"debug",get:function(){return this._debug}},{key:"warn",get:function(){return this._warn}},{key:"error",get:function(){return this._error}}])&&o(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.Logger=s},4547:(e,t,r)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(){o=function(){return t};var e,t={},r=Object.prototype,i=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",p=s.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof b?t:b,i=Object.create(o.prototype),s=new D(n||[]);return a(i,"_invoke",{value:O(e,r,s)}),i}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var h="suspendedStart",m="suspendedYield",v="executing",y="completed",g={};function b(){}function w(){}function _(){}var S={};l(S,c,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(L([])));x&&x!==r&&i.call(x,c)&&(S=x);var R=_.prototype=b.prototype=Object.create(S);function P(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(o,a,s,c){var u=f(e[o],e,a);if("throw"!==u.type){var p=u.arg,l=p.value;return l&&"object"==n(l)&&i.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):t.resolve(l).then((function(e){p.value=e,s(p)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var o;a(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var o=h;return function(i,a){if(o===v)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=E(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?y:m,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function E(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,E(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(i.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(n(t)+" is not iterable")}return w.prototype=_,a(R,"constructor",{value:_,configurable:!0}),a(_,"constructor",{value:w,configurable:!0}),w.displayName=l(_,p,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,l(e,p,"GeneratorFunction")),e.prototype=Object.create(R),e},t.awrap=function(e){return{__await:e}},P(C.prototype),l(C.prototype,u,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new C(d(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},P(R),l(R,p,"Generator"),l(R,c,(function(){return this})),l(R,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){if(e){if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function u(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){c(i,n,o,a,s,"next",e)}function s(e){c(i,n,o,a,s,"throw",e)}a(void 0)}))}}function p(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===n(i)?i:String(i)),o)}var i}function l(e,t,r){return t&&p(e.prototype,t),r&&p(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}function h(e){var t=g();return function(){var r,o=w(e);if(t){var i=w(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return m(e)}(this,r)}}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e){var t="function"==typeof Map?new Map:void 0;return v=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return y(e,arguments,w(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),b(r,e)},v(e)}function y(e,t,r){return y=g()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&b(o,r.prototype),o},y.apply(null,arguments)}function g(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function b(e,t){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},b(e,t)}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.AwaitQueue=t.AwaitQueueRemovedTaskError=t.AwaitQueueStoppedError=void 0;var _=new(r(9499).Logger),S=function(e){f(r,e);var t=h(r);function r(e){var n;return d(this,r),(n=t.call(this,null!=e?e:"AwaitQueue stopped")).name="AwaitQueueStoppedError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(m(n),r),n}return l(r)}(v(Error));t.AwaitQueueStoppedError=S;var k=function(e){f(r,e);var t=h(r);function r(e){var n;return d(this,r),(n=t.call(this,null!=e?e:"AwaitQueue task removed")).name="AwaitQueueRemovedTaskError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(m(n),r),n}return l(r)}(v(Error));t.AwaitQueueRemovedTaskError=k;var x=function(){function e(){d(this,e),this.pendingTasks=new Map,this.nextTaskId=0,this.stopping=!1}var t,r;return l(e,[{key:"size",get:function(){return this.pendingTasks.size}},{key:"push",value:(r=u(o().mark((function e(t,r){var n,a=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null!==(n=r)&&void 0!==n?n:t.name,_.debug("push() [name:".concat(r,"]")),"function"==typeof t){e.next=4;break}throw new TypeError("given task is not a function");case 4:if(r)try{Object.defineProperty(t,"name",{value:r})}catch(e){}return e.abrupt("return",new Promise((function(e,n){var o={id:a.nextTaskId++,task:t,name:r,enqueuedAt:Date.now(),executedAt:void 0,completed:!1,resolve:function(t){if(!o.completed){o.completed=!0,a.pendingTasks.delete(o.id),_.debug("resolving task [name:".concat(o.name,"]")),e(t);var r=i(a.pendingTasks.values(),1)[0];r&&!r.executedAt&&a.execute(r)}},reject:function(e){if(!o.completed&&(o.completed=!0,a.pendingTasks.delete(o.id),_.debug("rejecting task [name:".concat(o.name,"]: %s"),String(e)),n(e),!a.stopping)){var t=i(a.pendingTasks.values(),1)[0];t&&!t.executedAt&&a.execute(t)}}};a.pendingTasks.set(o.id,o),1===a.pendingTasks.size&&a.execute(o)})));case 6:case"end":return e.stop()}}),e)}))),function(e,t){return r.apply(this,arguments)})},{key:"stop",value:function(){_.debug("stop()"),this.stopping=!0;var e,t=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=a(e))){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw i}}}}(this.pendingTasks.values());try{for(t.s();!(e=t.n()).done;){var r=e.value;_.debug("stop() | stopping task [name:".concat(r.name,"]")),r.reject(new S)}}catch(e){t.e(e)}finally{t.f()}this.stopping=!1}},{key:"remove",value:function(e){_.debug("remove() [taskIdx:".concat(e,"]"));var t=Array.from(this.pendingTasks.values())[e];t?t.reject(new k):_.debug("stop() | no task with given idx [taskIdx:".concat(e,"]"))}},{key:"dump",value:function(){var e=Date.now(),t=0;return Array.from(this.pendingTasks.values()).map((function(r){return{idx:t++,task:r.task,name:r.name,enqueuedTime:r.executedAt?r.executedAt-r.enqueuedAt:e-r.enqueuedAt,executionTime:r.executedAt?e-r.executedAt:0}}))}},{key:"execute",value:(t=u(o().mark((function e(t){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_.debug("execute() [name:".concat(t.name,"]")),!t.executedAt){e.next=3;break}throw new Error("task already being executed");case 3:return t.executedAt=Date.now(),e.prev=4,e.next=7,t.task();case 7:r=e.sent,t.resolve(r),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),t.reject(e.t0);case 14:case"end":return e.stop()}}),e,null,[[4,11]])}))),function(e){return t.apply(this,arguments)})}]),e}();t.AwaitQueue=x},1433:e=>{function t(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=t,t.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-r:e+r}return 0|Math.min(e,this.max)},t.prototype.reset=function(){this.attempts=0},t.prototype.setMin=function(e){this.ms=e},t.prototype.setMax=function(e){this.max=e},t.prototype.setJitter=function(e){this.jitter=e}},4107:(e,t)=>{!function(e){"use strict";t.encode=function(t){var r,n=new Uint8Array(t),o=n.length,i="";for(r=0;r<o;r+=3)i+=e[n[r]>>2],i+=e[(3&n[r])<<4|n[r+1]>>4],i+=e[(15&n[r+1])<<2|n[r+2]>>6],i+=e[63&n[r+2]];return o%3==2?i=i.substring(0,i.length-1)+"=":o%3==1&&(i=i.substring(0,i.length-2)+"=="),i},t.decode=function(t){var r,n,o,i,a,s=.75*t.length,c=t.length,u=0;"="===t[t.length-1]&&(s--,"="===t[t.length-2]&&s--);var p=new ArrayBuffer(s),l=new Uint8Array(p);for(r=0;r<c;r+=4)n=e.indexOf(t[r]),o=e.indexOf(t[r+1]),i=e.indexOf(t[r+2]),a=e.indexOf(t[r+3]),l[u++]=n<<2|o>>4,l[u++]=(15&o)<<4|i>>2,l[u++]=(3&i)<<6|63&a;return p}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},6845:e=>{var t=void 0!==t?t:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder,r=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),n=r&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),o=t&&t.prototype.append&&t.prototype.getBlob;function i(e){return e.map((function(e){if(e.buffer instanceof ArrayBuffer){var t=e.buffer;if(e.byteLength!==t.byteLength){var r=new Uint8Array(e.byteLength);r.set(new Uint8Array(t,e.byteOffset,e.byteLength)),t=r.buffer}return t}return e}))}function a(e,r){r=r||{};var n=new t;return i(e).forEach((function(e){n.append(e)})),r.type?n.getBlob(r.type):n.getBlob()}function s(e,t){return new Blob(i(e),t||{})}"undefined"!=typeof Blob&&(a.prototype=Blob.prototype,s.prototype=Blob.prototype),e.exports=r?n?Blob:s:o?a:void 0},3018:e=>{var t=[].slice;e.exports=function(e,r){if("string"==typeof r&&(r=e[r]),"function"!=typeof r)throw new Error("bind() requires a function");var n=t.call(arguments,2);return function(){return r.apply(e,n.concat(t.call(arguments)))}}},9932:e=>{function t(e){if(e)return function(e){for(var r in t.prototype)e[r]=t.prototype[r];return e}(e)}e.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},t.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r,n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var o=0;o<n.length;o++)if((r=n[o])===t||r.fn===t){n.splice(o,1);break}return 0===n.length&&delete this._callbacks["$"+e],this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),r=this._callbacks["$"+e],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(r){n=0;for(var o=(r=r.slice(0)).length;n<o;++n)r[n].apply(this,t)}return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length}},7121:e=>{e.exports=function(e,t){var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},1373:(e,t,r)=>{var n;t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),this.useColors){var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var n=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(n++,"%c"===e&&(o=n))})),t.splice(o,0,r)}},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){var e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(n=!1,function(){n||(n=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||function(){},e.exports=r(9293)(t),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},9293:(e,t,r)=>{function n(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}e.exports=function(e){function t(e){var r,n,i,a=null;function s(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];if(s.enabled){var i=s,a=Number(new Date),c=a-(r||a);i.diff=c,i.prev=r,i.curr=a,r=a,n[0]=t.coerce(n[0]),"string"!=typeof n[0]&&n.unshift("%O");var u=0;n[0]=n[0].replace(/%([a-zA-Z%])/g,(function(e,r){if("%%"===e)return"%";u++;var o=t.formatters[r];if("function"==typeof o){var a=n[u];e=o.call(i,a),n.splice(u,1),u--}return e})),t.formatArgs.call(i,n),(i.log||t.log).apply(i,n)}}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=o,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:function(){return null!==a?a:(n!==t.namespaces&&(n=t.namespaces,i=t.enabled(e)),i)},set:function(e){a=e}}),"function"==typeof t.init&&t.init(s),s}function o(e,r){var n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){var e=[].concat(n(t.names.map(i)),n(t.skips.map(i).map((function(e){return"-"+e})))).join(",");return t.enable(""),e},t.enable=function(e){var r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];var n=("string"==typeof e?e:"").split(/[\s,]+/),o=n.length;for(r=0;r<o;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(9622),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((function(r){t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){for(var r=0,n=0;n<e.length;n++)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},2980:e=>{e.exports="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")()},2829:(e,t,r)=>{e.exports=r(3828),e.exports.parser=r(9059)},3828:(e,t,r)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}var o=r(1370),i=r(9932),a=r(5550)("engine.io-client:socket"),s=r(3896),c=r(9059),u=r(5276),p=r(4641);function l(e,t){if(!(this instanceof l))return new l(e,t);t=t||{},e&&"object"===n(e)&&(t=e,e=null),e?(e=u(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=u(t.host).host),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=p.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.withCredentials=!1!==t.withCredentials,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||void 0,this.key=t.key||void 0,this.passphrase=t.passphrase||void 0,this.cert=t.cert||void 0,this.ca=t.ca||void 0,this.ciphers=t.ciphers||void 0,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"==typeof self||this.isReactNative)&&(t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}e.exports=l,l.priorWebsocketSuccess=!1,i(l.prototype),l.protocol=c.protocol,l.Socket=l,l.Transport=r(6008),l.transports=r(1370),l.parser=r(9059),l.prototype.createTransport=function(e){a('creating transport "%s"',e);var t=function(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t}(this.query);t.EIO=c.protocol,t.transport=e;var r=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new o[e]({query:t,socket:this,agent:r.agent||this.agent,hostname:r.hostname||this.hostname,port:r.port||this.port,secure:r.secure||this.secure,path:r.path||this.path,forceJSONP:r.forceJSONP||this.forceJSONP,jsonp:r.jsonp||this.jsonp,forceBase64:r.forceBase64||this.forceBase64,enablesXDR:r.enablesXDR||this.enablesXDR,withCredentials:r.withCredentials||this.withCredentials,timestampRequests:r.timestampRequests||this.timestampRequests,timestampParam:r.timestampParam||this.timestampParam,policyPort:r.policyPort||this.policyPort,pfx:r.pfx||this.pfx,key:r.key||this.key,passphrase:r.passphrase||this.passphrase,cert:r.cert||this.cert,ca:r.ca||this.ca,ciphers:r.ciphers||this.ciphers,rejectUnauthorized:r.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:r.perMessageDeflate||this.perMessageDeflate,extraHeaders:r.extraHeaders||this.extraHeaders,forceNode:r.forceNode||this.forceNode,localAddress:r.localAddress||this.localAddress,requestTimeout:r.requestTimeout||this.requestTimeout,protocols:r.protocols||void 0,isReactNative:this.isReactNative})},l.prototype.open=function(){var e;if(this.rememberUpgrade&&l.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout((function(){t.emit("error","No transports available")}),0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},l.prototype.setTransport=function(e){a("setting transport %s",e.name);var t=this;this.transport&&(a("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",(function(){t.onDrain()})).on("packet",(function(e){t.onPacket(e)})).on("error",(function(e){t.onError(e)})).on("close",(function(){t.onClose("transport close")}))},l.prototype.probe=function(e){a('probing transport "%s"',e);var t=this.createTransport(e,{probe:1}),r=!1,n=this;function o(){if(n.onlyBinaryUpgrades){var o=!this.supportsBinary&&n.transport.supportsBinary;r=r||o}r||(a('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",(function(o){if(!r)if("pong"===o.type&&"probe"===o.data){if(a('probe transport "%s" pong',e),n.upgrading=!0,n.emit("upgrading",t),!t)return;l.priorWebsocketSuccess="websocket"===t.name,a('pausing current transport "%s"',n.transport.name),n.transport.pause((function(){r||"closed"!==n.readyState&&(a("changing transport and sending upgrade packet"),d(),n.setTransport(t),t.send([{type:"upgrade"}]),n.emit("upgrade",t),t=null,n.upgrading=!1,n.flush())}))}else{a('probe transport "%s" failed',e);var i=new Error("probe error");i.transport=t.name,n.emit("upgradeError",i)}})))}function i(){r||(r=!0,d(),t.close(),t=null)}function s(r){var o=new Error("probe error: "+r);o.transport=t.name,i(),a('probe transport "%s" failed because of error: %s',e,r),n.emit("upgradeError",o)}function c(){s("transport closed")}function u(){s("socket closed")}function p(e){t&&e.name!==t.name&&(a('"%s" works - aborting "%s"',e.name,t.name),i())}function d(){t.removeListener("open",o),t.removeListener("error",s),t.removeListener("close",c),n.removeListener("close",u),n.removeListener("upgrading",p)}l.priorWebsocketSuccess=!1,t.once("open",o),t.once("error",s),t.once("close",c),this.once("close",u),this.once("upgrading",p),t.open()},l.prototype.onOpen=function(){if(a("socket open"),this.readyState="open",l.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){a("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},l.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(a('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else a('packet received with socket readyState "%s"',this.readyState)},l.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},l.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout((function(){"closed"!==t.readyState&&t.onClose("ping timeout")}),e||t.pingInterval+t.pingTimeout)},l.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout((function(){a("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)}),e.pingInterval)},l.prototype.ping=function(){var e=this;this.sendPacket("ping",(function(){e.emit("ping")}))},l.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},l.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(a("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},l.prototype.write=l.prototype.send=function(e,t,r){return this.sendPacket("message",e,t,r),this},l.prototype.sendPacket=function(e,t,r,n){if("function"==typeof t&&(n=t,t=void 0),"function"==typeof r&&(n=r,r=null),"closing"!==this.readyState&&"closed"!==this.readyState){(r=r||{}).compress=!1!==r.compress;var o={type:e,data:t,options:r};this.emit("packetCreate",o),this.writeBuffer.push(o),n&&this.once("flush",n),this.flush()}},l.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var e=this;this.writeBuffer.length?this.once("drain",(function(){this.upgrading?n():t()})):this.upgrading?n():t()}function t(){e.onClose("forced close"),a("socket closing - telling transport to close"),e.transport.close()}function r(){e.removeListener("upgrade",r),e.removeListener("upgradeError",r),t()}function n(){e.once("upgrade",r),e.once("upgradeError",r)}return this},l.prototype.onError=function(e){a("socket error %j",e),l.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},l.prototype.onClose=function(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(a('socket close with reason: "%s"',e),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)},l.prototype.filterUpgrades=function(e){for(var t=[],r=0,n=e.length;r<n;r++)~s(this.transports,e[r])&&t.push(e[r]);return t}},6008:(e,t,r)=>{var n=r(9059),o=r(9932);function i(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.isReactNative=e.isReactNative,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}e.exports=i,o(i.prototype),i.prototype.onError=function(e,t){var r=new Error(e);return r.type="TransportError",r.description=t,this.emit("error",r),this},i.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},i.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},i.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},i.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},i.prototype.onData=function(e){var t=n.decodePacket(e,this.socket.binaryType);this.onPacket(t)},i.prototype.onPacket=function(e){this.emit("packet",e)},i.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},1370:(e,t,r)=>{var n=r(2232),o=r(6898),i=r(8948),a=r(7539);t.polling=function(e){var t=!1,r=!1,a=!1!==e.jsonp;if("undefined"!=typeof location){var s="https:"===location.protocol,c=location.port;c||(c=s?443:80),t=e.hostname!==location.hostname||c!==e.port,r=e.secure!==s}if(e.xdomain=t,e.xscheme=r,"open"in new n(e)&&!e.forceJSONP)return new o(e);if(!a)throw new Error("JSONP disabled");return new i(e)},t.websocket=a},8948:(e,t,r)=>{var n=r(2054),o=r(7121),i=r(2980);e.exports=p;var a,s=/\n/g,c=/\\n/g;function u(){}function p(e){n.call(this,e),this.query=this.query||{},a||(a=i.___eio=i.___eio||[]),this.index=a.length;var t=this;a.push((function(e){t.onData(e)})),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",(function(){t.script&&(t.script.onerror=u)}),!1)}o(p,n),p.prototype.supportsBinary=!1,p.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),n.prototype.doClose.call(this)},p.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var r=document.getElementsByTagName("script")[0];r?r.parentNode.insertBefore(t,r):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)}),100)},p.prototype.doWrite=function(e,t){var r=this;if(!this.form){var n,o=document.createElement("form"),i=document.createElement("textarea"),a=this.iframeId="eio_iframe_"+this.index;o.className="socketio",o.style.position="absolute",o.style.top="-1000px",o.style.left="-1000px",o.target=a,o.method="POST",o.setAttribute("accept-charset","utf-8"),i.name="d",o.appendChild(i),document.body.appendChild(o),this.form=o,this.area=i}function u(){p(),t()}function p(){if(r.iframe)try{r.form.removeChild(r.iframe)}catch(e){r.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+r.iframeId+'">';n=document.createElement(e)}catch(e){(n=document.createElement("iframe")).name=r.iframeId,n.src="javascript:0"}n.id=r.iframeId,r.form.appendChild(n),r.iframe=n}this.form.action=this.uri(),p(),e=e.replace(c,"\\\n"),this.area.value=e.replace(s,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===r.iframe.readyState&&u()}:this.iframe.onload=u}},6898:(e,t,r)=>{var n=r(2232),o=r(2054),i=r(9932),a=r(7121),s=r(5550)("engine.io-client:polling-xhr"),c=r(2980);function u(){}function p(e){if(o.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,"undefined"!=typeof location){var t="https:"===location.protocol,r=location.port;r||(r=t?443:80),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||r!==e.port,this.xs=e.secure!==t}}function l(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}function d(){for(var e in l.requests)l.requests.hasOwnProperty(e)&&l.requests[e].abort()}e.exports=p,e.exports.Request=l,a(p,o),p.prototype.supportsBinary=!0,p.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.withCredentials=this.withCredentials,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new l(e)},p.prototype.doWrite=function(e,t){var r="string"!=typeof e&&void 0!==e,n=this.request({method:"POST",data:e,isBinary:r}),o=this;n.on("success",t),n.on("error",(function(e){o.onError("xhr post error",e)})),this.sendXhr=n},p.prototype.doPoll=function(){s("xhr poll");var e=this.request(),t=this;e.on("data",(function(e){t.onData(e)})),e.on("error",(function(e){t.onError("xhr poll error",e)})),this.pollXhr=e},i(l.prototype),l.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new n(e),r=this;try{s("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var o in t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(o)&&t.setRequestHeader(o,this.extraHeaders[o])}catch(e){}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=this.withCredentials),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){r.onLoad()},t.onerror=function(){r.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState)try{var e=t.getResponseHeader("Content-Type");(r.supportsBinary&&"application/octet-stream"===e||"application/octet-stream; charset=UTF-8"===e)&&(t.responseType="arraybuffer")}catch(e){}4===t.readyState&&(200===t.status||1223===t.status?r.onLoad():setTimeout((function(){r.onError("number"==typeof t.status?t.status:0)}),0))},s("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout((function(){r.onError(e)}),0)}"undefined"!=typeof document&&(this.index=l.requestsCount++,l.requests[this.index]=this)},l.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},l.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},l.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},l.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=u:this.xhr.onreadystatechange=u,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete l.requests[this.index],this.xhr=null}},l.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e=("application/octet-stream"===t||"application/octet-stream; charset=UTF-8"===t)&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},l.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR},l.prototype.abort=function(){this.cleanup()},l.requestsCount=0,l.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",d):"function"==typeof addEventListener&&addEventListener("onpagehide"in c?"pagehide":"unload",d,!1))},2054:(e,t,r)=>{var n=r(6008),o=r(4641),i=r(9059),a=r(7121),s=r(1012),c=r(5550)("engine.io-client:polling");e.exports=p;var u=null!=new(r(2232))({xdomain:!1}).responseType;function p(e){var t=e&&e.forceBase64;u&&!t||(this.supportsBinary=!1),n.call(this,e)}a(p,n),p.prototype.name="polling",p.prototype.doOpen=function(){this.poll()},p.prototype.pause=function(e){var t=this;function r(){c("paused"),t.readyState="paused",e()}if(this.readyState="pausing",this.polling||!this.writable){var n=0;this.polling&&(c("we are currently polling - waiting to pause"),n++,this.once("pollComplete",(function(){c("pre-pause polling complete"),--n||r()}))),this.writable||(c("we are currently writing - waiting to pause"),n++,this.once("drain",(function(){c("pre-pause writing complete"),--n||r()})))}else r()},p.prototype.poll=function(){c("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},p.prototype.onData=function(e){var t=this;c("polling got data %s",e),i.decodePayload(e,this.socket.binaryType,(function(e,r,n){if("opening"===t.readyState&&"open"===e.type&&t.onOpen(),"close"===e.type)return t.onClose(),!1;t.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():c('ignoring poll - transport state "%s"',this.readyState))},p.prototype.doClose=function(){var e=this;function t(){c("writing close packet"),e.write([{type:"close"}])}"open"===this.readyState?(c("transport open - closing"),t()):(c("transport not open - deferring close"),this.once("open",t))},p.prototype.write=function(e){var t=this;this.writable=!1;var r=function(){t.writable=!0,t.emit("drain")};i.encodePayload(e,this.supportsBinary,(function(e){t.doWrite(e,r)}))},p.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",r="";return!1!==this.timestampRequests&&(e[this.timestampParam]=s()),this.supportsBinary||e.sid||(e.b64=1),e=o.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(r=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+r+this.path+e}},7539:(e,t,r)=>{var n,o,i=r(6008),a=r(9059),s=r(4641),c=r(7121),u=r(1012),p=r(5550)("engine.io-client:websocket");if("undefined"!=typeof WebSocket?n=WebSocket:"undefined"!=typeof self&&(n=self.WebSocket||self.MozWebSocket),"undefined"==typeof window)try{o=r(7020)}catch(e){}var l=n||o;function d(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=n&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(l=o),i.call(this,e)}e.exports=d,c(d,i),d.prototype.name="websocket",d.prototype.supportsBinary=!0,d.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,r={};this.isReactNative||(r.agent=this.agent,r.perMessageDeflate=this.perMessageDeflate,r.pfx=this.pfx,r.key=this.key,r.passphrase=this.passphrase,r.cert=this.cert,r.ca=this.ca,r.ciphers=this.ciphers,r.rejectUnauthorized=this.rejectUnauthorized),this.extraHeaders&&(r.headers=this.extraHeaders),this.localAddress&&(r.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?t?new l(e,t):new l(e):new l(e,t,r)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},d.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},d.prototype.write=function(e){var t=this;this.writable=!1;for(var r=e.length,n=0,o=r;n<o;n++)!function(e){a.encodePacket(e,t.supportsBinary,(function(n){if(!t.usingBrowserWebSocket){var o={};e.options&&(o.compress=e.options.compress),t.perMessageDeflate&&("string"==typeof n?Buffer.byteLength(n):n.length)<t.perMessageDeflate.threshold&&(o.compress=!1)}try{t.usingBrowserWebSocket?t.ws.send(n):t.ws.send(n,o)}catch(e){p("websocket closed before onclose event")}--r||(t.emit("flush"),setTimeout((function(){t.writable=!0,t.emit("drain")}),0))}))}(e[n])},d.prototype.onClose=function(){i.prototype.onClose.call(this)},d.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},d.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",r="";return this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(r=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=u()),this.supportsBinary||(e.b64=1),(e=s.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+r+this.path+e},d.prototype.check=function(){return!(!l||"__initialize"in l&&this.name===d.prototype.name)}},2232:(e,t,r)=>{var n=r(6971),o=r(2980);e.exports=function(e){var t=e.xdomain,r=e.xscheme,i=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||n))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!r&&i)return new XDomainRequest}catch(e){}if(!t)try{return new(o[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}},5550:(e,t,r)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(){var e;try{e=t.storage.debug}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e}(t=e.exports=r(705)).log=function(){return"object"===("undefined"==typeof console?"undefined":n(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var r=this.useColors;if(e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+t.humanize(this.diff),r){var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var o=0,i=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))})),e.splice(i,0,n)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=o,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(o())},705:(e,t,r)=>{function n(e){var r;function n(){if(n.enabled){var e=n,o=+new Date,i=o-(r||o);e.diff=i,e.prev=r,e.curr=o,r=o;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var c=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,(function(r,n){if("%%"===r)return r;c++;var o=t.formatters[n];if("function"==typeof o){var i=a[c];r=o.call(e,i),a.splice(c,1),c--}return r})),t.formatArgs.call(e,a),(n.log||t.log||console.log.bind(console)).apply(e,a)}}return n.namespace=e,n.enabled=t.enabled(e),n.useColors=t.useColors(),n.color=function(e){var r,n=0;for(r in e)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]}(e),n.destroy=o,"function"==typeof t.init&&t.init(n),t.instances.push(n),n}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=n.debug=n.default=n).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var r;t.save(e),t.names=[],t.skips=[];var n=("string"==typeof e?e:"").split(/[\s,]+/),o=n.length;for(r=0;r<o;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(r=0;r<t.instances.length;r++){var i=t.instances[r];i.enabled=t.enabled(i.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(4049),t.instances=[],t.names=[],t.skips=[],t.formatters={}},4049:e=>{function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}var r=1e3,n=60*r,o=60*n,i=24*o;function a(e,t,r){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}e.exports=function(e,s){s=s||{};var c,u=t(e);if("string"===u&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var a=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"days":case"day":case"d":return a*i;case"hours":case"hour":case"hrs":case"hr":case"h":return a*o;case"minutes":case"minute":case"mins":case"min":case"m":return a*n;case"seconds":case"second":case"secs":case"sec":case"s":return a*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}(e);if("number"===u&&!1===isNaN(e))return s.long?a(c=e,i,"day")||a(c,o,"hour")||a(c,n,"minute")||a(c,r,"second")||c+" ms":function(e){return e>=i?Math.round(e/i)+"d":e>=o?Math.round(e/o)+"h":e>=n?Math.round(e/n)+"m":e>=r?Math.round(e/r)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},9059:(e,t,r)=>{var n,o=r(7865),i=r(9398),a=r(1393),s=r(3570),c=r(719);"undefined"!=typeof ArrayBuffer&&(n=r(4107));var u="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),p="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),l=u||p;t.protocol=3;var d=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},f=o(d),h={type:"error",data:"parser error"},m=r(6845);function v(e,t,r){for(var n=new Array(e.length),o=s(e.length,r),i=function(e,r,o){t(r,(function(t,r){n[e]=r,o(t,n)}))},a=0;a<e.length;a++)i(a,e[a],o)}t.encodePacket=function(e,r,n,o){"function"==typeof r&&(o=r,r=!1),"function"==typeof n&&(o=n,n=null);var i=void 0===e.data?void 0:e.data.buffer||e.data;if("undefined"!=typeof ArrayBuffer&&i instanceof ArrayBuffer)return function(e,r,n){if(!r)return t.encodeBase64Packet(e,n);var o=e.data,i=new Uint8Array(o),a=new Uint8Array(1+o.byteLength);a[0]=d[e.type];for(var s=0;s<i.length;s++)a[s+1]=i[s];return n(a.buffer)}(e,r,o);if(void 0!==m&&i instanceof m)return function(e,r,n){if(!r)return t.encodeBase64Packet(e,n);if(l)return function(e,r,n){if(!r)return t.encodeBase64Packet(e,n);var o=new FileReader;return o.onload=function(){t.encodePacket({type:e.type,data:o.result},r,!0,n)},o.readAsArrayBuffer(e.data)}(e,r,n);var o=new Uint8Array(1);return o[0]=d[e.type],n(new m([o.buffer,e.data]))}(e,r,o);if(i&&i.base64)return function(e,r){return r("b"+t.packets[e.type]+e.data.data)}(e,o);var a=d[e.type];return void 0!==e.data&&(a+=n?c.encode(String(e.data),{strict:!1}):String(e.data)),o(""+a)},t.encodeBase64Packet=function(e,r){var n,o="b"+t.packets[e.type];if(void 0!==m&&e.data instanceof m){var i=new FileReader;return i.onload=function(){var e=i.result.split(",")[1];r(o+e)},i.readAsDataURL(e.data)}try{n=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(t){for(var a=new Uint8Array(e.data),s=new Array(a.length),c=0;c<a.length;c++)s[c]=a[c];n=String.fromCharCode.apply(null,s)}return o+=btoa(n),r(o)},t.decodePacket=function(e,r,n){if(void 0===e)return h;if("string"==typeof e){if("b"===e.charAt(0))return t.decodeBase64Packet(e.substr(1),r);if(n&&!1===(e=function(e){try{e=c.decode(e,{strict:!1})}catch(e){return!1}return e}(e)))return h;var o=e.charAt(0);return Number(o)==o&&f[o]?e.length>1?{type:f[o],data:e.substring(1)}:{type:f[o]}:h}o=new Uint8Array(e)[0];var i=a(e,1);return m&&"blob"===r&&(i=new m([i])),{type:f[o],data:i}},t.decodeBase64Packet=function(e,t){var r=f[e.charAt(0)];if(!n)return{type:r,data:{base64:!0,data:e.substr(1)}};var o=n.decode(e.substr(1));return"blob"===t&&m&&(o=new m([o])),{type:r,data:o}},t.encodePayload=function(e,r,n){"function"==typeof r&&(n=r,r=null);var o=i(e);return r&&o?m&&!l?t.encodePayloadAsBlob(e,n):t.encodePayloadAsArrayBuffer(e,n):e.length?void v(e,(function(e,n){t.encodePacket(e,!!o&&r,!1,(function(e){n(null,function(e){return e.length+":"+e}(e))}))}),(function(e,t){return n(t.join(""))})):n("0:")},t.decodePayload=function(e,r,n){if("string"!=typeof e)return t.decodePayloadAsBinary(e,r,n);var o;if("function"==typeof r&&(n=r,r=null),""===e)return n(h,0,1);for(var i,a,s="",c=0,u=e.length;c<u;c++){var p=e.charAt(c);if(":"===p){if(""===s||s!=(i=Number(s)))return n(h,0,1);if(s!=(a=e.substr(c+1,i)).length)return n(h,0,1);if(a.length){if(o=t.decodePacket(a,r,!1),h.type===o.type&&h.data===o.data)return n(h,0,1);if(!1===n(o,c+i,u))return}c+=i,s=""}else s+=p}return""!==s?n(h,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,r){if(!e.length)return r(new ArrayBuffer(0));v(e,(function(e,r){t.encodePacket(e,!0,!0,(function(e){return r(null,e)}))}),(function(e,t){var n=t.reduce((function(e,t){var r;return e+(r="string"==typeof t?t.length:t.byteLength).toString().length+r+2}),0),o=new Uint8Array(n),i=0;return t.forEach((function(e){var t="string"==typeof e,r=e;if(t){for(var n=new Uint8Array(e.length),a=0;a<e.length;a++)n[a]=e.charCodeAt(a);r=n.buffer}o[i++]=t?0:1;var s=r.byteLength.toString();for(a=0;a<s.length;a++)o[i++]=parseInt(s[a]);for(o[i++]=255,n=new Uint8Array(r),a=0;a<n.length;a++)o[i++]=n[a]})),r(o.buffer)}))},t.encodePayloadAsBlob=function(e,r){v(e,(function(e,r){t.encodePacket(e,!0,!0,(function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var n=new Uint8Array(e.length),o=0;o<e.length;o++)n[o]=e.charCodeAt(o);e=n.buffer,t[0]=0}var i=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),a=new Uint8Array(i.length+1);for(o=0;o<i.length;o++)a[o]=parseInt(i[o]);if(a[i.length]=255,m){var s=new m([t.buffer,a.buffer,e]);r(null,s)}}))}),(function(e,t){return r(new m(t))}))},t.decodePayloadAsBinary=function(e,r,n){"function"==typeof r&&(n=r,r=null);for(var o=e,i=[];o.byteLength>0;){for(var s=new Uint8Array(o),c=0===s[0],u="",p=1;255!==s[p];p++){if(u.length>310)return n(h,0,1);u+=s[p]}o=a(o,2+u.length),u=parseInt(u);var l=a(o,0,u);if(c)try{l=String.fromCharCode.apply(null,new Uint8Array(l))}catch(e){var d=new Uint8Array(l);for(l="",p=0;p<d.length;p++)l+=String.fromCharCode(d[p])}i.push(l),o=a(o,u)}var f=i.length;i.forEach((function(e,o){n(t.decodePacket(e,r,!0),o,f)}))}},7865:e=>{e.exports=Object.keys||function(e){var t=[],r=Object.prototype.hasOwnProperty;for(var n in e)r.call(e,n)&&t.push(n);return t}},719:e=>{var t,r,n,o=String.fromCharCode;function i(e){for(var t,r,n=[],o=0,i=e.length;o<i;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<i?56320==(64512&(r=e.charCodeAt(o++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),o--):n.push(t);return n}function a(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function s(e,t){return o(e>>t&63|128)}function c(e,t){if(0==(4294967168&e))return o(e);var r="";return 0==(4294965248&e)?r=o(e>>6&31|192):0==(4294901760&e)?(a(e,t)||(e=65533),r=o(e>>12&15|224),r+=s(e,6)):0==(4292870144&e)&&(r=o(e>>18&7|240),r+=s(e,12),r+=s(e,6)),r+o(63&e|128)}function u(){if(n>=r)throw Error("Invalid byte index");var e=255&t[n];if(n++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function p(e){var o,i;if(n>r)throw Error("Invalid byte index");if(n==r)return!1;if(o=255&t[n],n++,0==(128&o))return o;if(192==(224&o)){if((i=(31&o)<<6|u())>=128)return i;throw Error("Invalid continuation byte")}if(224==(240&o)){if((i=(15&o)<<12|u()<<6|u())>=2048)return a(i,e)?i:65533;throw Error("Invalid continuation byte")}if(240==(248&o)&&(i=(7&o)<<18|u()<<12|u()<<6|u())>=65536&&i<=1114111)return i;throw Error("Invalid UTF-8 detected")}e.exports={version:"2.1.2",encode:function(e,t){for(var r=!1!==(t=t||{}).strict,n=i(e),o=n.length,a=-1,s="";++a<o;)s+=c(n[a],r);return s},decode:function(e,a){var s=!1!==(a=a||{}).strict;t=i(e),r=t.length,n=0;for(var c,u=[];!1!==(c=p(s));)u.push(c);return function(e){for(var t,r=e.length,n=-1,i="";++n<r;)(t=e[n])>65535&&(i+=o((t-=65536)>>>10&1023|55296),t=56320|1023&t),i+=o(t);return i}(u)}}},9257:e=>{function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}var r=function(){if("object"===("undefined"==typeof self?"undefined":t(self))&&self)return self;if("object"===("undefined"==typeof window?"undefined":t(window))&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;if("object"===("undefined"==typeof globalThis?"undefined":t(globalThis))&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}()},5090:e=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}var r,n="object"===("undefined"==typeof Reflect?"undefined":t(Reflect))?Reflect:null,o=n&&"function"==typeof n.apply?n.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};r=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(e,t){return new Promise((function(r,n){function o(r){e.removeListener(t,i),n(r)}function i(){"function"==typeof e.removeListener&&e.removeListener("error",o),r([].slice.call(arguments))}v(e,t,i,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&v(e,"error",t,{once:!0})}(e,o)}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var s=10;function c(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+t(e))}function u(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function p(e,t,r,n){var o,i,a,s;if(c(r),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),a=i[t]),void 0===a)a=i[t]=r,++e._eventsCount;else if("function"==typeof a?a=i[t]=n?[r,a]:[a,r]:n?a.unshift(r):a.push(r),(o=u(e))>0&&a.length>o&&!a.warned){a.warned=!0;var p=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");p.name="MaxListenersExceededWarning",p.emitter=e,p.type=t,p.count=a.length,s=p,console&&console.warn&&console.warn(s)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},o=l.bind(n);return o.listener=r,n.wrapFn=o,o}function f(e,t,r){var n=e._events;if(void 0===n)return[];var o=n[t];return void 0===o?[]:"function"==typeof o?r?[o.listener||o]:[o]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(o):m(o,o.length)}function h(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function m(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function v(e,r,n,o){if("function"==typeof e.on)o.once?e.once(r,n):e.on(r,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+t(e));e.addEventListener(r,(function t(i){o.once&&e.removeEventListener(r,t),n(i)}))}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return u(this)},a.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var c=i[e];if(void 0===c)return!1;if("function"==typeof c)o(c,this,t);else{var u=c.length,p=m(c,u);for(r=0;r<u;++r)o(p[r],this,t)}return!0},a.prototype.addListener=function(e,t){return p(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return p(this,e,t,!0)},a.prototype.once=function(e,t){return c(t),this.on(e,d(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return c(t),this.prependListener(e,d(this,e,t)),this},a.prototype.removeListener=function(e,t){var r,n,o,i,a;if(c(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(o=-1,i=r.length-1;i>=0;i--)if(r[i]===t||r[i].listener===t){a=r[i].listener,o=i;break}if(o<0)return this;0===o?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,o),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,a||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var o,i=Object.keys(r);for(n=0;n<i.length;++n)"removeListener"!==(o=i[n])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},a.prototype.listeners=function(e){return f(this,e,!0)},a.prototype.rawListeners=function(e){return f(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},a.prototype.listenerCount=h,a.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},8205:(e,t,r)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===n(i)?i:String(i)),o)}var i}function i(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=r(1373)("h264-profile-level-id");s.log=console.info.bind(console),t.ProfileConstrainedBaseline=1,t.ProfileBaseline=2,t.ProfileMain=3,t.ProfileConstrainedHigh=4,t.ProfileHigh=5;t.Level1_b=0,t.Level1=10,t.Level1_1=11,t.Level1_2=12,t.Level1_3=13,t.Level2=20,t.Level2_1=21,t.Level2_2=22,t.Level3=30,t.Level3_1=31,t.Level3_2=32,t.Level4=40,t.Level4_1=41,t.Level4_2=42,t.Level5=50,t.Level5_1=51,t.Level5_2=52;var c=i((function e(t,r){a(this,e),this.profile=t,this.level=r}));t.ProfileLevelId=c;var u=new c(1,31),p=function(){function e(t){a(this,e),this._mask=~f("x",t),this._maskedValue=f("1",t)}return i(e,[{key:"isMatch",value:function(e){return this._maskedValue===(e&this._mask)}}]),e}(),l=i((function e(t,r,n){a(this,e),this.profile_idc=t,this.profile_iop=r,this.profile=n})),d=[new l(66,new p("x1xx0000"),1),new l(77,new p("1xxx0000"),1),new l(88,new p("11xx0000"),1),new l(66,new p("x0xx0000"),2),new l(88,new p("10xx0000"),2),new l(77,new p("0x0x0000"),3),new l(100,new p("00000000"),5),new l(100,new p("00001100"),4)];function f(e,t){return(t[0]===e)<<7|(t[1]===e)<<6|(t[2]===e)<<5|(t[3]===e)<<4|(t[4]===e)<<3|(t[5]===e)<<2|(t[6]===e)<<1|(t[7]===e)<<0}function h(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})["level-asymmetry-allowed"];return 1===e||"1"===e}t.parseProfileLevelId=function(e){if("string"!=typeof e||6!==e.length)return null;var t=parseInt(e,16);if(0===t)return null;var r,n=255&t,o=t>>8&255,i=t>>16&255;switch(n){case 11:r=0!=(16&o)?0:11;break;case 10:case 12:case 13:case 20:case 21:case 22:case 30:case 31:case 32:case 40:case 41:case 42:case 50:case 51:case 52:r=n;break;default:return s("parseProfileLevelId() | unrecognized level_idc:%s",n),null}for(var a=0,u=d;a<u.length;a++){var p=u[a];if(i===p.profile_idc&&p.profile_iop.isMatch(o))return new c(p.profile,r)}return s("parseProfileLevelId() | unrecognized profile_idc/profile_iop combination"),null},t.profileLevelIdToString=function(e){if(0==e.level)switch(e.profile){case 1:return"42f00b";case 2:return"42100b";case 3:return"4d100b";default:return s("profileLevelIdToString() | Level 1_b not is allowed for profile:%s",e.profile),null}var t;switch(e.profile){case 1:t="42e0";break;case 2:t="4200";break;case 3:t="4d00";break;case 4:t="640c";break;case 5:t="6400";break;default:return s("profileLevelIdToString() | unrecognized profile:%s",e.profile),null}var r=e.level.toString(16);return 1===r.length&&(r="0".concat(r)),"".concat(t).concat(r)},t.parseSdpProfileLevelId=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})["profile-level-id"];return e?t.parseProfileLevelId(e):u},t.isSameProfile=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.parseSdpProfileLevelId(e),o=t.parseSdpProfileLevelId(r);return Boolean(n&&o&&n.profile===o.profile)},t.generateProfileLevelIdForAnswer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e["profile-level-id"]&&!r["profile-level-id"])return s("generateProfileLevelIdForAnswer() | no profile-level-id in local and remote params"),null;var n=t.parseSdpProfileLevelId(e),o=t.parseSdpProfileLevelId(r);if(!n)throw new TypeError("invalid local_profile_level_id");if(!o)throw new TypeError("invalid remote_profile_level_id");if(n.profile!==o.profile)throw new TypeError("H264 Profile mismatch");var i,a,u=h(e)&&h(r),p=n.level,l=function(e,t){return 0===e?10!==t&&0!==t:0===t?10!==e:e<t}(i=p,a=o.level)?i:a,d=u?p:l;return s("generateProfileLevelIdForAnswer() | result: [profile:%s, level:%s]",n.profile,d),t.profileLevelIdToString(new c(n.profile,d))}},9398:(e,t,r)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}var o=r(4390),i=Object.prototype.toString,a="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===i.call(Blob),s="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===i.call(File);e.exports=function e(t){if(!t||"object"!==n(t))return!1;if(o(t)){for(var r=0,i=t.length;r<i;r++)if(e(t[r]))return!0;return!1}if("function"==typeof Buffer&&Buffer.isBuffer&&Buffer.isBuffer(t)||"function"==typeof ArrayBuffer&&t instanceof ArrayBuffer||a&&t instanceof Blob||s&&t instanceof File)return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return e(t.toJSON(),!0);for(var c in t)if(Object.prototype.hasOwnProperty.call(t,c)&&e(t[c]))return!0;return!1}},4390:e=>{var t={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==t.call(e)}},6971:e=>{try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},3896:e=>{var t=[].indexOf;e.exports=function(e,r){if(t)return e.indexOf(r);for(var n=0;n<e.length;++n)if(e[n]===r)return n;return-1}},9113:(e,t,r)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(){o=function(){return t};var e,t={},r=Object.prototype,i=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",p=s.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof b?t:b,i=Object.create(o.prototype),s=new D(n||[]);return a(i,"_invoke",{value:O(e,r,s)}),i}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var h="suspendedStart",m="suspendedYield",v="executing",y="completed",g={};function b(){}function w(){}function _(){}var S={};l(S,c,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(L([])));x&&x!==r&&i.call(x,c)&&(S=x);var R=_.prototype=b.prototype=Object.create(S);function P(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(o,a,s,c){var u=f(e[o],e,a);if("throw"!==u.type){var p=u.arg,l=p.value;return l&&"object"==n(l)&&i.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):t.resolve(l).then((function(e){p.value=e,s(p)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var o;a(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var o=h;return function(i,a){if(o===v)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=E(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?y:m,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function E(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,E(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(i.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(n(t)+" is not iterable")}return w.prototype=_,a(R,"constructor",{value:_,configurable:!0}),a(_,"constructor",{value:w,configurable:!0}),w.displayName=l(_,p,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,l(e,p,"GeneratorFunction")),e.prototype=Object.create(R),e},t.awrap=function(e){return{__await:e}},P(C.prototype),l(C.prototype,u,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new C(d(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},P(R),l(R,p,"Generator"),l(R,c,(function(){return this})),l(R,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function i(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function a(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===n(i)?i:String(i)),o)}var i}function s(e,t){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},s(e,t)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.Consumer=void 0;var p=r(1916),l=r(5324),d=r(6020),f=new p.Logger("Consumer"),h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(g,e);var t,r,p,h,m,v,y=(m=g,v=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=u(m);if(v){var r=u(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return c(e)}(this,e)});function g(e){var t,r=e.id,n=e.localId,o=e.producerId,i=e.rtpReceiver,a=e.track,s=e.rtpParameters,u=e.appData;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,g),(t=y.call(this))._closed=!1,t._observer=new l.EnhancedEventEmitter,f.debug("constructor()"),t._id=r,t._localId=n,t._producerId=o,t._rtpReceiver=i,t._track=a,t._rtpParameters=s,t._paused=!a.enabled,t._appData=u||{},t.onTrackEnded=t.onTrackEnded.bind(c(t)),t.handleTrack(),t}return t=g,r=[{key:"id",get:function(){return this._id}},{key:"localId",get:function(){return this._localId}},{key:"producerId",get:function(){return this._producerId}},{key:"closed",get:function(){return this._closed}},{key:"kind",get:function(){return this._track.kind}},{key:"rtpReceiver",get:function(){return this._rtpReceiver}},{key:"track",get:function(){return this._track}},{key:"rtpParameters",get:function(){return this._rtpParameters}},{key:"paused",get:function(){return this._paused}},{key:"appData",get:function(){return this._appData},set:function(e){this._appData=e}},{key:"observer",get:function(){return this._observer}},{key:"close",value:function(){this._closed||(f.debug("close()"),this._closed=!0,this.destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"))}},{key:"transportClosed",value:function(){this._closed||(f.debug("transportClosed()"),this._closed=!0,this.destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}},{key:"getStats",value:(p=o().mark((function e(){var t=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._closed){e.next=2;break}throw new d.InvalidStateError("closed");case 2:return e.abrupt("return",new Promise((function(e,r){t.safeEmit("@getstats",e,r)})));case 3:case"end":return e.stop()}}),e,this)})),h=function(){var e=this,t=arguments;return new Promise((function(r,n){var o=p.apply(e,t);function a(e){i(o,r,n,a,s,"next",e)}function s(e){i(o,r,n,a,s,"throw",e)}a(void 0)}))},function(){return h.apply(this,arguments)})},{key:"pause",value:function(){f.debug("pause()"),this._closed?f.error("pause() | Consumer closed"):this._paused?f.debug("pause() | Consumer is already paused"):(this._paused=!0,this._track.enabled=!1,this.emit("@pause"),this._observer.safeEmit("pause"))}},{key:"resume",value:function(){f.debug("resume()"),this._closed?f.error("resume() | Consumer closed"):this._paused?(this._paused=!1,this._track.enabled=!0,this.emit("@resume"),this._observer.safeEmit("resume")):f.debug("resume() | Consumer is already resumed")}},{key:"onTrackEnded",value:function(){f.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}},{key:"handleTrack",value:function(){this._track.addEventListener("ended",this.onTrackEnded)}},{key:"destroyTrack",value:function(){try{this._track.removeEventListener("ended",this.onTrackEnded),this._track.stop()}catch(e){}}}],r&&a(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),g}(l.EnhancedEventEmitter);t.Consumer=h},6503:(e,t,r)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===n(i)?i:String(i)),o)}var i}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function a(e){return a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},a(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.DataConsumer=void 0;var s=r(1916),c=r(5324),u=new s.Logger("DataConsumer"),p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(d,e);var t,r,s,p,l=(s=d,p=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=a(s);if(p){var r=a(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function d(e){var t,r=e.id,n=e.dataProducerId,o=e.dataChannel,i=e.sctpStreamParameters,a=e.appData;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(t=l.call(this))._closed=!1,t._observer=new c.EnhancedEventEmitter,u.debug("constructor()"),t._id=r,t._dataProducerId=n,t._dataChannel=o,t._sctpStreamParameters=i,t._appData=a||{},t.handleDataChannel(),t}return t=d,(r=[{key:"id",get:function(){return this._id}},{key:"dataProducerId",get:function(){return this._dataProducerId}},{key:"closed",get:function(){return this._closed}},{key:"sctpStreamParameters",get:function(){return this._sctpStreamParameters}},{key:"readyState",get:function(){return this._dataChannel.readyState}},{key:"label",get:function(){return this._dataChannel.label}},{key:"protocol",get:function(){return this._dataChannel.protocol}},{key:"binaryType",get:function(){return this._dataChannel.binaryType},set:function(e){this._dataChannel.binaryType=e}},{key:"appData",get:function(){return this._appData},set:function(e){this._appData=e}},{key:"observer",get:function(){return this._observer}},{key:"close",value:function(){this._closed||(u.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"))}},{key:"transportClosed",value:function(){this._closed||(u.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}},{key:"handleDataChannel",value:function(){var e=this;this._dataChannel.addEventListener("open",(function(){e._closed||(u.debug('DataChannel "open" event'),e.safeEmit("open"))})),this._dataChannel.addEventListener("error",(function(t){if(!e._closed){var r=t.error;r||(r=new Error("unknown DataChannel error")),"sctp-failure"===r.errorDetail?u.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",r.sctpCauseCode,r.message):u.error('DataChannel "error" event: %o',r),e.safeEmit("error",r)}})),this._dataChannel.addEventListener("close",(function(){e._closed||(u.warn('DataChannel "close" event'),e._closed=!0,e.emit("@close"),e.safeEmit("close"),e._observer.safeEmit("close"))})),this._dataChannel.addEventListener("message",(function(t){e._closed||e.safeEmit("message",t.data)}))}}])&&o(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),d}(c.EnhancedEventEmitter);t.DataConsumer=p},6487:(e,t,r)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===n(i)?i:String(i)),o)}var i}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function a(e){return a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},a(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.DataProducer=void 0;var s=r(1916),c=r(5324),u=r(6020),p=new s.Logger("DataProducer"),l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(f,e);var t,r,s,l,d=(s=f,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=a(s);if(l){var r=a(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function f(e){var t,r=e.id,n=e.dataChannel,o=e.sctpStreamParameters,i=e.appData;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(t=d.call(this))._closed=!1,t._observer=new c.EnhancedEventEmitter,p.debug("constructor()"),t._id=r,t._dataChannel=n,t._sctpStreamParameters=o,t._appData=i||{},t.handleDataChannel(),t}return t=f,(r=[{key:"id",get:function(){return this._id}},{key:"closed",get:function(){return this._closed}},{key:"sctpStreamParameters",get:function(){return this._sctpStreamParameters}},{key:"readyState",get:function(){return this._dataChannel.readyState}},{key:"label",get:function(){return this._dataChannel.label}},{key:"protocol",get:function(){return this._dataChannel.protocol}},{key:"bufferedAmount",get:function(){return this._dataChannel.bufferedAmount}},{key:"bufferedAmountLowThreshold",get:function(){return this._dataChannel.bufferedAmountLowThreshold},set:function(e){this._dataChannel.bufferedAmountLowThreshold=e}},{key:"appData",get:function(){return this._appData},set:function(e){this._appData=e}},{key:"observer",get:function(){return this._observer}},{key:"close",value:function(){this._closed||(p.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"))}},{key:"transportClosed",value:function(){this._closed||(p.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}},{key:"send",value:function(e){if(p.debug("send()"),this._closed)throw new u.InvalidStateError("closed");this._dataChannel.send(e)}},{key:"handleDataChannel",value:function(){var e=this;this._dataChannel.addEventListener("open",(function(){e._closed||(p.debug('DataChannel "open" event'),e.safeEmit("open"))})),this._dataChannel.addEventListener("error",(function(t){if(!e._closed){var r=t.error;r||(r=new Error("unknown DataChannel error")),"sctp-failure"===r.errorDetail?p.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",r.sctpCauseCode,r.message):p.error('DataChannel "error" event: %o',r),e.safeEmit("error",r)}})),this._dataChannel.addEventListener("close",(function(){e._closed||(p.warn('DataChannel "close" event'),e._closed=!0,e.emit("@close"),e.safeEmit("close"),e._observer.safeEmit("close"))})),this._dataChannel.addEventListener("message",(function(){e._closed||p.warn('DataChannel "message" event in a DataProducer, message discarded')})),this._dataChannel.addEventListener("bufferedamountlow",(function(){e._closed||e.safeEmit("bufferedamountlow")}))}}])&&o(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),f}(c.EnhancedEventEmitter);t.DataProducer=l},8630:function(e,t,r){"use strict";function n(){n=function(){return t};var e,t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",p=s.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof b?t:b,a=Object.create(o.prototype),s=new D(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var h="suspendedStart",m="suspendedYield",v="executing",y="completed",g={};function b(){}function w(){}function _(){}var S={};l(S,c,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(L([])));x&&x!==r&&o.call(x,c)&&(S=x);var R=_.prototype=b.prototype=Object.create(S);function P(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(n,i,s,c){var u=f(e[n],e,i);if("throw"!==u.type){var p=u.arg,l=p.value;return l&&"object"==a(l)&&o.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):t.resolve(l).then((function(e){p.value=e,s(p)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var n;i(this,"_invoke",{value:function(e,o){function i(){return new t((function(t,n){r(e,o,t,n)}))}return n=n?n.then(i,i):i()}})}function O(t,r,n){var o=h;return function(i,a){if(o===v)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=E(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?y:m,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function E(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,E(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function r(){for(;++n<t.length;)if(o.call(t,n))return r.value=t[n],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(a(t)+" is not iterable")}return w.prototype=_,i(R,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:w,configurable:!0}),w.displayName=l(_,p,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,l(e,p,"GeneratorFunction")),e.prototype=Object.create(R),e},t.awrap=function(e){return{__await:e}},P(C.prototype),l(C.prototype,u,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new C(d(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},P(R),l(R,p,"Generator"),l(R,c,(function(){return this})),l(R,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function o(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===a(o)?o:String(o)),n)}var o}function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}var s=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),c=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&s(t,e,r);return c(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Device=t.detectDevice=void 0;var p=r(7492),l=r(1916),d=r(5324),f=r(6020),h=u(r(5234)),m=u(r(6059)),v=r(2683),y=r(270),g=r(5031),b=r(6988),w=r(5149),_=r(3261),S=r(246),k=r(3614),x=r(6893),R=r(7042),P=r(2295),C=r(463),O=new l.Logger("Device");function E(){if("object"===("undefined"==typeof navigator?"undefined":a(navigator))&&"ReactNative"===navigator.product)return O.debug("detectDevice() | React-Native detected"),"undefined"==typeof RTCPeerConnection?void O.warn("detectDevice() | unsupported react-native-webrtc without RTCPeerConnection, forgot to call registerGlobals()?"):"undefined"!=typeof RTCRtpTransceiver?(O.debug("detectDevice() | ReactNative UnifiedPlan handler chosen"),"ReactNativeUnifiedPlan"):(O.debug("detectDevice() | ReactNative PlanB handler chosen"),"ReactNative");if("object"!==("undefined"==typeof navigator?"undefined":a(navigator))||"string"!=typeof navigator.userAgent)O.warn("detectDevice() | unknown device");else{var e,t,r,n,o,i,s=navigator.userAgent,c=new p.UAParser(s);O.debug("detectDevice() | browser detected [ua:%s, parsed:%o]",s,c.getResult());var u=c.getBrowser(),l=null===(e=u.name)||void 0===e?void 0:e.toLowerCase(),d=parseInt(null!==(t=u.major)&&void 0!==t?t:"0"),f=null===(r=c.getEngine().name)||void 0===r?void 0:r.toLowerCase(),h=c.getOS(),m=null===(n=h.name)||void 0===n?void 0:n.toLowerCase(),v=parseFloat(null!==(o=h.version)&&void 0!==o?o:"0"),y=null===(i=c.getDevice().model)||void 0===i?void 0:i.toLowerCase(),g="ios"===m||"ipad"===y,b=l&&["chrome","chromium","mobile chrome","chrome webview","chrome headless"].includes(l),w=l&&["firefox","mobile firefox","mobile focus"].includes(l),_=l&&["safari","mobile safari"].includes(l),S=l&&["edge"].includes(l);if((b||S)&&!g&&d>=111)return"Chrome111";if(b&&!g&&d>=74||S&&!g&&d>=88)return"Chrome74";if(b&&!g&&d>=70)return"Chrome70";if(b&&!g&&d>=67)return"Chrome67";if(b&&!g&&d>=55)return"Chrome55";if(w&&!g&&d>=60)return"Firefox60";if(w&&g&&v>=14.3)return"Safari12";if(_&&d>=12&&"undefined"!=typeof RTCRtpTransceiver&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(_&&d>=11)return"Safari11";if(S&&!g&&d>=11&&d<=18)return"Edge11";if("webkit"===f&&g&&"undefined"!=typeof RTCRtpTransceiver&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if("blink"===f){var k=s.match(/(?:(?:Chrome|Chromium))[ /](\w+)/i);if(k){var x=Number(k[1]);return x>=111?"Chrome111":x>=74?"Chrome74":x>=70?"Chrome70":x>=67?"Chrome67":"Chrome55"}return"Chrome111"}O.warn("detectDevice() | browser not supported [name:%s, version:%s]",l,d)}}t.detectDevice=E;var T=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.handlerName,n=t.handlerFactory,o=t.Handler;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._loaded=!1,this._observer=new d.EnhancedEventEmitter,O.debug("constructor()"),o){if(O.warn("constructor() | Handler option is DEPRECATED, use handlerName or handlerFactory instead"),"string"!=typeof o)throw new TypeError("non string Handler option no longer supported, use handlerFactory instead");r=o}if(r&&n)throw new TypeError("just one of handlerName or handlerInterface can be given");if(n)this._handlerFactory=n;else{if(r)O.debug("constructor() | handler given: %s",r);else{if(!(r=E()))throw new f.UnsupportedError("device not supported");O.debug("constructor() | detected handler: %s",r)}switch(r){case"Chrome111":this._handlerFactory=y.Chrome111.createFactory();break;case"Chrome74":this._handlerFactory=g.Chrome74.createFactory();break;case"Chrome70":this._handlerFactory=b.Chrome70.createFactory();break;case"Chrome67":this._handlerFactory=w.Chrome67.createFactory();break;case"Chrome55":this._handlerFactory=_.Chrome55.createFactory();break;case"Firefox60":this._handlerFactory=S.Firefox60.createFactory();break;case"Safari12":this._handlerFactory=k.Safari12.createFactory();break;case"Safari11":this._handlerFactory=x.Safari11.createFactory();break;case"Edge11":this._handlerFactory=R.Edge11.createFactory();break;case"ReactNativeUnifiedPlan":this._handlerFactory=P.ReactNativeUnifiedPlan.createFactory();break;case"ReactNative":this._handlerFactory=C.ReactNative.createFactory();break;default:throw new TypeError('unknown handlerName "'.concat(r,'"'))}}var i=this._handlerFactory();this._handlerName=i.name,i.close(),this._extendedRtpCapabilities=void 0,this._recvRtpCapabilities=void 0,this._canProduceByKind={audio:!1,video:!1},this._sctpCapabilities=void 0}var t,r,s,c;return t=e,r=[{key:"handlerName",get:function(){return this._handlerName}},{key:"loaded",get:function(){return this._loaded}},{key:"rtpCapabilities",get:function(){if(!this._loaded)throw new f.InvalidStateError("not loaded");return this._recvRtpCapabilities}},{key:"sctpCapabilities",get:function(){if(!this._loaded)throw new f.InvalidStateError("not loaded");return this._sctpCapabilities}},{key:"observer",get:function(){return this._observer}},{key:"load",value:(s=n().mark((function e(t){var r,o,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.routerRtpCapabilities,O.debug("load() [routerRtpCapabilities:%o]",r),r=h.clone(r),e.prev=3,!this._loaded){e.next=6;break}throw new f.InvalidStateError("already loaded");case 6:return m.validateRtpCapabilities(r),o=this._handlerFactory(),e.next=10,o.getNativeRtpCapabilities();case 10:return i=e.sent,O.debug("load() | got native RTP capabilities:%o",i),m.validateRtpCapabilities(i),this._extendedRtpCapabilities=m.getExtendedRtpCapabilities(i,r),O.debug("load() | got extended RTP capabilities:%o",this._extendedRtpCapabilities),this._canProduceByKind.audio=m.canSend("audio",this._extendedRtpCapabilities),this._canProduceByKind.video=m.canSend("video",this._extendedRtpCapabilities),this._recvRtpCapabilities=m.getRecvRtpCapabilities(this._extendedRtpCapabilities),m.validateRtpCapabilities(this._recvRtpCapabilities),O.debug("load() | got receiving RTP capabilities:%o",this._recvRtpCapabilities),e.next=22,o.getNativeSctpCapabilities();case 22:this._sctpCapabilities=e.sent,O.debug("load() | got native SCTP capabilities:%o",this._sctpCapabilities),m.validateSctpCapabilities(this._sctpCapabilities),O.debug("load() succeeded"),this._loaded=!0,o.close(),e.next=34;break;case 30:throw e.prev=30,e.t0=e.catch(3),o&&o.close(),e.t0;case 34:case"end":return e.stop()}}),e,this,[[3,30]])})),c=function(){var e=this,t=arguments;return new Promise((function(r,n){var i=s.apply(e,t);function a(e){o(i,r,n,a,c,"next",e)}function c(e){o(i,r,n,a,c,"throw",e)}a(void 0)}))},function(e){return c.apply(this,arguments)})},{key:"canProduce",value:function(e){if(!this._loaded)throw new f.InvalidStateError("not loaded");if("audio"!==e&&"video"!==e)throw new TypeError('invalid kind "'.concat(e,'"'));return this._canProduceByKind[e]}},{key:"createSendTransport",value:function(e){var t=e.id,r=e.iceParameters,n=e.iceCandidates,o=e.dtlsParameters,i=e.sctpParameters,a=e.iceServers,s=e.iceTransportPolicy,c=e.additionalSettings,u=e.proprietaryConstraints,p=e.appData;return O.debug("createSendTransport()"),this.createTransport({direction:"send",id:t,iceParameters:r,iceCandidates:n,dtlsParameters:o,sctpParameters:i,iceServers:a,iceTransportPolicy:s,additionalSettings:c,proprietaryConstraints:u,appData:p})}},{key:"createRecvTransport",value:function(e){var t=e.id,r=e.iceParameters,n=e.iceCandidates,o=e.dtlsParameters,i=e.sctpParameters,a=e.iceServers,s=e.iceTransportPolicy,c=e.additionalSettings,u=e.proprietaryConstraints,p=e.appData;return O.debug("createRecvTransport()"),this.createTransport({direction:"recv",id:t,iceParameters:r,iceCandidates:n,dtlsParameters:o,sctpParameters:i,iceServers:a,iceTransportPolicy:s,additionalSettings:c,proprietaryConstraints:u,appData:p})}},{key:"createTransport",value:function(e){var t=e.direction,r=e.id,n=e.iceParameters,o=e.iceCandidates,i=e.dtlsParameters,s=e.sctpParameters,c=e.iceServers,u=e.iceTransportPolicy,p=e.additionalSettings,l=e.proprietaryConstraints,d=e.appData;if(!this._loaded)throw new f.InvalidStateError("not loaded");if("string"!=typeof r)throw new TypeError("missing id");if("object"!==a(n))throw new TypeError("missing iceParameters");if(!Array.isArray(o))throw new TypeError("missing iceCandidates");if("object"!==a(i))throw new TypeError("missing dtlsParameters");if(s&&"object"!==a(s))throw new TypeError("wrong sctpParameters");if(d&&"object"!==a(d))throw new TypeError("if given, appData must be an object");var h=new v.Transport({direction:t,id:r,iceParameters:n,iceCandidates:o,dtlsParameters:i,sctpParameters:s,iceServers:c,iceTransportPolicy:u,additionalSettings:p,proprietaryConstraints:l,appData:d,handlerFactory:this._handlerFactory,extendedRtpCapabilities:this._extendedRtpCapabilities,canProduceByKind:this._canProduceByKind});return this._observer.safeEmit("newtransport",h),h}}],r&&i(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.Device=T},5324:(e,t,r)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===n(i)?i:String(i)),o)}var i}function i(){return i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},i.apply(this,arguments)}function a(e,t){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},a(e,t)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.EnhancedEventEmitter=void 0;var c=r(5090),u=new(r(1916).Logger)("EnhancedEventEmitter"),p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(d,e);var t,r,c,p,l=(c=d,p=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(c);if(p){var r=s(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function d(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(e=l.call(this)).setMaxListeners(1/0),e}return t=d,r=[{key:"emit",value:function(e){for(var t,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return(t=i(s(d.prototype),"emit",this)).call.apply(t,[this,e].concat(n))}},{key:"safeEmit",value:function(e){var t=i(s(d.prototype),"listenerCount",this).call(this,e);try{for(var r,n=arguments.length,o=new Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];return(r=i(s(d.prototype),"emit",this)).call.apply(r,[this,e].concat(o))}catch(r){return u.error("safeEmit() | event listener threw an error [eventName:%s]:%o",e,r),Boolean(t)}}},{key:"on",value:function(e,t){return i(s(d.prototype),"on",this).call(this,e,t),this}},{key:"off",value:function(e,t){return i(s(d.prototype),"off",this).call(this,e,t),this}},{key:"addListener",value:function(e,t){return i(s(d.prototype),"on",this).call(this,e,t),this}},{key:"prependListener",value:function(e,t){return i(s(d.prototype),"prependListener",this).call(this,e,t),this}},{key:"once",value:function(e,t){return i(s(d.prototype),"once",this).call(this,e,t),this}},{key:"prependOnceListener",value:function(e,t){return i(s(d.prototype),"prependOnceListener",this).call(this,e,t),this}},{key:"removeListener",value:function(e,t){return i(s(d.prototype),"off",this).call(this,e,t),this}},{key:"removeAllListeners",value:function(e){return i(s(d.prototype),"removeAllListeners",this).call(this,e),this}},{key:"listenerCount",value:function(e){return i(s(d.prototype),"listenerCount",this).call(this,e)}},{key:"listeners",value:function(e){return i(s(d.prototype),"listeners",this).call(this,e)}},{key:"rawListeners",value:function(e){return i(s(d.prototype),"rawListeners",this).call(this,e)}}],r&&o(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),d}(c.EventEmitter);t.EnhancedEventEmitter=p},1916:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===n(i)?i:String(i)),o)}var i}var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=void 0;var a=i(r(1373)),s="mediasoup-client",c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t?(this._debug=(0,a.default)("".concat(s,":").concat(t)),this._warn=(0,a.default)("".concat(s,":WARN:").concat(t)),this._error=(0,a.default)("".concat(s,":ERROR:").concat(t))):(this._debug=(0,a.default)(s),this._warn=(0,a.default)("".concat(s,":WARN")),this._error=(0,a.default)("".concat(s,":ERROR"))),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}var t,r;return t=e,(r=[{key:"debug",get:function(){return this._debug}},{key:"warn",get:function(){return this._warn}},{key:"error",get:function(){return this._error}}])&&o(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.Logger=c},4791:(e,t,r)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(){o=function(){return t};var e,t={},r=Object.prototype,i=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",p=s.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof b?t:b,i=Object.create(o.prototype),s=new D(n||[]);return a(i,"_invoke",{value:O(e,r,s)}),i}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var h="suspendedStart",m="suspendedYield",v="executing",y="completed",g={};function b(){}function w(){}function _(){}var S={};l(S,c,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(L([])));x&&x!==r&&i.call(x,c)&&(S=x);var R=_.prototype=b.prototype=Object.create(S);function P(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(o,a,s,c){var u=f(e[o],e,a);if("throw"!==u.type){var p=u.arg,l=p.value;return l&&"object"==n(l)&&i.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):t.resolve(l).then((function(e){p.value=e,s(p)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var o;a(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var o=h;return function(i,a){if(o===v)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=E(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?y:m,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function E(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,E(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(i.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(n(t)+" is not iterable")}return w.prototype=_,a(R,"constructor",{value:_,configurable:!0}),a(_,"constructor",{value:w,configurable:!0}),w.displayName=l(_,p,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,l(e,p,"GeneratorFunction")),e.prototype=Object.create(R),e},t.awrap=function(e){return{__await:e}},P(C.prototype),l(C.prototype,u,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new C(d(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},P(R),l(R,p,"Generator"),l(R,c,(function(){return this})),l(R,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function i(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function a(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function s(e){i(a,n,o,s,c,"next",e)}function c(e){i(a,n,o,s,c,"throw",e)}s(void 0)}))}}function s(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===n(i)?i:String(i)),o)}var i}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.Producer=void 0;var l=r(1916),d=r(5324),f=r(6020),h=new l.Logger("Producer"),m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(w,e);var t,r,i,l,m,v,y,g,b=(y=w,g=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=p(y);if(g){var r=p(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return u(e)}(this,e)});function w(e){var t,r=e.id,n=e.localId,o=e.rtpSender,i=e.track,a=e.rtpParameters,s=e.stopTracks,c=e.disableTrackOnPause,p=e.zeroRtpOnPause,l=e.appData;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,w),(t=b.call(this))._closed=!1,t._observer=new d.EnhancedEventEmitter,h.debug("constructor()"),t._id=r,t._localId=n,t._rtpSender=o,t._track=i,t._kind=i.kind,t._rtpParameters=a,t._paused=!!c&&!i.enabled,t._maxSpatialLayer=void 0,t._stopTracks=s,t._disableTrackOnPause=c,t._zeroRtpOnPause=p,t._appData=l||{},t.onTrackEnded=t.onTrackEnded.bind(u(t)),t.handleTrack(),t}return t=w,r=[{key:"id",get:function(){return this._id}},{key:"localId",get:function(){return this._localId}},{key:"closed",get:function(){return this._closed}},{key:"kind",get:function(){return this._kind}},{key:"rtpSender",get:function(){return this._rtpSender}},{key:"track",get:function(){return this._track}},{key:"rtpParameters",get:function(){return this._rtpParameters}},{key:"paused",get:function(){return this._paused}},{key:"maxSpatialLayer",get:function(){return this._maxSpatialLayer}},{key:"appData",get:function(){return this._appData},set:function(e){this._appData=e}},{key:"observer",get:function(){return this._observer}},{key:"close",value:function(){this._closed||(h.debug("close()"),this._closed=!0,this.destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"))}},{key:"transportClosed",value:function(){this._closed||(h.debug("transportClosed()"),this._closed=!0,this.destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}},{key:"getStats",value:(v=a(o().mark((function e(){var t=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._closed){e.next=2;break}throw new f.InvalidStateError("closed");case 2:return e.abrupt("return",new Promise((function(e,r){t.safeEmit("@getstats",e,r)})));case 3:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"pause",value:function(){var e=this;h.debug("pause()"),this._closed?h.error("pause() | Producer closed"):(this._paused=!0,this._track&&this._disableTrackOnPause&&(this._track.enabled=!1),this._zeroRtpOnPause&&new Promise((function(t,r){e.safeEmit("@pause",t,r)})).catch((function(){})),this._observer.safeEmit("pause"))}},{key:"resume",value:function(){var e=this;h.debug("resume()"),this._closed?h.error("resume() | Producer closed"):(this._paused=!1,this._track&&this._disableTrackOnPause&&(this._track.enabled=!0),this._zeroRtpOnPause&&new Promise((function(t,r){e.safeEmit("@resume",t,r)})).catch((function(){})),this._observer.safeEmit("resume"))}},{key:"replaceTrack",value:(m=a(o().mark((function e(t){var r,n=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.track,h.debug("replaceTrack() [track:%o]",r),!this._closed){e.next=7;break}if(r&&this._stopTracks)try{r.stop()}catch(e){}throw new f.InvalidStateError("closed");case 7:if(!r||"ended"!==r.readyState){e.next=9;break}throw new f.InvalidStateError("track ended");case 9:if(r!==this._track){e.next=12;break}return h.debug("replaceTrack() | same track, ignored"),e.abrupt("return");case 12:return e.next=14,new Promise((function(e,t){n.safeEmit("@replacetrack",r,e,t)}));case 14:this.destroyTrack(),this._track=r,this._track&&this._disableTrackOnPause&&(this._paused?this._paused&&(this._track.enabled=!1):this._track.enabled=!0),this.handleTrack();case 18:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"setMaxSpatialLayer",value:(l=a(o().mark((function e(t){var r=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._closed){e.next=4;break}throw new f.InvalidStateError("closed");case 4:if("video"===this._kind){e.next=8;break}throw new f.UnsupportedError("not a video Producer");case 8:if("number"==typeof t){e.next=10;break}throw new TypeError("invalid spatialLayer");case 10:if(t!==this._maxSpatialLayer){e.next=12;break}return e.abrupt("return");case 12:return e.next=14,new Promise((function(e,n){r.safeEmit("@setmaxspatiallayer",t,e,n)})).catch((function(){}));case 14:this._maxSpatialLayer=t;case 15:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"setRtpEncodingParameters",value:(i=a(o().mark((function e(t){var r=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._closed){e.next=4;break}throw new f.InvalidStateError("closed");case 4:if("object"===n(t)){e.next=6;break}throw new TypeError("invalid params");case 6:return e.next=8,new Promise((function(e,n){r.safeEmit("@setrtpencodingparameters",t,e,n)}));case 8:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"onTrackEnded",value:function(){h.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}},{key:"handleTrack",value:function(){this._track&&this._track.addEventListener("ended",this.onTrackEnded)}},{key:"destroyTrack",value:function(){if(this._track)try{this._track.removeEventListener("ended",this.onTrackEnded),this._stopTracks&&this._track.stop()}catch(e){}}}],r&&s(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),w}(d.EnhancedEventEmitter);t.Producer=m},7562:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5987:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2683:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(){o=function(){return t};var e,t={},r=Object.prototype,i=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",p=s.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof b?t:b,i=Object.create(o.prototype),s=new D(n||[]);return a(i,"_invoke",{value:O(e,r,s)}),i}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var h="suspendedStart",m="suspendedYield",v="executing",y="completed",g={};function b(){}function w(){}function _(){}var S={};l(S,c,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(L([])));x&&x!==r&&i.call(x,c)&&(S=x);var R=_.prototype=b.prototype=Object.create(S);function P(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(o,a,s,c){var u=f(e[o],e,a);if("throw"!==u.type){var p=u.arg,l=p.value;return l&&"object"==n(l)&&i.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):t.resolve(l).then((function(e){p.value=e,s(p)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var o;a(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var o=h;return function(i,a){if(o===v)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=E(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?y:m,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function E(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,E(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(i.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(n(t)+" is not iterable")}return w.prototype=_,a(R,"constructor",{value:_,configurable:!0}),a(_,"constructor",{value:w,configurable:!0}),w.displayName=l(_,p,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,l(e,p,"GeneratorFunction")),e.prototype=Object.create(R),e},t.awrap=function(e){return{__await:e}},P(C.prototype),l(C.prototype,u,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new C(d(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},P(R),l(R,p,"Generator"),l(R,c,(function(){return this})),l(R,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function i(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function a(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function s(e){i(a,n,o,s,c,"next",e)}function c(e){i(a,n,o,s,c,"throw",e)}s(void 0)}))}}function s(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=c(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function c(e,t){if(e){if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function p(e,t){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},p(e,t)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}function d(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===n(i)?i:String(i)),o)}var i}function f(e,t,r){return t&&d(e.prototype,t),r&&d(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var m=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),v=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),y=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&m(t,e,r);return v(t,e),t},g=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Transport=void 0;var b=r(4547),w=g(r(6497)),_=r(1916),S=r(5324),k=r(6020),x=y(r(5234)),R=y(r(6059)),P=r(4791),C=r(9113),O=r(6487),E=r(6503),T=new _.Logger("Transport"),j=f((function e(t){var r=this;h(this,e),this.consumerOptions=t,this.promise=new Promise((function(e,t){r.resolve=e,r.reject=t}))})),D=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(I,e);var t,r,i,d,m,v,y,g,_,D,L=(_=I,D=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(_);if(D){var r=l(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function I(e){var t,r=e.direction,n=e.id,o=e.iceParameters,i=e.iceCandidates,a=e.dtlsParameters,s=e.sctpParameters,c=e.iceServers,u=e.iceTransportPolicy,p=e.additionalSettings,l=e.proprietaryConstraints,d=e.appData,f=e.handlerFactory,m=e.extendedRtpCapabilities,v=e.canProduceByKind;return h(this,I),(t=L.call(this))._closed=!1,t._iceGatheringState="new",t._connectionState="new",t._producers=new Map,t._consumers=new Map,t._dataProducers=new Map,t._dataConsumers=new Map,t._probatorConsumerCreated=!1,t._awaitQueue=new b.AwaitQueue,t._pendingConsumerTasks=[],t._consumerCreationInProgress=!1,t._pendingPauseConsumers=new Map,t._consumerPauseInProgress=!1,t._pendingResumeConsumers=new Map,t._consumerResumeInProgress=!1,t._pendingCloseConsumers=new Map,t._consumerCloseInProgress=!1,t._observer=new S.EnhancedEventEmitter,T.debug("constructor() [id:%s, direction:%s]",n,r),t._id=n,t._direction=r,t._extendedRtpCapabilities=m,t._canProduceByKind=v,t._maxSctpMessageSize=s?s.maxMessageSize:null,delete(p=x.clone(p)||{}).iceServers,delete p.iceTransportPolicy,delete p.bundlePolicy,delete p.rtcpMuxPolicy,delete p.sdpSemantics,t._handler=f(),t._handler.run({direction:r,iceParameters:o,iceCandidates:i,dtlsParameters:a,sctpParameters:s,iceServers:c,iceTransportPolicy:u,additionalSettings:p,proprietaryConstraints:l,extendedRtpCapabilities:m}),t._appData=d||{},t.handleHandler(),t}return f(I,[{key:"id",get:function(){return this._id}},{key:"closed",get:function(){return this._closed}},{key:"direction",get:function(){return this._direction}},{key:"handler",get:function(){return this._handler}},{key:"iceGatheringState",get:function(){return this._iceGatheringState}},{key:"connectionState",get:function(){return this._connectionState}},{key:"appData",get:function(){return this._appData},set:function(e){this._appData=e}},{key:"observer",get:function(){return this._observer}},{key:"close",value:function(){if(!this._closed){T.debug("close()"),this._closed=!0,this._awaitQueue.stop(),this._handler.close(),this._connectionState="closed";var e,t=s(this._producers.values());try{for(t.s();!(e=t.n()).done;)e.value.transportClosed()}catch(e){t.e(e)}finally{t.f()}this._producers.clear();var r,n=s(this._consumers.values());try{for(n.s();!(r=n.n()).done;)r.value.transportClosed()}catch(e){n.e(e)}finally{n.f()}this._consumers.clear();var o,i=s(this._dataProducers.values());try{for(i.s();!(o=i.n()).done;)o.value.transportClosed()}catch(e){i.e(e)}finally{i.f()}this._dataProducers.clear();var a,c=s(this._dataConsumers.values());try{for(c.s();!(a=c.n()).done;)a.value.transportClosed()}catch(e){c.e(e)}finally{c.f()}this._dataConsumers.clear(),this._observer.safeEmit("close")}}},{key:"getStats",value:(g=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._closed){e.next=2;break}throw new k.InvalidStateError("closed");case 2:return e.abrupt("return",this._handler.getTransportStats());case 3:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)})},{key:"restartIce",value:(y=a(o().mark((function e(t){var r,n=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.iceParameters,T.debug("restartIce()"),!this._closed){e.next=6;break}throw new k.InvalidStateError("closed");case 6:if(r){e.next=8;break}throw new TypeError("missing iceParameters");case 8:return e.abrupt("return",this._awaitQueue.push(a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._handler.restartIce(r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),"transport.restartIce()"));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"updateIceServers",value:(v=a(o().mark((function e(){var t,r=this,n=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(n.length>0&&void 0!==n[0]?n[0]:{}).iceServers,T.debug("updateIceServers()"),!this._closed){e.next=6;break}throw new k.InvalidStateError("closed");case 6:if(Array.isArray(t)){e.next=8;break}throw new TypeError("missing iceServers");case 8:return e.abrupt("return",this._awaitQueue.push(a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r._handler.updateIceServers(t));case 1:case"end":return e.stop()}}),e)}))),"transport.updateIceServers()"));case 9:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"produce",value:(m=a(o().mark((function e(){var t,r,i,s,c,u,p,l,d,f,h,m,v,y=this,g=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(t=g.length>0&&void 0!==g[0]?g[0]:{}).track,i=t.encodings,s=t.codecOptions,c=t.codec,u=t.stopTracks,p=void 0===u||u,l=t.disableTrackOnPause,d=void 0===l||l,f=t.zeroRtpOnPause,h=void 0!==f&&f,m=t.appData,v=void 0===m?{}:m,T.debug("produce() [track:%o]",r),!this._closed){e.next=6;break}throw new k.InvalidStateError("closed");case 6:if(r){e.next=10;break}throw new TypeError("missing track");case 10:if("send"===this._direction){e.next=14;break}throw new k.UnsupportedError("not a sending Transport");case 14:if(this._canProduceByKind[r.kind]){e.next=18;break}throw new k.UnsupportedError("cannot produce ".concat(r.kind));case 18:if("ended"!==r.readyState){e.next=22;break}throw new k.InvalidStateError("track ended");case 22:if(0!==this.listenerCount("connect")||"new"!==this._connectionState){e.next=26;break}throw new TypeError('no "connect" listener set into this transport');case 26:if(0!==this.listenerCount("produce")){e.next=30;break}throw new TypeError('no "produce" listener set into this transport');case 30:if(!v||"object"===n(v)){e.next=32;break}throw new TypeError("if given, appData must be an object");case 32:return e.abrupt("return",this._awaitQueue.push(a(o().mark((function e(){var t,n,a,u,l,f,m,g;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i||Array.isArray(i)){e.next=4;break}throw TypeError("encodings must be an array");case 4:i&&0===i.length?t=void 0:i&&(t=i.map((function(e){var t={active:!0};return!1===e.active&&(t.active=!1),"boolean"==typeof e.dtx&&(t.dtx=e.dtx),"string"==typeof e.scalabilityMode&&(t.scalabilityMode=e.scalabilityMode),"number"==typeof e.scaleResolutionDownBy&&(t.scaleResolutionDownBy=e.scaleResolutionDownBy),"number"==typeof e.maxBitrate&&(t.maxBitrate=e.maxBitrate),"number"==typeof e.maxFramerate&&(t.maxFramerate=e.maxFramerate),"boolean"==typeof e.adaptivePtime&&(t.adaptivePtime=e.adaptivePtime),"string"==typeof e.priority&&(t.priority=e.priority),"string"==typeof e.networkPriority&&(t.networkPriority=e.networkPriority),t})));case 5:return e.next=7,y._handler.send({track:r,encodings:t,codecOptions:s,codec:c});case 7:return n=e.sent,a=n.localId,u=n.rtpParameters,l=n.rtpSender,e.prev=11,R.validateRtpParameters(u),e.next=15,new Promise((function(e,t){y.safeEmit("produce",{kind:r.kind,rtpParameters:u,appData:v},e,t)}));case 15:return f=e.sent,m=f.id,g=new P.Producer({id:m,localId:a,rtpSender:l,track:r,rtpParameters:u,stopTracks:p,disableTrackOnPause:d,zeroRtpOnPause:h,appData:v}),y._producers.set(g.id,g),y.handleProducer(g),y._observer.safeEmit("newproducer",g),e.abrupt("return",g);case 24:throw e.prev=24,e.t0=e.catch(11),y._handler.stopSending(a).catch((function(){})),e.t0;case 28:case"end":return e.stop()}}),e,null,[[11,24]])}))),"transport.produce()").catch((function(e){if(p)try{r.stop()}catch(e){}throw e})));case 33:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"consume",value:(d=a(o().mark((function e(t){var r,i,a,s,c,u,p,l,d=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.id,i=t.producerId,a=t.kind,s=t.rtpParameters,c=t.streamId,u=t.appData,p=void 0===u?{}:u,T.debug("consume()"),s=x.clone(s),!this._closed){e.next=7;break}throw new k.InvalidStateError("closed");case 7:if("recv"===this._direction){e.next=11;break}throw new k.UnsupportedError("not a receiving Transport");case 11:if("string"==typeof r){e.next=15;break}throw new TypeError("missing id");case 15:if("string"==typeof i){e.next=19;break}throw new TypeError("missing producerId");case 19:if("audio"===a||"video"===a){e.next=23;break}throw new TypeError("invalid kind '".concat(a,"'"));case 23:if(0!==this.listenerCount("connect")||"new"!==this._connectionState){e.next=27;break}throw new TypeError('no "connect" listener set into this transport');case 27:if(!p||"object"===n(p)){e.next=29;break}throw new TypeError("if given, appData must be an object");case 29:if(R.canReceive(s,this._extendedRtpCapabilities)){e.next=32;break}throw new k.UnsupportedError("cannot consume this Producer");case 32:return l=new j({id:r,producerId:i,kind:a,rtpParameters:s,streamId:c,appData:p}),this._pendingConsumerTasks.push(l),(0,w.default)((function(){d._closed||!1===d._consumerCreationInProgress&&d.createPendingConsumers()})),e.abrupt("return",l.promise);case 36:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"produceData",value:(i=a(o().mark((function e(){var t,r,i,s,c,u,p,l,d,f,h,m=this,v=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(t=v.length>0&&void 0!==v[0]?v[0]:{}).ordered,i=void 0===r||r,s=t.maxPacketLifeTime,c=t.maxRetransmits,u=t.label,p=void 0===u?"":u,l=t.protocol,d=void 0===l?"":l,f=t.appData,h=void 0===f?{}:f,T.debug("produceData()"),!this._closed){e.next=6;break}throw new k.InvalidStateError("closed");case 6:if("send"===this._direction){e.next=10;break}throw new k.UnsupportedError("not a sending Transport");case 10:if(this._maxSctpMessageSize){e.next=14;break}throw new k.UnsupportedError("SCTP not enabled by remote Transport");case 14:if(0!==this.listenerCount("connect")||"new"!==this._connectionState){e.next=18;break}throw new TypeError('no "connect" listener set into this transport');case 18:if(0!==this.listenerCount("producedata")){e.next=22;break}throw new TypeError('no "producedata" listener set into this transport');case 22:if(!h||"object"===n(h)){e.next=24;break}throw new TypeError("if given, appData must be an object");case 24:return(s||c)&&(i=!1),e.abrupt("return",this._awaitQueue.push(a(o().mark((function e(){var t,r,n,a,u,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m._handler.sendDataChannel({ordered:i,maxPacketLifeTime:s,maxRetransmits:c,label:p,protocol:d});case 2:return t=e.sent,r=t.dataChannel,n=t.sctpStreamParameters,R.validateSctpStreamParameters(n),e.next=8,new Promise((function(e,t){m.safeEmit("producedata",{sctpStreamParameters:n,label:p,protocol:d,appData:h},e,t)}));case 8:return a=e.sent,u=a.id,l=new O.DataProducer({id:u,dataChannel:r,sctpStreamParameters:n,appData:h}),m._dataProducers.set(l.id,l),m.handleDataProducer(l),m._observer.safeEmit("newdataproducer",l),e.abrupt("return",l);case 15:case"end":return e.stop()}}),e)}))),"transport.produceData()"));case 26:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"consumeData",value:(r=a(o().mark((function e(t){var r,i,s,c,u,p,l,d,f,h=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.id,i=t.dataProducerId,s=t.sctpStreamParameters,c=t.label,u=void 0===c?"":c,p=t.protocol,l=void 0===p?"":p,d=t.appData,f=void 0===d?{}:d,T.debug("consumeData()"),s=x.clone(s),!this._closed){e.next=7;break}throw new k.InvalidStateError("closed");case 7:if("recv"===this._direction){e.next=11;break}throw new k.UnsupportedError("not a receiving Transport");case 11:if(this._maxSctpMessageSize){e.next=15;break}throw new k.UnsupportedError("SCTP not enabled by remote Transport");case 15:if("string"==typeof r){e.next=19;break}throw new TypeError("missing id");case 19:if("string"==typeof i){e.next=23;break}throw new TypeError("missing dataProducerId");case 23:if(0!==this.listenerCount("connect")||"new"!==this._connectionState){e.next=27;break}throw new TypeError('no "connect" listener set into this transport');case 27:if(!f||"object"===n(f)){e.next=29;break}throw new TypeError("if given, appData must be an object");case 29:return R.validateSctpStreamParameters(s),e.abrupt("return",this._awaitQueue.push(a(o().mark((function e(){var t,n,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h._handler.receiveDataChannel({sctpStreamParameters:s,label:u,protocol:l});case 2:return t=e.sent,n=t.dataChannel,a=new E.DataConsumer({id:r,dataProducerId:i,dataChannel:n,sctpStreamParameters:s,appData:f}),h._dataConsumers.set(a.id,a),h.handleDataConsumer(a),h._observer.safeEmit("newdataconsumer",a),e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)}))),"transport.consumeData()"));case 31:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"createPendingConsumers",value:(t=a(o().mark((function e(){var t=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._consumerCreationInProgress=!0,this._awaitQueue.push(a(o().mark((function e(){var r,n,i,a,p,l,d,f,h,m,v,y,g,b,w,_,S,k,x,P,O,E,j,D,L,I,M,A;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t._pendingConsumerTasks.length){e.next=3;break}return T.debug("createPendingConsumers() | there is no Consumer to be created"),e.abrupt("return");case 3:o=t._pendingConsumerTasks,r=function(e){if(Array.isArray(e))return u(e)}(o)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(o)||c(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),t._pendingConsumerTasks=[],n=void 0,i=[],a=s(r);try{for(a.s();!(p=a.n()).done;)l=p.value,d=l.consumerOptions,f=d.id,h=d.kind,m=d.rtpParameters,v=d.streamId,i.push({trackId:f,kind:h,rtpParameters:m,streamId:v})}catch(e){a.e(e)}finally{a.f()}return e.prev=9,e.next=12,t._handler.receive(i);case 12:for(y=e.sent,g=0;g<y.length;++g)b=r[g],w=y[g],_=b.consumerOptions,S=_.id,k=_.producerId,x=_.kind,P=_.rtpParameters,O=_.appData,E=w.localId,j=w.rtpReceiver,D=w.track,L=new C.Consumer({id:S,localId:E,producerId:k,rtpReceiver:j,track:D,rtpParameters:P,appData:O}),t._consumers.set(L.id,L),t.handleConsumer(L),t._probatorConsumerCreated||n||"video"!==x||(n=L),t._observer.safeEmit("newconsumer",L),b.resolve(L);e.next=20;break;case 16:e.prev=16,e.t0=e.catch(9),I=s(r);try{for(I.s();!(M=I.n()).done;)M.value.reject(e.t0)}catch(e){I.e(e)}finally{I.f()}case 20:if(!n){e.next=32;break}return e.prev=21,A=R.generateProbatorRtpParameters(n.rtpParameters),e.next=25,t._handler.receive([{trackId:"probator",kind:"video",rtpParameters:A}]);case 25:T.debug("createPendingConsumers() | Consumer for RTP probation created"),t._probatorConsumerCreated=!0,e.next=32;break;case 29:e.prev=29,e.t1=e.catch(21),T.error("createPendingConsumers() | failed to create Consumer for RTP probation:%o",e.t1);case 32:case"end":return e.stop()}var o}),e,null,[[9,16],[21,29]])}))),"transport.createPendingConsumers()").then((function(){t._consumerCreationInProgress=!1,t._pendingConsumerTasks.length>0&&t.createPendingConsumers()})).catch((function(){}));case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"pausePendingConsumers",value:function(){var e=this;this._consumerPauseInProgress=!0,this._awaitQueue.push(a(o().mark((function t(){var r,n;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==e._pendingPauseConsumers.size){t.next=3;break}return T.debug("pausePendingConsumers() | there is no Consumer to be paused"),t.abrupt("return");case 3:return r=Array.from(e._pendingPauseConsumers.values()),e._pendingPauseConsumers.clear(),t.prev=5,n=r.map((function(e){return e.localId})),t.next=9,e._handler.pauseReceiving(n);case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(5),T.error("pausePendingConsumers() | failed to pause Consumers:",t.t0);case 14:case"end":return t.stop()}}),t,null,[[5,11]])}))),"transport.pausePendingConsumers").then((function(){e._consumerPauseInProgress=!1,e._pendingPauseConsumers.size>0&&e.pausePendingConsumers()})).catch((function(){}))}},{key:"resumePendingConsumers",value:function(){var e=this;this._consumerResumeInProgress=!0,this._awaitQueue.push(a(o().mark((function t(){var r,n;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==e._pendingResumeConsumers.size){t.next=3;break}return T.debug("resumePendingConsumers() | there is no Consumer to be resumed"),t.abrupt("return");case 3:return r=Array.from(e._pendingResumeConsumers.values()),e._pendingResumeConsumers.clear(),t.prev=5,n=r.map((function(e){return e.localId})),t.next=9,e._handler.resumeReceiving(n);case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(5),T.error("resumePendingConsumers() | failed to resume Consumers:",t.t0);case 14:case"end":return t.stop()}}),t,null,[[5,11]])}))),"transport.resumePendingConsumers").then((function(){e._consumerResumeInProgress=!1,e._pendingResumeConsumers.size>0&&e.resumePendingConsumers()})).catch((function(){}))}},{key:"closePendingConsumers",value:function(){var e=this;this._consumerCloseInProgress=!0,this._awaitQueue.push(a(o().mark((function t(){var r;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==e._pendingCloseConsumers.size){t.next=3;break}return T.debug("closePendingConsumers() | there is no Consumer to be closed"),t.abrupt("return");case 3:return r=Array.from(e._pendingCloseConsumers.values()),e._pendingCloseConsumers.clear(),t.prev=5,t.next=8,e._handler.stopReceiving(r.map((function(e){return e.localId})));case 8:t.next=13;break;case 10:t.prev=10,t.t0=t.catch(5),T.error("closePendingConsumers() | failed to close Consumers:",t.t0);case 13:case"end":return t.stop()}}),t,null,[[5,10]])}))),"transport.closePendingConsumers").then((function(){e._consumerCloseInProgress=!1,e._pendingCloseConsumers.size>0&&e.closePendingConsumers()})).catch((function(){}))}},{key:"handleHandler",value:function(){var e=this,t=this._handler;t.on("@connect",(function(t,r,n){var o=t.dtlsParameters;e._closed?n(new k.InvalidStateError("closed")):e.safeEmit("connect",{dtlsParameters:o},r,n)})),t.on("@icegatheringstatechange",(function(t){t!==e._iceGatheringState&&(T.debug("ICE gathering state changed to %s",t),e._iceGatheringState=t,e._closed||e.safeEmit("icegatheringstatechange",t))})),t.on("@connectionstatechange",(function(t){t!==e._connectionState&&(T.debug("connection state changed to %s",t),e._connectionState=t,e._closed||e.safeEmit("connectionstatechange",t))}))}},{key:"handleProducer",value:function(e){var t=this;e.on("@close",(function(){t._producers.delete(e.id),t._closed||t._awaitQueue.push(a(o().mark((function r(){return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t._handler.stopSending(e.localId);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),r)}))),"producer @close event").catch((function(e){return T.warn("producer.close() failed:%o",e)}))})),e.on("@pause",(function(r,n){t._awaitQueue.push(a(o().mark((function r(){return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t._handler.pauseSending(e.localId);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),r)}))),"producer @pause event").then(r).catch(n)})),e.on("@resume",(function(r,n){t._awaitQueue.push(a(o().mark((function r(){return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t._handler.resumeSending(e.localId);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),r)}))),"producer @resume event").then(r).catch(n)})),e.on("@replacetrack",(function(r,n,i){t._awaitQueue.push(a(o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._handler.replaceTrack(e.localId,r);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)}))),"producer @replacetrack event").then(n).catch(i)})),e.on("@setmaxspatiallayer",(function(r,n,i){t._awaitQueue.push(a(o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._handler.setMaxSpatialLayer(e.localId,r);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)}))),"producer @setmaxspatiallayer event").then(n).catch(i)})),e.on("@setrtpencodingparameters",(function(r,n,i){t._awaitQueue.push(a(o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._handler.setRtpEncodingParameters(e.localId,r);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)}))),"producer @setrtpencodingparameters event").then(n).catch(i)})),e.on("@getstats",(function(r,n){if(t._closed)return n(new k.InvalidStateError("closed"));t._handler.getSenderStats(e.localId).then(r).catch(n)}))}},{key:"handleConsumer",value:function(e){var t=this;e.on("@close",(function(){t._consumers.delete(e.id),t._pendingPauseConsumers.delete(e.id),t._pendingResumeConsumers.delete(e.id),t._closed||(t._pendingCloseConsumers.set(e.id,e),!1===t._consumerCloseInProgress&&t.closePendingConsumers())})),e.on("@pause",(function(){t._pendingResumeConsumers.has(e.id)&&t._pendingResumeConsumers.delete(e.id),t._pendingPauseConsumers.set(e.id,e),(0,w.default)((function(){t._closed||!1===t._consumerPauseInProgress&&t.pausePendingConsumers()}))})),e.on("@resume",(function(){t._pendingPauseConsumers.has(e.id)&&t._pendingPauseConsumers.delete(e.id),t._pendingResumeConsumers.set(e.id,e),(0,w.default)((function(){t._closed||!1===t._consumerResumeInProgress&&t.resumePendingConsumers()}))})),e.on("@getstats",(function(r,n){if(t._closed)return n(new k.InvalidStateError("closed"));t._handler.getReceiverStats(e.localId).then(r).catch(n)}))}},{key:"handleDataProducer",value:function(e){var t=this;e.on("@close",(function(){t._dataProducers.delete(e.id)}))}},{key:"handleDataConsumer",value:function(e){var t=this;e.on("@close",(function(){t._dataConsumers.delete(e.id)}))}}]),I}(S.EnhancedEventEmitter);t.Transport=D},6020:(e,t)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function n(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===r(i)?i:String(i)),o)}var i}function o(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}function s(e){var t=l();return function(){var n,o=f(e);if(t){var i=f(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return c(e)}(this,n)}}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){var t="function"==typeof Map?new Map:void 0;return u=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return p(e,arguments,f(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),d(r,e)},u(e)}function p(e,t,r){return p=l()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&d(o,r.prototype),o},p.apply(null,arguments)}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function d(e,t){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},d(e,t)}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.InvalidStateError=t.UnsupportedError=void 0;var h=function(e){a(r,e);var t=s(r);function r(e){var n;return i(this,r),(n=t.call(this,e)).name="UnsupportedError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(c(n),r):n.stack=new Error(e).stack,n}return o(r)}(u(Error));t.UnsupportedError=h;var m=function(e){a(r,e);var t=s(r);function r(e){var n;return i(this,r),(n=t.call(this,e)).name="InvalidStateError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(c(n),r):n.stack=new Error(e).stack,n}return o(r)}(u(Error));t.InvalidStateError=m},270:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o.apply(this,arguments)}function i(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw i}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){var n,o,i;n=e,o=t,i=r[t],(o=f(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(){u=function(){return t};var e,t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",p=a.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof b?t:b,a=Object.create(o.prototype),s=new D(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var h="suspendedStart",m="suspendedYield",v="executing",y="completed",g={};function b(){}function w(){}function _(){}var S={};l(S,s,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(L([])));x&&x!==r&&o.call(x,s)&&(S=x);var R=_.prototype=b.prototype=Object.create(S);function P(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(i,a,s,c){var u=f(e[i],e,a);if("throw"!==u.type){var p=u.arg,l=p.value;return l&&"object"==n(l)&&o.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):t.resolve(l).then((function(e){p.value=e,s(p)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var a;i(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function O(t,r,n){var o=h;return function(i,a){if(o===v)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=E(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?y:m,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function E(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,E(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[s];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function r(){for(;++i<t.length;)if(o.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(n(t)+" is not iterable")}return w.prototype=_,i(R,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:w,configurable:!0}),w.displayName=l(_,p,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,l(e,p,"GeneratorFunction")),e.prototype=Object.create(R),e},t.awrap=function(e){return{__await:e}},P(C.prototype),l(C.prototype,c,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new C(d(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},P(R),l(R,p,"Generator"),l(R,s,(function(){return this})),l(R,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function p(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){p(i,n,o,a,s,"next",e)}function s(e){p(i,n,o,a,s,"throw",e)}a(void 0)}))}}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function f(e){var t=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===n(t)?t:String(t)}function h(e,t){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},h(e,t)}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}var v=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),y=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),g=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&v(t,e,r);return y(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Chrome111=void 0;var b=g(r(9652)),w=r(1916),_=g(r(5234)),S=g(r(6059)),k=g(r(5388)),x=g(r(8538)),R=g(r(337)),P=r(6020),C=r(1144),O=r(9196),E=r(9975),T=new w.Logger("Chrome111"),j={OS:1024,MIS:1024},D=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(Y,e);var t,r,a,s,p,f,v,y,g,w,C,D,L,I,M,A,N,F,B,G,V,U,q,z,W,K,H=(W=Y,K=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=m(W);if(K){var r=m(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function Y(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Y),(e=H.call(this))._closed=!1,e._mapMidTransceiver=new Map,e._sendStream=new MediaStream,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return t=Y,r=[{key:"name",get:function(){return"Chrome111"}},{key:"close",value:function(){if(T.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}}},{key:"getNativeRtpCapabilities",value:(z=l(u().mark((function e(){var t,r,n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"}),e.prev=2,t.addTransceiver("audio"),t.addTransceiver("video"),e.next=7,t.createOffer();case 7:r=e.sent;try{t.close()}catch(e){}return n=b.parse(r.sdp),o=k.extractRtpCapabilities({sdpObject:n}),R.addNackSuppportForOpus(o),e.abrupt("return",o);case 15:e.prev=15,e.t0=e.catch(2);try{t.close()}catch(e){}throw e.t0;case 19:case"end":return e.stop()}}),e,null,[[2,15]])}))),function(){return z.apply(this,arguments)})},{key:"getNativeSctpCapabilities",value:(q=l(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:j});case 2:case"end":return e.stop()}}),e)}))),function(){return q.apply(this,arguments)})},{key:"run",value:function(e){var t=this,r=e.direction,n=e.iceParameters,o=e.iceCandidates,i=e.dtlsParameters,a=e.sctpParameters,s=e.iceServers,u=e.iceTransportPolicy,p=e.additionalSettings,l=e.proprietaryConstraints,d=e.extendedRtpCapabilities;this.assertNotClosed(),T.debug("run()"),this._direction=r,this._remoteSdp=new O.RemoteSdp({iceParameters:n,iceCandidates:o,dtlsParameters:i,sctpParameters:a}),this._sendingRtpParametersByKind={audio:S.getSendingRtpParameters("audio",d),video:S.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:S.getSendingRemoteRtpParameters("audio",d),video:S.getSendingRemoteRtpParameters("video",d)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection(c({iceServers:s||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"},p),l),this._pc.addEventListener("icegatheringstatechange",(function(){t.emit("@icegatheringstatechange",t._pc.iceGatheringState)})),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(function(){t.emit("@connectionstatechange",t._pc.connectionState)})):(T.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",(function(){switch(t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}})))}},{key:"updateIceServers",value:(U=l(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertNotClosed(),T.debug("updateIceServers()"),(r=this._pc.getConfiguration()).iceServers=t,this._pc.setConfiguration(r);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return U.apply(this,arguments)})},{key:"restartIce",value:(V=l(u().mark((function e(t){var r,n,o,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),T.debug("restartIce()"),this._remoteSdp.updateIceParameters(t),this._transportReady){e.next=5;break}return e.abrupt("return");case 5:if("send"!==this._direction){e.next=18;break}return e.next=8,this._pc.createOffer({iceRestart:!0});case 8:return r=e.sent,T.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),e.next=12,this._pc.setLocalDescription(r);case 12:return n={type:"answer",sdp:this._remoteSdp.getSdp()},T.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),e.next=16,this._pc.setRemoteDescription(n);case 16:e.next=28;break;case 18:return o={type:"offer",sdp:this._remoteSdp.getSdp()},T.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=22,this._pc.setRemoteDescription(o);case 22:return e.next=24,this._pc.createAnswer();case 24:return i=e.sent,T.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",i),e.next=28,this._pc.setLocalDescription(i);case 28:case"end":return e.stop()}}),e,this)}))),function(e){return V.apply(this,arguments)})},{key:"getTransportStats",value:(G=l(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.assertNotClosed(),e.abrupt("return",this._pc.getStats());case 2:case"end":return e.stop()}}),e,this)}))),function(){return G.apply(this,arguments)})},{key:"send",value:(B=l(u().mark((function e(t){var r,n,a,s,c,p,l,d,f,h,m,v,y,g,w,R,P,C,O,j,D,L,I,M;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.track,n=t.encodings,a=t.codecOptions,s=t.codec,this.assertNotClosed(),this.assertSendDirection(),T.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),n&&n.length>1){n.forEach((function(e,t){e.rid="r".concat(t)})),c=1,p=1,l=i(n);try{for(l.s();!(d=l.n()).done;)f=d.value,(h=f.scalabilityMode?(0,E.parse)(f.scalabilityMode).temporalLayers:3)>p&&(p=h)}catch(e){l.e(e)}finally{l.f()}m=i(n);try{for(m.s();!(v=m.n()).done;)(y=v.value).rid="r".concat(c++),y.scalabilityMode="L1T".concat(p)}catch(e){m.e(e)}finally{m.f()}}return(g=_.clone(this._sendingRtpParametersByKind[r.kind])).codecs=S.reduceCodecs(g.codecs,s),(w=_.clone(this._sendingRemoteRtpParametersByKind[r.kind])).codecs=S.reduceCodecs(w.codecs,s),R=this._remoteSdp.getNextMediaSectionIdx(),P=this._pc.addTransceiver(r,{direction:"sendonly",streams:[this._sendStream],sendEncodings:n}),e.next=13,this._pc.createOffer();case 13:if(C=e.sent,O=b.parse(C.sdp),this._transportReady){e.next=18;break}return e.next=18,this.setupTransport({localDtlsRole:null!==(j=this._forcedLocalDtlsRole)&&void 0!==j?j:"client",localSdpObject:O});case 18:return T.debug("send() | calling pc.setLocalDescription() [offer:%o]",C),e.next=21,this._pc.setLocalDescription(C);case 21:return D=P.mid,g.mid=D,O=b.parse(this._pc.localDescription.sdp),L=O.media[R.idx],g.rtcp.cname=k.getCname({offerMediaObject:L}),n?1===n.length?(o((I=x.getRtpEncodings({offerMediaObject:L}))[0],n[0]),g.encodings=I):g.encodings=n:g.encodings=x.getRtpEncodings({offerMediaObject:L}),this._remoteSdp.send({offerMediaObject:L,reuseMid:R.reuseMid,offerRtpParameters:g,answerRtpParameters:w,codecOptions:a,extmapAllowMixed:!0}),M={type:"answer",sdp:this._remoteSdp.getSdp()},T.debug("send() | calling pc.setRemoteDescription() [answer:%o]",M),e.next=32,this._pc.setRemoteDescription(M);case 32:return this._mapMidTransceiver.set(D,P),e.abrupt("return",{localId:D,rtpParameters:g,rtpSender:P.sender});case 34:case"end":return e.stop()}}),e,this)}))),function(e){return B.apply(this,arguments)})},{key:"stopSending",value:(F=l(u().mark((function e(t){var r,n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),T.debug("stopSending() [localId:%s]",t),!this._closed){e.next=4;break}return e.abrupt("return");case 4:if(r=this._mapMidTransceiver.get(t)){e.next=7;break}throw new Error("associated RTCRtpTransceiver not found");case 7:if(r.sender.replaceTrack(null),this._pc.removeTrack(r.sender),this._remoteSdp.closeMediaSection(r.mid))try{r.stop()}catch(e){}return e.next=13,this._pc.createOffer();case 13:return n=e.sent,T.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),e.next=17,this._pc.setLocalDescription(n);case 17:return o={type:"answer",sdp:this._remoteSdp.getSdp()},T.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=21,this._pc.setRemoteDescription(o);case 21:this._mapMidTransceiver.delete(t);case 22:case"end":return e.stop()}}),e,this)}))),function(e){return F.apply(this,arguments)})},{key:"pauseSending",value:(N=l(u().mark((function e(t){var r,n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertSendDirection(),T.debug("pauseSending() [localId:%s]",t),r=this._mapMidTransceiver.get(t)){e.next=6;break}throw new Error("associated RTCRtpTransceiver not found");case 6:return r.direction="inactive",this._remoteSdp.pauseMediaSection(t),e.next=10,this._pc.createOffer();case 10:return n=e.sent,T.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",n),e.next=14,this._pc.setLocalDescription(n);case 14:return o={type:"answer",sdp:this._remoteSdp.getSdp()},T.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=18,this._pc.setRemoteDescription(o);case 18:case"end":return e.stop()}}),e,this)}))),function(e){return N.apply(this,arguments)})},{key:"resumeSending",value:(A=l(u().mark((function e(t){var r,n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertSendDirection(),T.debug("resumeSending() [localId:%s]",t),r=this._mapMidTransceiver.get(t),this._remoteSdp.resumeSendingMediaSection(t),r){e.next=7;break}throw new Error("associated RTCRtpTransceiver not found");case 7:return r.direction="sendonly",e.next=10,this._pc.createOffer();case 10:return n=e.sent,T.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",n),e.next=14,this._pc.setLocalDescription(n);case 14:return o={type:"answer",sdp:this._remoteSdp.getSdp()},T.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=18,this._pc.setRemoteDescription(o);case 18:case"end":return e.stop()}}),e,this)}))),function(e){return A.apply(this,arguments)})},{key:"replaceTrack",value:(M=l(u().mark((function e(t,r){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertSendDirection(),r?T.debug("replaceTrack() [localId:%s, track.id:%s]",t,r.id):T.debug("replaceTrack() [localId:%s, no track]",t),n=this._mapMidTransceiver.get(t)){e.next=6;break}throw new Error("associated RTCRtpTransceiver not found");case 6:return e.next=8,n.sender.replaceTrack(r);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return M.apply(this,arguments)})},{key:"setMaxSpatialLayer",value:(I=l(u().mark((function e(t,r){var n,o,i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertSendDirection(),T.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,r),n=this._mapMidTransceiver.get(t)){e.next=6;break}throw new Error("associated RTCRtpTransceiver not found");case 6:return(o=n.sender.getParameters()).encodings.forEach((function(e,t){e.active=t<=r})),e.next=10,n.sender.setParameters(o);case 10:return this._remoteSdp.muxMediaSectionSimulcast(t,o.encodings),e.next=13,this._pc.createOffer();case 13:return i=e.sent,T.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",i),e.next=17,this._pc.setLocalDescription(i);case 17:return a={type:"answer",sdp:this._remoteSdp.getSdp()},T.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=21,this._pc.setRemoteDescription(a);case 21:case"end":return e.stop()}}),e,this)}))),function(e,t){return I.apply(this,arguments)})},{key:"setRtpEncodingParameters",value:(L=l(u().mark((function e(t,r){var n,o,i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertSendDirection(),T.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,r),n=this._mapMidTransceiver.get(t)){e.next=6;break}throw new Error("associated RTCRtpTransceiver not found");case 6:return(o=n.sender.getParameters()).encodings.forEach((function(e,t){o.encodings[t]=c(c({},e),r)})),e.next=10,n.sender.setParameters(o);case 10:return this._remoteSdp.muxMediaSectionSimulcast(t,o.encodings),e.next=13,this._pc.createOffer();case 13:return i=e.sent,T.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",i),e.next=17,this._pc.setLocalDescription(i);case 17:return a={type:"answer",sdp:this._remoteSdp.getSdp()},T.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=21,this._pc.setRemoteDescription(a);case 21:case"end":return e.stop()}}),e,this)}))),function(e,t){return L.apply(this,arguments)})},{key:"getSenderStats",value:(D=l(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertSendDirection(),r=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return e.abrupt("return",r.sender.getStats());case 6:case"end":return e.stop()}}),e,this)}))),function(e){return D.apply(this,arguments)})},{key:"sendDataChannel",value:(C=l(u().mark((function e(t){var r,n,o,i,a,s,c,p,l,d,f,h,m;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.ordered,n=t.maxPacketLifeTime,o=t.maxRetransmits,i=t.label,a=t.protocol,this.assertNotClosed(),this.assertSendDirection(),s={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmits:o,protocol:a},T.debug("sendDataChannel() [options:%o]",s),c=this._pc.createDataChannel(i,s),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%j.MIS,this._hasDataChannelMediaSection){e.next=25;break}return e.next=10,this._pc.createOffer();case 10:if(p=e.sent,l=b.parse(p.sdp),d=l.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=16;break}return e.next=16,this.setupTransport({localDtlsRole:null!==(f=this._forcedLocalDtlsRole)&&void 0!==f?f:"client",localSdpObject:l});case 16:return T.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",p),e.next=19,this._pc.setLocalDescription(p);case 19:return this._remoteSdp.sendSctpAssociation({offerMediaObject:d}),h={type:"answer",sdp:this._remoteSdp.getSdp()},T.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",h),e.next=24,this._pc.setRemoteDescription(h);case 24:this._hasDataChannelMediaSection=!0;case 25:return m={streamId:s.id,ordered:s.ordered,maxPacketLifeTime:s.maxPacketLifeTime,maxRetransmits:s.maxRetransmits},e.abrupt("return",{dataChannel:c,sctpStreamParameters:m});case 27:case"end":return e.stop()}}),e,this)}))),function(e){return C.apply(this,arguments)})},{key:"receive",value:(w=l(u().mark((function e(t){var r,n,o,a,s,c,p,l,d,f,h,m,v,y,g,w,_,S,x,R,P=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertNotClosed(),this.assertRecvDirection(),r=[],n=new Map,o=i(t);try{for(o.s();!(a=o.n()).done;)s=a.value,c=s.trackId,p=s.kind,l=s.rtpParameters,d=s.streamId,T.debug("receive() [trackId:%s, kind:%s]",c,p),f=l.mid||String(this._mapMidTransceiver.size),n.set(c,f),this._remoteSdp.receive({mid:f,kind:p,offerRtpParameters:l,streamId:d||l.rtcp.cname,trackId:c})}catch(e){o.e(e)}finally{o.f()}return h={type:"offer",sdp:this._remoteSdp.getSdp()},T.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",h),e.next=10,this._pc.setRemoteDescription(h);case 10:return e.next=12,this._pc.createAnswer();case 12:m=e.sent,v=b.parse(m.sdp),y=i(t),e.prev=15,w=u().mark((function e(){var t,r,o,i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=g.value,r=t.trackId,o=t.rtpParameters,i=n.get(r),a=v.media.find((function(e){return String(e.mid)===i})),k.applyCodecParameters({offerRtpParameters:o,answerMediaObject:a});case 5:case"end":return e.stop()}}),e)})),y.s();case 18:if((g=y.n()).done){e.next=22;break}return e.delegateYield(w(),"t0",20);case 20:e.next=18;break;case 22:e.next=27;break;case 24:e.prev=24,e.t1=e.catch(15),y.e(e.t1);case 27:return e.prev=27,y.f(),e.finish(27);case 30:if(m={type:"answer",sdp:b.write(v)},this._transportReady){e.next=34;break}return e.next=34,this.setupTransport({localDtlsRole:null!==(_=this._forcedLocalDtlsRole)&&void 0!==_?_:"client",localSdpObject:v});case 34:return T.debug("receive() | calling pc.setLocalDescription() [answer:%o]",m),e.next=37,this._pc.setLocalDescription(m);case 37:S=i(t),e.prev=38,R=u().mark((function e(){var t,o,i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=x.value,o=t.trackId,i=n.get(o),a=P._pc.getTransceivers().find((function(e){return e.mid===i}))){e.next=8;break}throw new Error("new RTCRtpTransceiver not found");case 8:P._mapMidTransceiver.set(i,a),r.push({localId:i,track:a.receiver.track,rtpReceiver:a.receiver});case 10:case"end":return e.stop()}}),e)})),S.s();case 41:if((x=S.n()).done){e.next=45;break}return e.delegateYield(R(),"t2",43);case 43:e.next=41;break;case 45:e.next=50;break;case 47:e.prev=47,e.t3=e.catch(38),S.e(e.t3);case 50:return e.prev=50,S.f(),e.finish(50);case 53:return e.abrupt("return",r);case 54:case"end":return e.stop()}}),e,this,[[15,24,27,30],[38,47,50,53]])}))),function(e){return w.apply(this,arguments)})},{key:"stopReceiving",value:(g=l(u().mark((function e(t){var r,n,o,a,s,c,p,l,d;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertRecvDirection(),!this._closed){e.next=3;break}return e.abrupt("return");case 3:r=i(t),e.prev=4,r.s();case 6:if((n=r.n()).done){e.next=15;break}if(o=n.value,T.debug("stopReceiving() [localId:%s]",o),a=this._mapMidTransceiver.get(o)){e.next=12;break}throw new Error("associated RTCRtpTransceiver not found");case 12:this._remoteSdp.closeMediaSection(a.mid);case 13:e.next=6;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(4),r.e(e.t0);case 20:return e.prev=20,r.f(),e.finish(20);case 23:return s={type:"offer",sdp:this._remoteSdp.getSdp()},T.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",s),e.next=27,this._pc.setRemoteDescription(s);case 27:return e.next=29,this._pc.createAnswer();case 29:return c=e.sent,T.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",c),e.next=33,this._pc.setLocalDescription(c);case 33:p=i(t);try{for(p.s();!(l=p.n()).done;)d=l.value,this._mapMidTransceiver.delete(d)}catch(e){p.e(e)}finally{p.f()}case 35:case"end":return e.stop()}}),e,this,[[4,17,20,23]])}))),function(e){return g.apply(this,arguments)})},{key:"pauseReceiving",value:(y=l(u().mark((function e(t){var r,n,o,a,s,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertNotClosed(),this.assertRecvDirection(),r=i(t),e.prev=3,r.s();case 5:if((n=r.n()).done){e.next=15;break}if(o=n.value,T.debug("pauseReceiving() [localId:%s]",o),a=this._mapMidTransceiver.get(o)){e.next=11;break}throw new Error("associated RTCRtpTransceiver not found");case 11:a.direction="inactive",this._remoteSdp.pauseMediaSection(o);case 13:e.next=5;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(3),r.e(e.t0);case 20:return e.prev=20,r.f(),e.finish(20);case 23:return s={type:"offer",sdp:this._remoteSdp.getSdp()},T.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",s),e.next=27,this._pc.setRemoteDescription(s);case 27:return e.next=29,this._pc.createAnswer();case 29:return c=e.sent,T.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",c),e.next=33,this._pc.setLocalDescription(c);case 33:case"end":return e.stop()}}),e,this,[[3,17,20,23]])}))),function(e){return y.apply(this,arguments)})},{key:"resumeReceiving",value:(v=l(u().mark((function e(t){var r,n,o,a,s,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertNotClosed(),this.assertRecvDirection(),r=i(t),e.prev=3,r.s();case 5:if((n=r.n()).done){e.next=15;break}if(o=n.value,T.debug("resumeReceiving() [localId:%s]",o),a=this._mapMidTransceiver.get(o)){e.next=11;break}throw new Error("associated RTCRtpTransceiver not found");case 11:a.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(o);case 13:e.next=5;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(3),r.e(e.t0);case 20:return e.prev=20,r.f(),e.finish(20);case 23:return s={type:"offer",sdp:this._remoteSdp.getSdp()},T.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",s),e.next=27,this._pc.setRemoteDescription(s);case 27:return e.next=29,this._pc.createAnswer();case 29:return c=e.sent,T.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",c),e.next=33,this._pc.setLocalDescription(c);case 33:case"end":return e.stop()}}),e,this,[[3,17,20,23]])}))),function(e){return v.apply(this,arguments)})},{key:"getReceiverStats",value:(f=l(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertRecvDirection(),r=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return e.abrupt("return",r.receiver.getStats());case 6:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"receiveDataChannel",value:(p=l(u().mark((function e(t){var r,n,o,i,a,s,c,p,l,d,f,h,m;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.sctpStreamParameters,n=t.label,o=t.protocol,this.assertNotClosed(),this.assertRecvDirection(),i=r.streamId,a=r.ordered,s=r.maxPacketLifeTime,c=r.maxRetransmits,p={negotiated:!0,id:i,ordered:a,maxPacketLifeTime:s,maxRetransmits:c,protocol:o},T.debug("receiveDataChannel() [options:%o]",p),l=this._pc.createDataChannel(n,p),this._hasDataChannelMediaSection){e.next=24;break}return this._remoteSdp.receiveSctpAssociation(),d={type:"offer",sdp:this._remoteSdp.getSdp()},T.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),e.next=13,this._pc.setRemoteDescription(d);case 13:return e.next=15,this._pc.createAnswer();case 15:if(f=e.sent,this._transportReady){e.next=20;break}return m=b.parse(f.sdp),e.next=20,this.setupTransport({localDtlsRole:null!==(h=this._forcedLocalDtlsRole)&&void 0!==h?h:"client",localSdpObject:m});case 20:return T.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),e.next=23,this._pc.setLocalDescription(f);case 23:this._hasDataChannelMediaSection=!0;case 24:return e.abrupt("return",{dataChannel:l});case 25:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"setupTransport",value:(s=l(u().mark((function e(t){var r,n,o,i=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.localDtlsRole,(n=t.localSdpObject)||(n=b.parse(this._pc.localDescription.sdp)),(o=k.extractDtlsParameters({sdpObject:n})).role=r,this._remoteSdp.updateDtlsRole("client"===r?"server":"client"),e.next=7,new Promise((function(e,t){i.safeEmit("@connect",{dtlsParameters:o},e,t)}));case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"assertNotClosed",value:function(){if(this._closed)throw new P.InvalidStateError("method called in a closed handler")}},{key:"assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],a=[{key:"createFactory",value:function(){return function(){return new Y}}}],r&&d(t.prototype,r),a&&d(t,a),Object.defineProperty(t,"prototype",{writable:!1}),Y}(C.HandlerInterface);t.Chrome111=D},3261:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a.apply(this,arguments)}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(){c=function(){return t};var e,t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",p=a.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof b?t:b,a=Object.create(o.prototype),s=new D(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var h="suspendedStart",m="suspendedYield",v="executing",y="completed",g={};function b(){}function w(){}function _(){}var S={};l(S,s,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(L([])));x&&x!==r&&o.call(x,s)&&(S=x);var R=_.prototype=b.prototype=Object.create(S);function P(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(i,a,s,c){var u=f(e[i],e,a);if("throw"!==u.type){var p=u.arg,l=p.value;return l&&"object"==n(l)&&o.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):t.resolve(l).then((function(e){p.value=e,s(p)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var a;i(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function O(t,r,n){var o=h;return function(i,a){if(o===v)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=E(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?y:m,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function E(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,E(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[s];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function r(){for(;++i<t.length;)if(o.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(n(t)+" is not iterable")}return w.prototype=_,i(R,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:w,configurable:!0}),w.displayName=l(_,p,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,l(e,p,"GeneratorFunction")),e.prototype=Object.create(R),e},t.awrap=function(e){return{__await:e}},P(C.prototype),l(C.prototype,u,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new C(d(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},P(R),l(R,p,"Generator"),l(R,s,(function(){return this})),l(R,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function u(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function p(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){u(i,n,o,a,s,"next",e)}function s(e){u(i,n,o,a,s,"throw",e)}a(void 0)}))}}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d(n.key),n)}}function d(e){var t=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===n(t)?t:String(t)}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}var m=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),v=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),y=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&m(t,e,r);return v(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Chrome55=void 0;var g=y(r(9652)),b=r(1916),w=r(6020),_=y(r(5234)),S=y(r(6059)),k=y(r(5388)),x=y(r(5156)),R=r(1144),P=r(9196),C=new b.Logger("Chrome55"),O={OS:1024,MIS:1024},E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(H,e);var t,r,i,u,m,v,y,b,R,E,T,j,D,L,I,M,A,N,F,B,G,V,U,q,z,W,K=(z=H,W=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(z);if(W){var r=h(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function H(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,H),(e=K.call(this))._sendStream=new MediaStream,e._mapSendLocalIdTrack=new Map,e._nextSendLocalId=0,e._mapRecvLocalIdInfo=new Map,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return t=H,r=[{key:"name",get:function(){return"Chrome55"}},{key:"close",value:function(){if(C.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}},{key:"getNativeRtpCapabilities",value:(q=p(c().mark((function e(){var t,r,n,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"}),e.prev=2,e.next=5,t.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});case 5:r=e.sent;try{t.close()}catch(e){}return n=g.parse(r.sdp),o=k.extractRtpCapabilities({sdpObject:n}),e.abrupt("return",o);case 12:e.prev=12,e.t0=e.catch(2);try{t.close()}catch(e){}throw e.t0;case 16:case"end":return e.stop()}}),e,null,[[2,12]])}))),function(){return q.apply(this,arguments)})},{key:"getNativeSctpCapabilities",value:(U=p(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:O});case 2:case"end":return e.stop()}}),e)}))),function(){return U.apply(this,arguments)})},{key:"run",value:function(e){var t=this,r=e.direction,n=e.iceParameters,o=e.iceCandidates,i=e.dtlsParameters,a=e.sctpParameters,c=e.iceServers,u=e.iceTransportPolicy,p=e.additionalSettings,l=e.proprietaryConstraints,f=e.extendedRtpCapabilities;C.debug("run()"),this._direction=r,this._remoteSdp=new P.RemoteSdp({iceParameters:n,iceCandidates:o,dtlsParameters:i,sctpParameters:a,planB:!0}),this._sendingRtpParametersByKind={audio:S.getSendingRtpParameters("audio",f),video:S.getSendingRtpParameters("video",f)},this._sendingRemoteRtpParametersByKind={audio:S.getSendingRemoteRtpParameters("audio",f),video:S.getSendingRemoteRtpParameters("video",f)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){var n,o,i;n=e,o=t,i=r[t],(o=d(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({iceServers:c||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"},p),l),this._pc.addEventListener("icegatheringstatechange",(function(){t.emit("@icegatheringstatechange",t._pc.iceGatheringState)})),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(function(){t.emit("@connectionstatechange",t._pc.connectionState)})):this._pc.addEventListener("iceconnectionstatechange",(function(){switch(C.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:(V=p(c().mark((function e(t){var r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C.debug("updateIceServers()"),(r=this._pc.getConfiguration()).iceServers=t,this._pc.setConfiguration(r);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return V.apply(this,arguments)})},{key:"restartIce",value:(G=p(c().mark((function e(t){var r,n,o,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(C.debug("restartIce()"),this._remoteSdp.updateIceParameters(t),this._transportReady){e.next=4;break}return e.abrupt("return");case 4:if("send"!==this._direction){e.next=17;break}return e.next=7,this._pc.createOffer({iceRestart:!0});case 7:return r=e.sent,C.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),e.next=11,this._pc.setLocalDescription(r);case 11:return n={type:"answer",sdp:this._remoteSdp.getSdp()},C.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),e.next=15,this._pc.setRemoteDescription(n);case 15:e.next=27;break;case 17:return o={type:"offer",sdp:this._remoteSdp.getSdp()},C.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=21,this._pc.setRemoteDescription(o);case 21:return e.next=23,this._pc.createAnswer();case 23:return i=e.sent,C.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",i),e.next=27,this._pc.setLocalDescription(i);case 27:case"end":return e.stop()}}),e,this)}))),function(e){return G.apply(this,arguments)})},{key:"getTransportStats",value:(B=p(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)}))),function(){return B.apply(this,arguments)})},{key:"send",value:(F=p(c().mark((function e(t){var r,n,i,s,u,p,l,d,f,h,m,v,y,b,w;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.track,n=t.encodings,i=t.codecOptions,s=t.codec,this.assertSendDirection(),C.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),s&&C.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(r),this._pc.addStream(this._sendStream),e.next=8,this._pc.createOffer();case 8:if(u=e.sent,p=g.parse(u.sdp),(d=_.clone(this._sendingRtpParametersByKind[r.kind])).codecs=S.reduceCodecs(d.codecs),(f=_.clone(this._sendingRemoteRtpParametersByKind[r.kind])).codecs=S.reduceCodecs(f.codecs),this._transportReady){e.next=17;break}return e.next=17,this.setupTransport({localDtlsRole:null!==(h=this._forcedLocalDtlsRole)&&void 0!==h?h:"client",localSdpObject:p});case 17:return"video"===r.kind&&n&&n.length>1&&(C.debug("send() | enabling simulcast"),p=g.parse(u.sdp),l=p.media.find((function(e){return"video"===e.type})),x.addLegacySimulcast({offerMediaObject:l,track:r,numStreams:n.length}),u={type:"offer",sdp:g.write(p)}),C.debug("send() | calling pc.setLocalDescription() [offer:%o]",u),e.next=21,this._pc.setLocalDescription(u);case 21:if(p=g.parse(this._pc.localDescription.sdp),l=p.media.find((function(e){return e.type===r.kind})),d.rtcp.cname=k.getCname({offerMediaObject:l}),d.encodings=x.getRtpEncodings({offerMediaObject:l,track:r}),n)for(m=0;m<d.encodings.length;++m)n[m]&&a(d.encodings[m],n[m]);if(d.encodings.length>1&&"video/vp8"===d.codecs[0].mimeType.toLowerCase()){v=o(d.encodings);try{for(v.s();!(y=v.n()).done;)y.value.scalabilityMode="L1T3"}catch(e){v.e(e)}finally{v.f()}}return this._remoteSdp.send({offerMediaObject:l,offerRtpParameters:d,answerRtpParameters:f,codecOptions:i}),b={type:"answer",sdp:this._remoteSdp.getSdp()},C.debug("send() | calling pc.setRemoteDescription() [answer:%o]",b),e.next=32,this._pc.setRemoteDescription(b);case 32:return w=String(this._nextSendLocalId),this._nextSendLocalId++,this._mapSendLocalIdTrack.set(w,r),e.abrupt("return",{localId:w,rtpParameters:d});case 36:case"end":return e.stop()}}),e,this)}))),function(e){return F.apply(this,arguments)})},{key:"stopSending",value:(N=p(c().mark((function e(t){var r,n,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),C.debug("stopSending() [localId:%s]",t),r=this._mapSendLocalIdTrack.get(t)){e.next=5;break}throw new Error("track not found");case 5:return this._mapSendLocalIdTrack.delete(t),this._sendStream.removeTrack(r),this._pc.addStream(this._sendStream),e.next=10,this._pc.createOffer();case 10:return n=e.sent,C.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),e.prev=12,e.next=15,this._pc.setLocalDescription(n);case 15:e.next=23;break;case 17:if(e.prev=17,e.t0=e.catch(12),0!==this._sendStream.getTracks().length){e.next=22;break}return C.warn("stopSending() | ignoring expected error due no sending tracks: %s",e.t0.toString()),e.abrupt("return");case 22:throw e.t0;case 23:if("stable"!==this._pc.signalingState){e.next=25;break}return e.abrupt("return");case 25:return o={type:"answer",sdp:this._remoteSdp.getSdp()},C.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=29,this._pc.setRemoteDescription(o);case 29:case"end":return e.stop()}}),e,this,[[12,17]])}))),function(e){return N.apply(this,arguments)})},{key:"pauseSending",value:(A=p(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return A.apply(this,arguments)})},{key:"resumeSending",value:(M=p(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return M.apply(this,arguments)})},{key:"replaceTrack",value:(I=p(c().mark((function e(t,r){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new w.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)}))),function(e,t){return I.apply(this,arguments)})},{key:"setMaxSpatialLayer",value:(L=p(c().mark((function e(t,r){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new w.UnsupportedError(" not implemented");case 1:case"end":return e.stop()}}),e)}))),function(e,t){return L.apply(this,arguments)})},{key:"setRtpEncodingParameters",value:(D=p(c().mark((function e(t,r){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new w.UnsupportedError("not supported");case 1:case"end":return e.stop()}}),e)}))),function(e,t){return D.apply(this,arguments)})},{key:"getSenderStats",value:(j=p(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new w.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)}))),function(e){return j.apply(this,arguments)})},{key:"sendDataChannel",value:(T=p(c().mark((function e(t){var r,n,o,i,a,s,u,p,l,d,f,h,m;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.ordered,n=t.maxPacketLifeTime,o=t.maxRetransmits,i=t.label,a=t.protocol,this.assertSendDirection(),s={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmitTime:n,maxRetransmits:o,protocol:a},C.debug("sendDataChannel() [options:%o]",s),u=this._pc.createDataChannel(i,s),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%O.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=9,this._pc.createOffer();case 9:if(p=e.sent,l=g.parse(p.sdp),d=l.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=15;break}return e.next=15,this.setupTransport({localDtlsRole:null!==(f=this._forcedLocalDtlsRole)&&void 0!==f?f:"client",localSdpObject:l});case 15:return C.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",p),e.next=18,this._pc.setLocalDescription(p);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:d}),h={type:"answer",sdp:this._remoteSdp.getSdp()},C.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",h),e.next=23,this._pc.setRemoteDescription(h);case 23:this._hasDataChannelMediaSection=!0;case 24:return m={streamId:s.id,ordered:s.ordered,maxPacketLifeTime:s.maxPacketLifeTime,maxRetransmits:s.maxRetransmits},e.abrupt("return",{dataChannel:u,sctpStreamParameters:m});case 26:case"end":return e.stop()}}),e,this)}))),function(e){return T.apply(this,arguments)})},{key:"receive",value:(E=p(c().mark((function e(t){var r,n,i,a,s,u,p,l,d,f,h,m,v,y,b,w,_,S,x,R=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=[],n=o(t);try{for(n.s();!(i=n.n()).done;)a=i.value,s=a.trackId,u=a.kind,p=a.rtpParameters,l=a.streamId,C.debug("receive() [trackId:%s, kind:%s]",s,u),d=u,this._remoteSdp.receive({mid:d,kind:u,offerRtpParameters:p,streamId:l||p.rtcp.cname,trackId:s})}catch(e){n.e(e)}finally{n.f()}return f={type:"offer",sdp:this._remoteSdp.getSdp()},C.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",f),e.next=8,this._pc.setRemoteDescription(f);case 8:return e.next=10,this._pc.createAnswer();case 10:h=e.sent,m=g.parse(h.sdp),v=o(t),e.prev=13,b=c().mark((function e(){var t,r,n,o,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=y.value,r=t.kind,n=t.rtpParameters,o=r,i=m.media.find((function(e){return String(e.mid)===o})),k.applyCodecParameters({offerRtpParameters:n,answerMediaObject:i});case 5:case"end":return e.stop()}}),e)})),v.s();case 16:if((y=v.n()).done){e.next=20;break}return e.delegateYield(b(),"t0",18);case 18:e.next=16;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(13),v.e(e.t1);case 25:return e.prev=25,v.f(),e.finish(25);case 28:if(h={type:"answer",sdp:g.write(m)},this._transportReady){e.next=32;break}return e.next=32,this.setupTransport({localDtlsRole:null!==(w=this._forcedLocalDtlsRole)&&void 0!==w?w:"client",localSdpObject:m});case 32:return C.debug("receive() | calling pc.setLocalDescription() [answer:%o]",h),e.next=35,this._pc.setLocalDescription(h);case 35:_=o(t),e.prev=36,x=c().mark((function e(){var t,n,o,i,a,s,u,p,l;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=S.value,n=t.kind,o=t.trackId,i=t.rtpParameters,a=n,s=o,u=t.streamId||i.rtcp.cname,p=R._pc.getRemoteStreams().find((function(e){return e.id===u})),l=p.getTrackById(s)){e.next=9;break}throw new Error("remote track not found");case 9:R._mapRecvLocalIdInfo.set(s,{mid:a,rtpParameters:i}),r.push({localId:s,track:l});case 11:case"end":return e.stop()}}),e)})),_.s();case 39:if((S=_.n()).done){e.next=43;break}return e.delegateYield(x(),"t2",41);case 41:e.next=39;break;case 43:e.next=48;break;case 45:e.prev=45,e.t3=e.catch(36),_.e(e.t3);case 48:return e.prev=48,_.f(),e.finish(48);case 51:return e.abrupt("return",r);case 52:case"end":return e.stop()}}),e,this,[[13,22,25,28],[36,45,48,51]])}))),function(e){return E.apply(this,arguments)})},{key:"stopReceiving",value:(R=p(c().mark((function e(t){var r,n,i,a,s,u,p,l;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=o(t);try{for(r.s();!(n=r.n()).done;)i=n.value,C.debug("stopReceiving() [localId:%s]",i),a=this._mapRecvLocalIdInfo.get(i)||{},s=a.mid,u=a.rtpParameters,this._mapRecvLocalIdInfo.delete(i),this._remoteSdp.planBStopReceiving({mid:s,offerRtpParameters:u})}catch(e){r.e(e)}finally{r.f()}return p={type:"offer",sdp:this._remoteSdp.getSdp()},C.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",p),e.next=7,this._pc.setRemoteDescription(p);case 7:return e.next=9,this._pc.createAnswer();case 9:return l=e.sent,C.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",l),e.next=13,this._pc.setLocalDescription(l);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return R.apply(this,arguments)})},{key:"pauseReceiving",value:(b=p(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return b.apply(this,arguments)})},{key:"resumeReceiving",value:(y=p(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return y.apply(this,arguments)})},{key:"getReceiverStats",value:(v=p(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new w.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)}))),function(e){return v.apply(this,arguments)})},{key:"receiveDataChannel",value:(m=p(c().mark((function e(t){var r,n,o,i,a,s,u,p,l,d,f,h,m;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.sctpStreamParameters,n=t.label,o=t.protocol,this.assertRecvDirection(),i=r.streamId,a=r.ordered,s=r.maxPacketLifeTime,u=r.maxRetransmits,p={negotiated:!0,id:i,ordered:a,maxPacketLifeTime:s,maxRetransmitTime:s,maxRetransmits:u,protocol:o},C.debug("receiveDataChannel() [options:%o]",p),l=this._pc.createDataChannel(n,p),this._hasDataChannelMediaSection){e.next=23;break}return this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0}),d={type:"offer",sdp:this._remoteSdp.getSdp()},C.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),e.next=12,this._pc.setRemoteDescription(d);case 12:return e.next=14,this._pc.createAnswer();case 14:if(f=e.sent,this._transportReady){e.next=19;break}return m=g.parse(f.sdp),e.next=19,this.setupTransport({localDtlsRole:null!==(h=this._forcedLocalDtlsRole)&&void 0!==h?h:"client",localSdpObject:m});case 19:return C.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),e.next=22,this._pc.setLocalDescription(f);case 22:this._hasDataChannelMediaSection=!0;case 23:return e.abrupt("return",{dataChannel:l});case 24:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"setupTransport",value:(u=p(c().mark((function e(t){var r,n,o,i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.localDtlsRole,(n=t.localSdpObject)||(n=g.parse(this._pc.localDescription.sdp)),(o=k.extractDtlsParameters({sdpObject:n})).role=r,this._remoteSdp.updateDtlsRole("client"===r?"server":"client"),e.next=7,new Promise((function(e,t){i.safeEmit("@connect",{dtlsParameters:o},e,t)}));case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],i=[{key:"createFactory",value:function(){return function(){return new H}}}],r&&l(t.prototype,r),i&&l(t,i),Object.defineProperty(t,"prototype",{writable:!1}),H}(R.HandlerInterface);t.Chrome55=E},5149:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a.apply(this,arguments)}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){var n,o,i;n=e,o=t,i=r[t],(o=f(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(){u=function(){return t};var e,t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",p=a.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof b?t:b,a=Object.create(o.prototype),s=new D(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var h="suspendedStart",m="suspendedYield",v="executing",y="completed",g={};function b(){}function w(){}function _(){}var S={};l(S,s,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(L([])));x&&x!==r&&o.call(x,s)&&(S=x);var R=_.prototype=b.prototype=Object.create(S);function P(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(i,a,s,c){var u=f(e[i],e,a);if("throw"!==u.type){var p=u.arg,l=p.value;return l&&"object"==n(l)&&o.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):t.resolve(l).then((function(e){p.value=e,s(p)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var a;i(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function O(t,r,n){var o=h;return function(i,a){if(o===v)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=E(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?y:m,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function E(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,E(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[s];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function r(){for(;++i<t.length;)if(o.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(n(t)+" is not iterable")}return w.prototype=_,i(R,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:w,configurable:!0}),w.displayName=l(_,p,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,l(e,p,"GeneratorFunction")),e.prototype=Object.create(R),e},t.awrap=function(e){return{__await:e}},P(C.prototype),l(C.prototype,c,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new C(d(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},P(R),l(R,p,"Generator"),l(R,s,(function(){return this})),l(R,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function p(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){p(i,n,o,a,s,"next",e)}function s(e){p(i,n,o,a,s,"throw",e)}a(void 0)}))}}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function f(e){var t=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===n(t)?t:String(t)}function h(e,t){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},h(e,t)}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}var v=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),y=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),g=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&v(t,e,r);return y(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Chrome67=void 0;var b=g(r(9652)),w=r(1916),_=g(r(5234)),S=g(r(6059)),k=g(r(5388)),x=g(r(5156)),R=r(1144),P=r(9196),C=new w.Logger("Chrome67"),O={OS:1024,MIS:1024},E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(W,e);var t,r,i,s,p,f,v,y,g,w,R,E,T,j,D,L,I,M,A,N,F,B,G,V,U,q,z=(U=W,q=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=m(U);if(q){var r=m(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function W(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,W),(e=z.call(this))._sendStream=new MediaStream,e._mapSendLocalIdRtpSender=new Map,e._nextSendLocalId=0,e._mapRecvLocalIdInfo=new Map,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return t=W,r=[{key:"name",get:function(){return"Chrome67"}},{key:"close",value:function(){if(C.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}},{key:"getNativeRtpCapabilities",value:(V=l(u().mark((function e(){var t,r,n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"}),e.prev=2,e.next=5,t.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});case 5:r=e.sent;try{t.close()}catch(e){}return n=b.parse(r.sdp),o=k.extractRtpCapabilities({sdpObject:n}),e.abrupt("return",o);case 12:e.prev=12,e.t0=e.catch(2);try{t.close()}catch(e){}throw e.t0;case 16:case"end":return e.stop()}}),e,null,[[2,12]])}))),function(){return V.apply(this,arguments)})},{key:"getNativeSctpCapabilities",value:(G=l(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:O});case 2:case"end":return e.stop()}}),e)}))),function(){return G.apply(this,arguments)})},{key:"run",value:function(e){var t=this,r=e.direction,n=e.iceParameters,o=e.iceCandidates,i=e.dtlsParameters,a=e.sctpParameters,s=e.iceServers,u=e.iceTransportPolicy,p=e.additionalSettings,l=e.proprietaryConstraints,d=e.extendedRtpCapabilities;C.debug("run()"),this._direction=r,this._remoteSdp=new P.RemoteSdp({iceParameters:n,iceCandidates:o,dtlsParameters:i,sctpParameters:a,planB:!0}),this._sendingRtpParametersByKind={audio:S.getSendingRtpParameters("audio",d),video:S.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:S.getSendingRemoteRtpParameters("audio",d),video:S.getSendingRemoteRtpParameters("video",d)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection(c({iceServers:s||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"},p),l),this._pc.addEventListener("icegatheringstatechange",(function(){t.emit("@icegatheringstatechange",t._pc.iceGatheringState)})),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(function(){t.emit("@connectionstatechange",t._pc.connectionState)})):this._pc.addEventListener("iceconnectionstatechange",(function(){switch(C.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:(B=l(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C.debug("updateIceServers()"),(r=this._pc.getConfiguration()).iceServers=t,this._pc.setConfiguration(r);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return B.apply(this,arguments)})},{key:"restartIce",value:(F=l(u().mark((function e(t){var r,n,o,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(C.debug("restartIce()"),this._remoteSdp.updateIceParameters(t),this._transportReady){e.next=4;break}return e.abrupt("return");case 4:if("send"!==this._direction){e.next=17;break}return e.next=7,this._pc.createOffer({iceRestart:!0});case 7:return r=e.sent,C.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),e.next=11,this._pc.setLocalDescription(r);case 11:return n={type:"answer",sdp:this._remoteSdp.getSdp()},C.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),e.next=15,this._pc.setRemoteDescription(n);case 15:e.next=27;break;case 17:return o={type:"offer",sdp:this._remoteSdp.getSdp()},C.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=21,this._pc.setRemoteDescription(o);case 21:return e.next=23,this._pc.createAnswer();case 23:return i=e.sent,C.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",i),e.next=27,this._pc.setLocalDescription(i);case 27:case"end":return e.stop()}}),e,this)}))),function(e){return F.apply(this,arguments)})},{key:"getTransportStats",value:(N=l(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)}))),function(){return N.apply(this,arguments)})},{key:"send",value:(A=l(u().mark((function e(t){var r,n,i,s,c,p,l,d,f,h,m,v,y,g,w,R;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.track,n=t.encodings,i=t.codecOptions,s=t.codec,this.assertSendDirection(),C.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),s&&C.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(r),this._pc.addTrack(r,this._sendStream),e.next=8,this._pc.createOffer();case 8:if(c=e.sent,p=b.parse(c.sdp),(d=_.clone(this._sendingRtpParametersByKind[r.kind])).codecs=S.reduceCodecs(d.codecs),(f=_.clone(this._sendingRemoteRtpParametersByKind[r.kind])).codecs=S.reduceCodecs(f.codecs),this._transportReady){e.next=17;break}return e.next=17,this.setupTransport({localDtlsRole:null!==(h=this._forcedLocalDtlsRole)&&void 0!==h?h:"client",localSdpObject:p});case 17:return"video"===r.kind&&n&&n.length>1&&(C.debug("send() | enabling simulcast"),p=b.parse(c.sdp),l=p.media.find((function(e){return"video"===e.type})),x.addLegacySimulcast({offerMediaObject:l,track:r,numStreams:n.length}),c={type:"offer",sdp:b.write(p)}),C.debug("send() | calling pc.setLocalDescription() [offer:%o]",c),e.next=21,this._pc.setLocalDescription(c);case 21:if(p=b.parse(this._pc.localDescription.sdp),l=p.media.find((function(e){return e.type===r.kind})),d.rtcp.cname=k.getCname({offerMediaObject:l}),d.encodings=x.getRtpEncodings({offerMediaObject:l,track:r}),n)for(m=0;m<d.encodings.length;++m)n[m]&&a(d.encodings[m],n[m]);if(d.encodings.length>1&&"video/vp8"===d.codecs[0].mimeType.toLowerCase()){v=o(d.encodings);try{for(v.s();!(y=v.n()).done;)y.value.scalabilityMode="L1T3"}catch(e){v.e(e)}finally{v.f()}}return this._remoteSdp.send({offerMediaObject:l,offerRtpParameters:d,answerRtpParameters:f,codecOptions:i}),g={type:"answer",sdp:this._remoteSdp.getSdp()},C.debug("send() | calling pc.setRemoteDescription() [answer:%o]",g),e.next=32,this._pc.setRemoteDescription(g);case 32:return w=String(this._nextSendLocalId),this._nextSendLocalId++,R=this._pc.getSenders().find((function(e){return e.track===r})),this._mapSendLocalIdRtpSender.set(w,R),e.abrupt("return",{localId:w,rtpParameters:d,rtpSender:R});case 37:case"end":return e.stop()}}),e,this)}))),function(e){return A.apply(this,arguments)})},{key:"stopSending",value:(M=l(u().mark((function e(t){var r,n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),C.debug("stopSending() [localId:%s]",t),r=this._mapSendLocalIdRtpSender.get(t)){e.next=5;break}throw new Error("associated RTCRtpSender not found");case 5:return this._pc.removeTrack(r),r.track&&this._sendStream.removeTrack(r.track),this._mapSendLocalIdRtpSender.delete(t),e.next=10,this._pc.createOffer();case 10:return n=e.sent,C.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),e.prev=12,e.next=15,this._pc.setLocalDescription(n);case 15:e.next=23;break;case 17:if(e.prev=17,e.t0=e.catch(12),0!==this._sendStream.getTracks().length){e.next=22;break}return C.warn("stopSending() | ignoring expected error due no sending tracks: %s",e.t0.toString()),e.abrupt("return");case 22:throw e.t0;case 23:if("stable"!==this._pc.signalingState){e.next=25;break}return e.abrupt("return");case 25:return o={type:"answer",sdp:this._remoteSdp.getSdp()},C.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=29,this._pc.setRemoteDescription(o);case 29:case"end":return e.stop()}}),e,this,[[12,17]])}))),function(e){return M.apply(this,arguments)})},{key:"pauseSending",value:(I=l(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return I.apply(this,arguments)})},{key:"resumeSending",value:(L=l(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return L.apply(this,arguments)})},{key:"replaceTrack",value:(D=l(u().mark((function e(t,r){var n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),r?C.debug("replaceTrack() [localId:%s, track.id:%s]",t,r.id):C.debug("replaceTrack() [localId:%s, no track]",t),n=this._mapSendLocalIdRtpSender.get(t)){e.next=5;break}throw new Error("associated RTCRtpSender not found");case 5:return o=n.track,e.next=8,n.replaceTrack(r);case 8:o&&this._sendStream.removeTrack(o),r&&this._sendStream.addTrack(r);case 10:case"end":return e.stop()}}),e,this)}))),function(e,t){return D.apply(this,arguments)})},{key:"setMaxSpatialLayer",value:(j=l(u().mark((function e(t,r){var n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),C.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,r),n=this._mapSendLocalIdRtpSender.get(t)){e.next=5;break}throw new Error("associated RTCRtpSender not found");case 5:return(o=n.getParameters()).encodings.forEach((function(e,t){e.active=t<=r})),e.next=9,n.setParameters(o);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return j.apply(this,arguments)})},{key:"setRtpEncodingParameters",value:(T=l(u().mark((function e(t,r){var n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),C.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,r),n=this._mapSendLocalIdRtpSender.get(t)){e.next=5;break}throw new Error("associated RTCRtpSender not found");case 5:return(o=n.getParameters()).encodings.forEach((function(e,t){o.encodings[t]=c(c({},e),r)})),e.next=9,n.setParameters(o);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return T.apply(this,arguments)})},{key:"getSenderStats",value:(E=l(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),r=this._mapSendLocalIdRtpSender.get(t)){e.next=4;break}throw new Error("associated RTCRtpSender not found");case 4:return e.abrupt("return",r.getStats());case 5:case"end":return e.stop()}}),e,this)}))),function(e){return E.apply(this,arguments)})},{key:"sendDataChannel",value:(R=l(u().mark((function e(t){var r,n,o,i,a,s,c,p,l,d,f,h,m;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.ordered,n=t.maxPacketLifeTime,o=t.maxRetransmits,i=t.label,a=t.protocol,this.assertSendDirection(),s={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmitTime:n,maxRetransmits:o,protocol:a},C.debug("sendDataChannel() [options:%o]",s),c=this._pc.createDataChannel(i,s),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%O.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=9,this._pc.createOffer();case 9:if(p=e.sent,l=b.parse(p.sdp),d=l.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=15;break}return e.next=15,this.setupTransport({localDtlsRole:null!==(f=this._forcedLocalDtlsRole)&&void 0!==f?f:"client",localSdpObject:l});case 15:return C.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",p),e.next=18,this._pc.setLocalDescription(p);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:d}),h={type:"answer",sdp:this._remoteSdp.getSdp()},C.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",h),e.next=23,this._pc.setRemoteDescription(h);case 23:this._hasDataChannelMediaSection=!0;case 24:return m={streamId:s.id,ordered:s.ordered,maxPacketLifeTime:s.maxPacketLifeTime,maxRetransmits:s.maxRetransmits},e.abrupt("return",{dataChannel:c,sctpStreamParameters:m});case 26:case"end":return e.stop()}}),e,this)}))),function(e){return R.apply(this,arguments)})},{key:"receive",value:(w=l(u().mark((function e(t){var r,n,i,a,s,c,p,l,d,f,h,m,v,y,g,w,_,S,x,R=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=[],n=o(t);try{for(n.s();!(i=n.n()).done;)a=i.value,s=a.trackId,c=a.kind,p=a.rtpParameters,l=a.streamId,C.debug("receive() [trackId:%s, kind:%s]",s,c),d=c,this._remoteSdp.receive({mid:d,kind:c,offerRtpParameters:p,streamId:l||p.rtcp.cname,trackId:s})}catch(e){n.e(e)}finally{n.f()}return f={type:"offer",sdp:this._remoteSdp.getSdp()},C.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",f),e.next=8,this._pc.setRemoteDescription(f);case 8:return e.next=10,this._pc.createAnswer();case 10:h=e.sent,m=b.parse(h.sdp),v=o(t),e.prev=13,g=u().mark((function e(){var t,r,n,o,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=y.value,r=t.kind,n=t.rtpParameters,o=r,i=m.media.find((function(e){return String(e.mid)===o})),k.applyCodecParameters({offerRtpParameters:n,answerMediaObject:i});case 5:case"end":return e.stop()}}),e)})),v.s();case 16:if((y=v.n()).done){e.next=20;break}return e.delegateYield(g(),"t0",18);case 18:e.next=16;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(13),v.e(e.t1);case 25:return e.prev=25,v.f(),e.finish(25);case 28:if(h={type:"answer",sdp:b.write(m)},this._transportReady){e.next=32;break}return e.next=32,this.setupTransport({localDtlsRole:null!==(w=this._forcedLocalDtlsRole)&&void 0!==w?w:"client",localSdpObject:m});case 32:return C.debug("receive() | calling pc.setLocalDescription() [answer:%o]",h),e.next=35,this._pc.setLocalDescription(h);case 35:_=o(t),e.prev=36,x=u().mark((function e(){var t,n,o,i,a,s,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=S.value,n=t.kind,o=t.trackId,i=t.rtpParameters,a=o,s=n,c=R._pc.getReceivers().find((function(e){return e.track&&e.track.id===a}))){e.next=7;break}throw new Error("new RTCRtpReceiver not");case 7:R._mapRecvLocalIdInfo.set(a,{mid:s,rtpParameters:i,rtpReceiver:c}),r.push({localId:a,track:c.track,rtpReceiver:c});case 9:case"end":return e.stop()}}),e)})),_.s();case 39:if((S=_.n()).done){e.next=43;break}return e.delegateYield(x(),"t2",41);case 41:e.next=39;break;case 43:e.next=48;break;case 45:e.prev=45,e.t3=e.catch(36),_.e(e.t3);case 48:return e.prev=48,_.f(),e.finish(48);case 51:return e.abrupt("return",r);case 52:case"end":return e.stop()}}),e,this,[[13,22,25,28],[36,45,48,51]])}))),function(e){return w.apply(this,arguments)})},{key:"stopReceiving",value:(g=l(u().mark((function e(t){var r,n,i,a,s,c,p,l;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=o(t);try{for(r.s();!(n=r.n()).done;)i=n.value,C.debug("stopReceiving() [localId:%s]",i),a=this._mapRecvLocalIdInfo.get(i)||{},s=a.mid,c=a.rtpParameters,this._mapRecvLocalIdInfo.delete(i),this._remoteSdp.planBStopReceiving({mid:s,offerRtpParameters:c})}catch(e){r.e(e)}finally{r.f()}return p={type:"offer",sdp:this._remoteSdp.getSdp()},C.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",p),e.next=7,this._pc.setRemoteDescription(p);case 7:return e.next=9,this._pc.createAnswer();case 9:return l=e.sent,C.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",l),e.next=13,this._pc.setLocalDescription(l);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"pauseReceiving",value:(y=l(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return y.apply(this,arguments)})},{key:"resumeReceiving",value:(v=l(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return v.apply(this,arguments)})},{key:"getReceiverStats",value:(f=l(u().mark((function e(t){var r,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertRecvDirection(),r=this._mapRecvLocalIdInfo.get(t)||{},n=r.rtpReceiver){e.next=4;break}throw new Error("associated RTCRtpReceiver not found");case 4:return e.abrupt("return",n.getStats());case 5:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"receiveDataChannel",value:(p=l(u().mark((function e(t){var r,n,o,i,a,s,c,p,l,d,f,h,m;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.sctpStreamParameters,n=t.label,o=t.protocol,this.assertRecvDirection(),i=r.streamId,a=r.ordered,s=r.maxPacketLifeTime,c=r.maxRetransmits,p={negotiated:!0,id:i,ordered:a,maxPacketLifeTime:s,maxRetransmitTime:s,maxRetransmits:c,protocol:o},C.debug("receiveDataChannel() [options:%o]",p),l=this._pc.createDataChannel(n,p),this._hasDataChannelMediaSection){e.next=23;break}return this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0}),d={type:"offer",sdp:this._remoteSdp.getSdp()},C.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),e.next=12,this._pc.setRemoteDescription(d);case 12:return e.next=14,this._pc.createAnswer();case 14:if(f=e.sent,this._transportReady){e.next=19;break}return m=b.parse(f.sdp),e.next=19,this.setupTransport({localDtlsRole:null!==(h=this._forcedLocalDtlsRole)&&void 0!==h?h:"client",localSdpObject:m});case 19:return C.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),e.next=22,this._pc.setLocalDescription(f);case 22:this._hasDataChannelMediaSection=!0;case 23:return e.abrupt("return",{dataChannel:l});case 24:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"setupTransport",value:(s=l(u().mark((function e(t){var r,n,o,i=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.localDtlsRole,(n=t.localSdpObject)||(n=b.parse(this._pc.localDescription.sdp)),(o=k.extractDtlsParameters({sdpObject:n})).role=r,this._remoteSdp.updateDtlsRole("client"===r?"server":"client"),e.next=7,new Promise((function(e,t){i.safeEmit("@connect",{dtlsParameters:o},e,t)}));case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],i=[{key:"createFactory",value:function(){return function(){return new W}}}],r&&d(t.prototype,r),i&&d(t,i),Object.defineProperty(t,"prototype",{writable:!1}),W}(R.HandlerInterface);t.Chrome67=E},6988:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a.apply(this,arguments)}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){var n,o,i;n=e,o=t,i=r[t],(o=f(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(){u=function(){return t};var e,t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",p=a.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof b?t:b,a=Object.create(o.prototype),s=new D(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var h="suspendedStart",m="suspendedYield",v="executing",y="completed",g={};function b(){}function w(){}function _(){}var S={};l(S,s,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(L([])));x&&x!==r&&o.call(x,s)&&(S=x);var R=_.prototype=b.prototype=Object.create(S);function P(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(i,a,s,c){var u=f(e[i],e,a);if("throw"!==u.type){var p=u.arg,l=p.value;return l&&"object"==n(l)&&o.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):t.resolve(l).then((function(e){p.value=e,s(p)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var a;i(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function O(t,r,n){var o=h;return function(i,a){if(o===v)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=E(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?y:m,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function E(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,E(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[s];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function r(){for(;++i<t.length;)if(o.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(n(t)+" is not iterable")}return w.prototype=_,i(R,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:w,configurable:!0}),w.displayName=l(_,p,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,l(e,p,"GeneratorFunction")),e.prototype=Object.create(R),e},t.awrap=function(e){return{__await:e}},P(C.prototype),l(C.prototype,c,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new C(d(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},P(R),l(R,p,"Generator"),l(R,s,(function(){return this})),l(R,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function p(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){p(i,n,o,a,s,"next",e)}function s(e){p(i,n,o,a,s,"throw",e)}a(void 0)}))}}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function f(e){var t=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===n(t)?t:String(t)}function h(e,t){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},h(e,t)}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}var v=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),y=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),g=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&v(t,e,r);return y(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Chrome70=void 0;var b=g(r(9652)),w=r(1916),_=g(r(5234)),S=g(r(6059)),k=g(r(5388)),x=g(r(8538)),R=r(1144),P=r(9196),C=r(9975),O=new w.Logger("Chrome70"),E={OS:1024,MIS:1024},T=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(K,e);var t,r,i,s,p,f,v,y,g,w,R,T,j,D,L,I,M,A,N,F,B,G,V,U,q,z,W=(q=K,z=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=m(q);if(z){var r=m(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function K(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,K),(e=W.call(this))._mapMidTransceiver=new Map,e._sendStream=new MediaStream,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return t=K,r=[{key:"name",get:function(){return"Chrome70"}},{key:"close",value:function(){if(O.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}},{key:"getNativeRtpCapabilities",value:(U=l(u().mark((function e(){var t,r,n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"}),e.prev=2,t.addTransceiver("audio"),t.addTransceiver("video"),e.next=7,t.createOffer();case 7:r=e.sent;try{t.close()}catch(e){}return n=b.parse(r.sdp),o=k.extractRtpCapabilities({sdpObject:n}),e.abrupt("return",o);case 14:e.prev=14,e.t0=e.catch(2);try{t.close()}catch(e){}throw e.t0;case 18:case"end":return e.stop()}}),e,null,[[2,14]])}))),function(){return U.apply(this,arguments)})},{key:"getNativeSctpCapabilities",value:(V=l(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:E});case 2:case"end":return e.stop()}}),e)}))),function(){return V.apply(this,arguments)})},{key:"run",value:function(e){var t=this,r=e.direction,n=e.iceParameters,o=e.iceCandidates,i=e.dtlsParameters,a=e.sctpParameters,s=e.iceServers,u=e.iceTransportPolicy,p=e.additionalSettings,l=e.proprietaryConstraints,d=e.extendedRtpCapabilities;O.debug("run()"),this._direction=r,this._remoteSdp=new P.RemoteSdp({iceParameters:n,iceCandidates:o,dtlsParameters:i,sctpParameters:a}),this._sendingRtpParametersByKind={audio:S.getSendingRtpParameters("audio",d),video:S.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:S.getSendingRemoteRtpParameters("audio",d),video:S.getSendingRemoteRtpParameters("video",d)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection(c({iceServers:s||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"},p),l),this._pc.addEventListener("icegatheringstatechange",(function(){t.emit("@icegatheringstatechange",t._pc.iceGatheringState)})),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(function(){t.emit("@connectionstatechange",t._pc.connectionState)})):this._pc.addEventListener("iceconnectionstatechange",(function(){switch(O.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:(G=l(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:O.debug("updateIceServers()"),(r=this._pc.getConfiguration()).iceServers=t,this._pc.setConfiguration(r);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return G.apply(this,arguments)})},{key:"restartIce",value:(B=l(u().mark((function e(t){var r,n,o,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(O.debug("restartIce()"),this._remoteSdp.updateIceParameters(t),this._transportReady){e.next=4;break}return e.abrupt("return");case 4:if("send"!==this._direction){e.next=17;break}return e.next=7,this._pc.createOffer({iceRestart:!0});case 7:return r=e.sent,O.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),e.next=11,this._pc.setLocalDescription(r);case 11:return n={type:"answer",sdp:this._remoteSdp.getSdp()},O.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),e.next=15,this._pc.setRemoteDescription(n);case 15:e.next=27;break;case 17:return o={type:"offer",sdp:this._remoteSdp.getSdp()},O.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=21,this._pc.setRemoteDescription(o);case 21:return e.next=23,this._pc.createAnswer();case 23:return i=e.sent,O.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",i),e.next=27,this._pc.setLocalDescription(i);case 27:case"end":return e.stop()}}),e,this)}))),function(e){return B.apply(this,arguments)})},{key:"getTransportStats",value:(F=l(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)}))),function(){return F.apply(this,arguments)})},{key:"send",value:(N=l(u().mark((function e(t){var r,n,i,s,c,p,l,d,f,h,m,v,y,g,w,R,P,E,T,j,D,L,I;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.track,n=t.encodings,i=t.codecOptions,s=t.codec,this.assertSendDirection(),O.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),(c=_.clone(this._sendingRtpParametersByKind[r.kind])).codecs=S.reduceCodecs(c.codecs,s),(p=_.clone(this._sendingRemoteRtpParametersByKind[r.kind])).codecs=S.reduceCodecs(p.codecs,s),l=this._remoteSdp.getNextMediaSectionIdx(),d=this._pc.addTransceiver(r,{direction:"sendonly",streams:[this._sendStream]}),e.next=11,this._pc.createOffer();case 11:if(f=e.sent,h=b.parse(f.sdp),this._transportReady){e.next=16;break}return e.next=16,this.setupTransport({localDtlsRole:null!==(v=this._forcedLocalDtlsRole)&&void 0!==v?v:"client",localSdpObject:h});case 16:return n&&n.length>1&&(O.debug("send() | enabling legacy simulcast"),h=b.parse(f.sdp),m=h.media[l.idx],x.addLegacySimulcast({offerMediaObject:m,numStreams:n.length}),f={type:"offer",sdp:b.write(h)}),y=!1,g=(0,C.parse)((n||[{}])[0].scalabilityMode),n&&1===n.length&&g.spatialLayers>1&&"video/vp9"===c.codecs[0].mimeType.toLowerCase()&&(O.debug("send() | enabling legacy simulcast for VP9 SVC"),y=!0,h=b.parse(f.sdp),m=h.media[l.idx],x.addLegacySimulcast({offerMediaObject:m,numStreams:g.spatialLayers}),f={type:"offer",sdp:b.write(h)}),O.debug("send() | calling pc.setLocalDescription() [offer:%o]",f),e.next=23,this._pc.setLocalDescription(f);case 23:if(!n){e.next=38;break}O.debug("send() | applying given encodings"),w=d.sender.getParameters(),R=0;case 27:if(!(R<(w.encodings||[]).length)){e.next=36;break}if(P=w.encodings[R],E=n[R]){e.next=32;break}return e.abrupt("break",36);case 32:w.encodings[R]=a(P,E);case 33:++R,e.next=27;break;case 36:return e.next=38,d.sender.setParameters(w);case 38:if(T=d.mid,c.mid=T,h=b.parse(this._pc.localDescription.sdp),m=h.media[l.idx],c.rtcp.cname=k.getCname({offerMediaObject:m}),c.encodings=x.getRtpEncodings({offerMediaObject:m}),n)for(j=0;j<c.encodings.length;++j)n[j]&&a(c.encodings[j],n[j]);if(y&&(c.encodings=[c.encodings[0]]),c.encodings.length>1&&("video/vp8"===c.codecs[0].mimeType.toLowerCase()||"video/h264"===c.codecs[0].mimeType.toLowerCase())){D=o(c.encodings);try{for(D.s();!(L=D.n()).done;)L.value.scalabilityMode="L1T3"}catch(e){D.e(e)}finally{D.f()}}return this._remoteSdp.send({offerMediaObject:m,reuseMid:l.reuseMid,offerRtpParameters:c,answerRtpParameters:p,codecOptions:i}),I={type:"answer",sdp:this._remoteSdp.getSdp()},O.debug("send() | calling pc.setRemoteDescription() [answer:%o]",I),e.next=52,this._pc.setRemoteDescription(I);case 52:return this._mapMidTransceiver.set(T,d),e.abrupt("return",{localId:T,rtpParameters:c,rtpSender:d.sender});case 54:case"end":return e.stop()}}),e,this)}))),function(e){return N.apply(this,arguments)})},{key:"stopSending",value:(A=l(u().mark((function e(t){var r,n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),O.debug("stopSending() [localId:%s]",t),r=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:if(r.sender.replaceTrack(null),this._pc.removeTrack(r.sender),this._remoteSdp.closeMediaSection(r.mid))try{r.stop()}catch(e){}return e.next=11,this._pc.createOffer();case 11:return n=e.sent,O.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),e.next=15,this._pc.setLocalDescription(n);case 15:return o={type:"answer",sdp:this._remoteSdp.getSdp()},O.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=19,this._pc.setRemoteDescription(o);case 19:this._mapMidTransceiver.delete(t);case 20:case"end":return e.stop()}}),e,this)}))),function(e){return A.apply(this,arguments)})},{key:"pauseSending",value:(M=l(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return M.apply(this,arguments)})},{key:"resumeSending",value:(I=l(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return I.apply(this,arguments)})},{key:"replaceTrack",value:(L=l(u().mark((function e(t,r){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),r?O.debug("replaceTrack() [localId:%s, track.id:%s]",t,r.id):O.debug("replaceTrack() [localId:%s, no track]",t),n=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return e.next=7,n.sender.replaceTrack(r);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return L.apply(this,arguments)})},{key:"setMaxSpatialLayer",value:(D=l(u().mark((function e(t,r){var n,o,i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),O.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,r),n=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return(o=n.sender.getParameters()).encodings.forEach((function(e,t){e.active=t<=r})),e.next=9,n.sender.setParameters(o);case 9:return this._remoteSdp.muxMediaSectionSimulcast(t,o.encodings),e.next=12,this._pc.createOffer();case 12:return i=e.sent,O.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",i),e.next=16,this._pc.setLocalDescription(i);case 16:return a={type:"answer",sdp:this._remoteSdp.getSdp()},O.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=20,this._pc.setRemoteDescription(a);case 20:case"end":return e.stop()}}),e,this)}))),function(e,t){return D.apply(this,arguments)})},{key:"setRtpEncodingParameters",value:(j=l(u().mark((function e(t,r){var n,o,i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),O.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,r),n=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return(o=n.sender.getParameters()).encodings.forEach((function(e,t){o.encodings[t]=c(c({},e),r)})),e.next=9,n.sender.setParameters(o);case 9:return this._remoteSdp.muxMediaSectionSimulcast(t,o.encodings),e.next=12,this._pc.createOffer();case 12:return i=e.sent,O.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",i),e.next=16,this._pc.setLocalDescription(i);case 16:return a={type:"answer",sdp:this._remoteSdp.getSdp()},O.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=20,this._pc.setRemoteDescription(a);case 20:case"end":return e.stop()}}),e,this)}))),function(e,t){return j.apply(this,arguments)})},{key:"getSenderStats",value:(T=l(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),r=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return e.abrupt("return",r.sender.getStats());case 5:case"end":return e.stop()}}),e,this)}))),function(e){return T.apply(this,arguments)})},{key:"sendDataChannel",value:(R=l(u().mark((function e(t){var r,n,o,i,a,s,c,p,l,d,f,h,m;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.ordered,n=t.maxPacketLifeTime,o=t.maxRetransmits,i=t.label,a=t.protocol,this.assertSendDirection(),s={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmitTime:n,maxRetransmits:o,protocol:a},O.debug("sendDataChannel() [options:%o]",s),c=this._pc.createDataChannel(i,s),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%E.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=9,this._pc.createOffer();case 9:if(p=e.sent,l=b.parse(p.sdp),d=l.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=15;break}return e.next=15,this.setupTransport({localDtlsRole:null!==(f=this._forcedLocalDtlsRole)&&void 0!==f?f:"client",localSdpObject:l});case 15:return O.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",p),e.next=18,this._pc.setLocalDescription(p);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:d}),h={type:"answer",sdp:this._remoteSdp.getSdp()},O.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",h),e.next=23,this._pc.setRemoteDescription(h);case 23:this._hasDataChannelMediaSection=!0;case 24:return m={streamId:s.id,ordered:s.ordered,maxPacketLifeTime:s.maxPacketLifeTime,maxRetransmits:s.maxRetransmits},e.abrupt("return",{dataChannel:c,sctpStreamParameters:m});case 26:case"end":return e.stop()}}),e,this)}))),function(e){return R.apply(this,arguments)})},{key:"receive",value:(w=l(u().mark((function e(t){var r,n,i,a,s,c,p,l,d,f,h,m,v,y,g,w,_,S,x,R,P=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=[],n=new Map,i=o(t);try{for(i.s();!(a=i.n()).done;)s=a.value,c=s.trackId,p=s.kind,l=s.rtpParameters,d=s.streamId,O.debug("receive() [trackId:%s, kind:%s]",c,p),f=l.mid||String(this._mapMidTransceiver.size),n.set(c,f),this._remoteSdp.receive({mid:f,kind:p,offerRtpParameters:l,streamId:d||l.rtcp.cname,trackId:c})}catch(e){i.e(e)}finally{i.f()}return h={type:"offer",sdp:this._remoteSdp.getSdp()},O.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",h),e.next=9,this._pc.setRemoteDescription(h);case 9:return e.next=11,this._pc.createAnswer();case 11:m=e.sent,v=b.parse(m.sdp),y=o(t),e.prev=14,w=u().mark((function e(){var t,r,o,i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=g.value,r=t.trackId,o=t.rtpParameters,i=n.get(r),a=v.media.find((function(e){return String(e.mid)===i})),k.applyCodecParameters({offerRtpParameters:o,answerMediaObject:a});case 5:case"end":return e.stop()}}),e)})),y.s();case 17:if((g=y.n()).done){e.next=21;break}return e.delegateYield(w(),"t0",19);case 19:e.next=17;break;case 21:e.next=26;break;case 23:e.prev=23,e.t1=e.catch(14),y.e(e.t1);case 26:return e.prev=26,y.f(),e.finish(26);case 29:if(m={type:"answer",sdp:b.write(v)},this._transportReady){e.next=33;break}return e.next=33,this.setupTransport({localDtlsRole:null!==(_=this._forcedLocalDtlsRole)&&void 0!==_?_:"client",localSdpObject:v});case 33:return O.debug("receive() | calling pc.setLocalDescription() [answer:%o]",m),e.next=36,this._pc.setLocalDescription(m);case 36:S=o(t),e.prev=37,R=u().mark((function e(){var t,o,i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=x.value,o=t.trackId,i=n.get(o),a=P._pc.getTransceivers().find((function(e){return e.mid===i}))){e.next=6;break}throw new Error("new RTCRtpTransceiver not found");case 6:P._mapMidTransceiver.set(i,a),r.push({localId:i,track:a.receiver.track,rtpReceiver:a.receiver});case 8:case"end":return e.stop()}}),e)})),S.s();case 40:if((x=S.n()).done){e.next=44;break}return e.delegateYield(R(),"t2",42);case 42:e.next=40;break;case 44:e.next=49;break;case 46:e.prev=46,e.t3=e.catch(37),S.e(e.t3);case 49:return e.prev=49,S.f(),e.finish(49);case 52:return e.abrupt("return",r);case 53:case"end":return e.stop()}}),e,this,[[14,23,26,29],[37,46,49,52]])}))),function(e){return w.apply(this,arguments)})},{key:"stopReceiving",value:(g=l(u().mark((function e(t){var r,n,i,a,s,c,p,l,d;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=o(t),e.prev=2,r.s();case 4:if((n=r.n()).done){e.next=13;break}if(i=n.value,O.debug("stopReceiving() [localId:%s]",i),a=this._mapMidTransceiver.get(i)){e.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:this._remoteSdp.closeMediaSection(a.mid);case 11:e.next=4;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:return s={type:"offer",sdp:this._remoteSdp.getSdp()},O.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",s),e.next=25,this._pc.setRemoteDescription(s);case 25:return e.next=27,this._pc.createAnswer();case 27:return c=e.sent,O.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",c),e.next=31,this._pc.setLocalDescription(c);case 31:p=o(t);try{for(p.s();!(l=p.n()).done;)d=l.value,this._mapMidTransceiver.delete(d)}catch(e){p.e(e)}finally{p.f()}case 33:case"end":return e.stop()}}),e,this,[[2,15,18,21]])}))),function(e){return g.apply(this,arguments)})},{key:"pauseReceiving",value:(y=l(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return y.apply(this,arguments)})},{key:"resumeReceiving",value:(v=l(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return v.apply(this,arguments)})},{key:"getReceiverStats",value:(f=l(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertRecvDirection(),r=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return e.abrupt("return",r.receiver.getStats());case 5:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"receiveDataChannel",value:(p=l(u().mark((function e(t){var r,n,o,i,a,s,c,p,l,d,f,h,m;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.sctpStreamParameters,n=t.label,o=t.protocol,this.assertRecvDirection(),i=r.streamId,a=r.ordered,s=r.maxPacketLifeTime,c=r.maxRetransmits,p={negotiated:!0,id:i,ordered:a,maxPacketLifeTime:s,maxRetransmitTime:s,maxRetransmits:c,protocol:o},O.debug("receiveDataChannel() [options:%o]",p),l=this._pc.createDataChannel(n,p),this._hasDataChannelMediaSection){e.next=23;break}return this._remoteSdp.receiveSctpAssociation(),d={type:"offer",sdp:this._remoteSdp.getSdp()},O.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),e.next=12,this._pc.setRemoteDescription(d);case 12:return e.next=14,this._pc.createAnswer();case 14:if(f=e.sent,this._transportReady){e.next=19;break}return m=b.parse(f.sdp),e.next=19,this.setupTransport({localDtlsRole:null!==(h=this._forcedLocalDtlsRole)&&void 0!==h?h:"client",localSdpObject:m});case 19:return O.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),e.next=22,this._pc.setLocalDescription(f);case 22:this._hasDataChannelMediaSection=!0;case 23:return e.abrupt("return",{dataChannel:l});case 24:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"setupTransport",value:(s=l(u().mark((function e(t){var r,n,o,i=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.localDtlsRole,(n=t.localSdpObject)||(n=b.parse(this._pc.localDescription.sdp)),(o=k.extractDtlsParameters({sdpObject:n})).role=r,this._remoteSdp.updateDtlsRole("client"===r?"server":"client"),e.next=7,new Promise((function(e,t){i.safeEmit("@connect",{dtlsParameters:o},e,t)}));case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],i=[{key:"createFactory",value:function(){return function(){return new K}}}],r&&d(t.prototype,r),i&&d(t,i),Object.defineProperty(t,"prototype",{writable:!1}),K}(R.HandlerInterface);t.Chrome70=T},5031:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a.apply(this,arguments)}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){var n,o,i;n=e,o=t,i=r[t],(o=f(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(){u=function(){return t};var e,t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",p=a.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof b?t:b,a=Object.create(o.prototype),s=new D(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var h="suspendedStart",m="suspendedYield",v="executing",y="completed",g={};function b(){}function w(){}function _(){}var S={};l(S,s,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(L([])));x&&x!==r&&o.call(x,s)&&(S=x);var R=_.prototype=b.prototype=Object.create(S);function P(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(i,a,s,c){var u=f(e[i],e,a);if("throw"!==u.type){var p=u.arg,l=p.value;return l&&"object"==n(l)&&o.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):t.resolve(l).then((function(e){p.value=e,s(p)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var a;i(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function O(t,r,n){var o=h;return function(i,a){if(o===v)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=E(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?y:m,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function E(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,E(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[s];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function r(){for(;++i<t.length;)if(o.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(n(t)+" is not iterable")}return w.prototype=_,i(R,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:w,configurable:!0}),w.displayName=l(_,p,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,l(e,p,"GeneratorFunction")),e.prototype=Object.create(R),e},t.awrap=function(e){return{__await:e}},P(C.prototype),l(C.prototype,c,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new C(d(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},P(R),l(R,p,"Generator"),l(R,s,(function(){return this})),l(R,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function p(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){p(i,n,o,a,s,"next",e)}function s(e){p(i,n,o,a,s,"throw",e)}a(void 0)}))}}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function f(e){var t=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===n(t)?t:String(t)}function h(e,t){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},h(e,t)}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}var v=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),y=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),g=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&v(t,e,r);return y(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Chrome74=void 0;var b=g(r(9652)),w=r(1916),_=g(r(5234)),S=g(r(6059)),k=g(r(5388)),x=g(r(8538)),R=g(r(337)),P=r(6020),C=r(1144),O=r(9196),E=r(9975),T=new w.Logger("Chrome74"),j={OS:1024,MIS:1024},D=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(Y,e);var t,r,i,s,p,f,v,y,g,w,C,D,L,I,M,A,N,F,B,G,V,U,q,z,W,K,H=(W=Y,K=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=m(W);if(K){var r=m(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function Y(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Y),(e=H.call(this))._closed=!1,e._mapMidTransceiver=new Map,e._sendStream=new MediaStream,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return t=Y,r=[{key:"name",get:function(){return"Chrome74"}},{key:"close",value:function(){if(T.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}}},{key:"getNativeRtpCapabilities",value:(z=l(u().mark((function e(){var t,r,n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"}),e.prev=2,t.addTransceiver("audio"),t.addTransceiver("video"),e.next=7,t.createOffer();case 7:r=e.sent;try{t.close()}catch(e){}return n=b.parse(r.sdp),o=k.extractRtpCapabilities({sdpObject:n}),R.addNackSuppportForOpus(o),e.abrupt("return",o);case 15:e.prev=15,e.t0=e.catch(2);try{t.close()}catch(e){}throw e.t0;case 19:case"end":return e.stop()}}),e,null,[[2,15]])}))),function(){return z.apply(this,arguments)})},{key:"getNativeSctpCapabilities",value:(q=l(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:j});case 2:case"end":return e.stop()}}),e)}))),function(){return q.apply(this,arguments)})},{key:"run",value:function(e){var t=this,r=e.direction,n=e.iceParameters,o=e.iceCandidates,i=e.dtlsParameters,a=e.sctpParameters,s=e.iceServers,u=e.iceTransportPolicy,p=e.additionalSettings,l=e.proprietaryConstraints,d=e.extendedRtpCapabilities;T.debug("run()"),this._direction=r,this._remoteSdp=new O.RemoteSdp({iceParameters:n,iceCandidates:o,dtlsParameters:i,sctpParameters:a}),this._sendingRtpParametersByKind={audio:S.getSendingRtpParameters("audio",d),video:S.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:S.getSendingRemoteRtpParameters("audio",d),video:S.getSendingRemoteRtpParameters("video",d)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection(c({iceServers:s||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"},p),l),this._pc.addEventListener("icegatheringstatechange",(function(){t.emit("@icegatheringstatechange",t._pc.iceGatheringState)})),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(function(){t.emit("@connectionstatechange",t._pc.connectionState)})):(T.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",(function(){switch(t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}})))}},{key:"updateIceServers",value:(U=l(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertNotClosed(),T.debug("updateIceServers()"),(r=this._pc.getConfiguration()).iceServers=t,this._pc.setConfiguration(r);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return U.apply(this,arguments)})},{key:"restartIce",value:(V=l(u().mark((function e(t){var r,n,o,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),T.debug("restartIce()"),this._remoteSdp.updateIceParameters(t),this._transportReady){e.next=5;break}return e.abrupt("return");case 5:if("send"!==this._direction){e.next=18;break}return e.next=8,this._pc.createOffer({iceRestart:!0});case 8:return r=e.sent,T.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),e.next=12,this._pc.setLocalDescription(r);case 12:return n={type:"answer",sdp:this._remoteSdp.getSdp()},T.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),e.next=16,this._pc.setRemoteDescription(n);case 16:e.next=28;break;case 18:return o={type:"offer",sdp:this._remoteSdp.getSdp()},T.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=22,this._pc.setRemoteDescription(o);case 22:return e.next=24,this._pc.createAnswer();case 24:return i=e.sent,T.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",i),e.next=28,this._pc.setLocalDescription(i);case 28:case"end":return e.stop()}}),e,this)}))),function(e){return V.apply(this,arguments)})},{key:"getTransportStats",value:(G=l(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.assertNotClosed(),e.abrupt("return",this._pc.getStats());case 2:case"end":return e.stop()}}),e,this)}))),function(){return G.apply(this,arguments)})},{key:"send",value:(B=l(u().mark((function e(t){var r,n,i,s,c,p,l,d,f,h,m,v,y,g,w,R,P,C,O,j;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.track,n=t.encodings,i=t.codecOptions,s=t.codec,this.assertNotClosed(),this.assertSendDirection(),T.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),n&&n.length>1&&n.forEach((function(e,t){e.rid="r".concat(t)})),(c=_.clone(this._sendingRtpParametersByKind[r.kind])).codecs=S.reduceCodecs(c.codecs,s),(p=_.clone(this._sendingRemoteRtpParametersByKind[r.kind])).codecs=S.reduceCodecs(p.codecs,s),l=this._remoteSdp.getNextMediaSectionIdx(),d=this._pc.addTransceiver(r,{direction:"sendonly",streams:[this._sendStream],sendEncodings:n}),e.next=13,this._pc.createOffer();case 13:if(f=e.sent,h=b.parse(f.sdp),this._transportReady){e.next=18;break}return e.next=18,this.setupTransport({localDtlsRole:null!==(v=this._forcedLocalDtlsRole)&&void 0!==v?v:"client",localSdpObject:h});case 18:return y=!1,g=(0,E.parse)((n||[{}])[0].scalabilityMode),n&&1===n.length&&g.spatialLayers>1&&"video/vp9"===c.codecs[0].mimeType.toLowerCase()&&(T.debug("send() | enabling legacy simulcast for VP9 SVC"),y=!0,h=b.parse(f.sdp),m=h.media[l.idx],x.addLegacySimulcast({offerMediaObject:m,numStreams:g.spatialLayers}),f={type:"offer",sdp:b.write(h)}),T.debug("send() | calling pc.setLocalDescription() [offer:%o]",f),e.next=24,this._pc.setLocalDescription(f);case 24:if(w=d.mid,c.mid=w,h=b.parse(this._pc.localDescription.sdp),m=h.media[l.idx],c.rtcp.cname=k.getCname({offerMediaObject:m}),n?1===n.length?(a((R=x.getRtpEncodings({offerMediaObject:m}))[0],n[0]),y&&(R=[R[0]]),c.encodings=R):c.encodings=n:c.encodings=x.getRtpEncodings({offerMediaObject:m}),c.encodings.length>1&&("video/vp8"===c.codecs[0].mimeType.toLowerCase()||"video/h264"===c.codecs[0].mimeType.toLowerCase())){P=o(c.encodings);try{for(P.s();!(C=P.n()).done;)(O=C.value).scalabilityMode?O.scalabilityMode="L1T".concat(g.temporalLayers):O.scalabilityMode="L1T3"}catch(e){P.e(e)}finally{P.f()}}return this._remoteSdp.send({offerMediaObject:m,reuseMid:l.reuseMid,offerRtpParameters:c,answerRtpParameters:p,codecOptions:i,extmapAllowMixed:!0}),j={type:"answer",sdp:this._remoteSdp.getSdp()},T.debug("send() | calling pc.setRemoteDescription() [answer:%o]",j),e.next=36,this._pc.setRemoteDescription(j);case 36:return this._mapMidTransceiver.set(w,d),e.abrupt("return",{localId:w,rtpParameters:c,rtpSender:d.sender});case 38:case"end":return e.stop()}}),e,this)}))),function(e){return B.apply(this,arguments)})},{key:"stopSending",value:(F=l(u().mark((function e(t){var r,n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),T.debug("stopSending() [localId:%s]",t),!this._closed){e.next=4;break}return e.abrupt("return");case 4:if(r=this._mapMidTransceiver.get(t)){e.next=7;break}throw new Error("associated RTCRtpTransceiver not found");case 7:if(r.sender.replaceTrack(null),this._pc.removeTrack(r.sender),this._remoteSdp.closeMediaSection(r.mid))try{r.stop()}catch(e){}return e.next=13,this._pc.createOffer();case 13:return n=e.sent,T.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),e.next=17,this._pc.setLocalDescription(n);case 17:return o={type:"answer",sdp:this._remoteSdp.getSdp()},T.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=21,this._pc.setRemoteDescription(o);case 21:this._mapMidTransceiver.delete(t);case 22:case"end":return e.stop()}}),e,this)}))),function(e){return F.apply(this,arguments)})},{key:"pauseSending",value:(N=l(u().mark((function e(t){var r,n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertSendDirection(),T.debug("pauseSending() [localId:%s]",t),r=this._mapMidTransceiver.get(t)){e.next=6;break}throw new Error("associated RTCRtpTransceiver not found");case 6:return r.direction="inactive",this._remoteSdp.pauseMediaSection(t),e.next=10,this._pc.createOffer();case 10:return n=e.sent,T.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",n),e.next=14,this._pc.setLocalDescription(n);case 14:return o={type:"answer",sdp:this._remoteSdp.getSdp()},T.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=18,this._pc.setRemoteDescription(o);case 18:case"end":return e.stop()}}),e,this)}))),function(e){return N.apply(this,arguments)})},{key:"resumeSending",value:(A=l(u().mark((function e(t){var r,n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertSendDirection(),T.debug("resumeSending() [localId:%s]",t),r=this._mapMidTransceiver.get(t),this._remoteSdp.resumeSendingMediaSection(t),r){e.next=7;break}throw new Error("associated RTCRtpTransceiver not found");case 7:return r.direction="sendonly",e.next=10,this._pc.createOffer();case 10:return n=e.sent,T.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",n),e.next=14,this._pc.setLocalDescription(n);case 14:return o={type:"answer",sdp:this._remoteSdp.getSdp()},T.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=18,this._pc.setRemoteDescription(o);case 18:case"end":return e.stop()}}),e,this)}))),function(e){return A.apply(this,arguments)})},{key:"replaceTrack",value:(M=l(u().mark((function e(t,r){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertSendDirection(),r?T.debug("replaceTrack() [localId:%s, track.id:%s]",t,r.id):T.debug("replaceTrack() [localId:%s, no track]",t),n=this._mapMidTransceiver.get(t)){e.next=6;break}throw new Error("associated RTCRtpTransceiver not found");case 6:return e.next=8,n.sender.replaceTrack(r);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return M.apply(this,arguments)})},{key:"setMaxSpatialLayer",value:(I=l(u().mark((function e(t,r){var n,o,i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertSendDirection(),T.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,r),n=this._mapMidTransceiver.get(t)){e.next=6;break}throw new Error("associated RTCRtpTransceiver not found");case 6:return(o=n.sender.getParameters()).encodings.forEach((function(e,t){e.active=t<=r})),e.next=10,n.sender.setParameters(o);case 10:return this._remoteSdp.muxMediaSectionSimulcast(t,o.encodings),e.next=13,this._pc.createOffer();case 13:return i=e.sent,T.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",i),e.next=17,this._pc.setLocalDescription(i);case 17:return a={type:"answer",sdp:this._remoteSdp.getSdp()},T.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=21,this._pc.setRemoteDescription(a);case 21:case"end":return e.stop()}}),e,this)}))),function(e,t){return I.apply(this,arguments)})},{key:"setRtpEncodingParameters",value:(L=l(u().mark((function e(t,r){var n,o,i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertSendDirection(),T.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,r),n=this._mapMidTransceiver.get(t)){e.next=6;break}throw new Error("associated RTCRtpTransceiver not found");case 6:return(o=n.sender.getParameters()).encodings.forEach((function(e,t){o.encodings[t]=c(c({},e),r)})),e.next=10,n.sender.setParameters(o);case 10:return this._remoteSdp.muxMediaSectionSimulcast(t,o.encodings),e.next=13,this._pc.createOffer();case 13:return i=e.sent,T.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",i),e.next=17,this._pc.setLocalDescription(i);case 17:return a={type:"answer",sdp:this._remoteSdp.getSdp()},T.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=21,this._pc.setRemoteDescription(a);case 21:case"end":return e.stop()}}),e,this)}))),function(e,t){return L.apply(this,arguments)})},{key:"getSenderStats",value:(D=l(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertSendDirection(),r=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return e.abrupt("return",r.sender.getStats());case 6:case"end":return e.stop()}}),e,this)}))),function(e){return D.apply(this,arguments)})},{key:"sendDataChannel",value:(C=l(u().mark((function e(t){var r,n,o,i,a,s,c,p,l,d,f,h,m;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.ordered,n=t.maxPacketLifeTime,o=t.maxRetransmits,i=t.label,a=t.protocol,this.assertNotClosed(),this.assertSendDirection(),s={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmits:o,protocol:a},T.debug("sendDataChannel() [options:%o]",s),c=this._pc.createDataChannel(i,s),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%j.MIS,this._hasDataChannelMediaSection){e.next=25;break}return e.next=10,this._pc.createOffer();case 10:if(p=e.sent,l=b.parse(p.sdp),d=l.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=16;break}return e.next=16,this.setupTransport({localDtlsRole:null!==(f=this._forcedLocalDtlsRole)&&void 0!==f?f:"client",localSdpObject:l});case 16:return T.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",p),e.next=19,this._pc.setLocalDescription(p);case 19:return this._remoteSdp.sendSctpAssociation({offerMediaObject:d}),h={type:"answer",sdp:this._remoteSdp.getSdp()},T.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",h),e.next=24,this._pc.setRemoteDescription(h);case 24:this._hasDataChannelMediaSection=!0;case 25:return m={streamId:s.id,ordered:s.ordered,maxPacketLifeTime:s.maxPacketLifeTime,maxRetransmits:s.maxRetransmits},e.abrupt("return",{dataChannel:c,sctpStreamParameters:m});case 27:case"end":return e.stop()}}),e,this)}))),function(e){return C.apply(this,arguments)})},{key:"receive",value:(w=l(u().mark((function e(t){var r,n,i,a,s,c,p,l,d,f,h,m,v,y,g,w,_,S,x,R,P=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertNotClosed(),this.assertRecvDirection(),r=[],n=new Map,i=o(t);try{for(i.s();!(a=i.n()).done;)s=a.value,c=s.trackId,p=s.kind,l=s.rtpParameters,d=s.streamId,T.debug("receive() [trackId:%s, kind:%s]",c,p),f=l.mid||String(this._mapMidTransceiver.size),n.set(c,f),this._remoteSdp.receive({mid:f,kind:p,offerRtpParameters:l,streamId:d||l.rtcp.cname,trackId:c})}catch(e){i.e(e)}finally{i.f()}return h={type:"offer",sdp:this._remoteSdp.getSdp()},T.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",h),e.next=10,this._pc.setRemoteDescription(h);case 10:return e.next=12,this._pc.createAnswer();case 12:m=e.sent,v=b.parse(m.sdp),y=o(t),e.prev=15,w=u().mark((function e(){var t,r,o,i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=g.value,r=t.trackId,o=t.rtpParameters,i=n.get(r),a=v.media.find((function(e){return String(e.mid)===i})),k.applyCodecParameters({offerRtpParameters:o,answerMediaObject:a});case 5:case"end":return e.stop()}}),e)})),y.s();case 18:if((g=y.n()).done){e.next=22;break}return e.delegateYield(w(),"t0",20);case 20:e.next=18;break;case 22:e.next=27;break;case 24:e.prev=24,e.t1=e.catch(15),y.e(e.t1);case 27:return e.prev=27,y.f(),e.finish(27);case 30:if(m={type:"answer",sdp:b.write(v)},this._transportReady){e.next=34;break}return e.next=34,this.setupTransport({localDtlsRole:null!==(_=this._forcedLocalDtlsRole)&&void 0!==_?_:"client",localSdpObject:v});case 34:return T.debug("receive() | calling pc.setLocalDescription() [answer:%o]",m),e.next=37,this._pc.setLocalDescription(m);case 37:S=o(t),e.prev=38,R=u().mark((function e(){var t,o,i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=x.value,o=t.trackId,i=n.get(o),a=P._pc.getTransceivers().find((function(e){return e.mid===i}))){e.next=8;break}throw new Error("new RTCRtpTransceiver not found");case 8:P._mapMidTransceiver.set(i,a),r.push({localId:i,track:a.receiver.track,rtpReceiver:a.receiver});case 10:case"end":return e.stop()}}),e)})),S.s();case 41:if((x=S.n()).done){e.next=45;break}return e.delegateYield(R(),"t2",43);case 43:e.next=41;break;case 45:e.next=50;break;case 47:e.prev=47,e.t3=e.catch(38),S.e(e.t3);case 50:return e.prev=50,S.f(),e.finish(50);case 53:return e.abrupt("return",r);case 54:case"end":return e.stop()}}),e,this,[[15,24,27,30],[38,47,50,53]])}))),function(e){return w.apply(this,arguments)})},{key:"stopReceiving",value:(g=l(u().mark((function e(t){var r,n,i,a,s,c,p,l,d;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertRecvDirection(),!this._closed){e.next=3;break}return e.abrupt("return");case 3:r=o(t),e.prev=4,r.s();case 6:if((n=r.n()).done){e.next=15;break}if(i=n.value,T.debug("stopReceiving() [localId:%s]",i),a=this._mapMidTransceiver.get(i)){e.next=12;break}throw new Error("associated RTCRtpTransceiver not found");case 12:this._remoteSdp.closeMediaSection(a.mid);case 13:e.next=6;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(4),r.e(e.t0);case 20:return e.prev=20,r.f(),e.finish(20);case 23:return s={type:"offer",sdp:this._remoteSdp.getSdp()},T.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",s),e.next=27,this._pc.setRemoteDescription(s);case 27:return e.next=29,this._pc.createAnswer();case 29:return c=e.sent,T.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",c),e.next=33,this._pc.setLocalDescription(c);case 33:p=o(t);try{for(p.s();!(l=p.n()).done;)d=l.value,this._mapMidTransceiver.delete(d)}catch(e){p.e(e)}finally{p.f()}case 35:case"end":return e.stop()}}),e,this,[[4,17,20,23]])}))),function(e){return g.apply(this,arguments)})},{key:"pauseReceiving",value:(y=l(u().mark((function e(t){var r,n,i,a,s,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertNotClosed(),this.assertRecvDirection(),r=o(t),e.prev=3,r.s();case 5:if((n=r.n()).done){e.next=15;break}if(i=n.value,T.debug("pauseReceiving() [localId:%s]",i),a=this._mapMidTransceiver.get(i)){e.next=11;break}throw new Error("associated RTCRtpTransceiver not found");case 11:a.direction="inactive",this._remoteSdp.pauseMediaSection(i);case 13:e.next=5;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(3),r.e(e.t0);case 20:return e.prev=20,r.f(),e.finish(20);case 23:return s={type:"offer",sdp:this._remoteSdp.getSdp()},T.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",s),e.next=27,this._pc.setRemoteDescription(s);case 27:return e.next=29,this._pc.createAnswer();case 29:return c=e.sent,T.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",c),e.next=33,this._pc.setLocalDescription(c);case 33:case"end":return e.stop()}}),e,this,[[3,17,20,23]])}))),function(e){return y.apply(this,arguments)})},{key:"resumeReceiving",value:(v=l(u().mark((function e(t){var r,n,i,a,s,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertNotClosed(),this.assertRecvDirection(),r=o(t),e.prev=3,r.s();case 5:if((n=r.n()).done){e.next=15;break}if(i=n.value,T.debug("resumeReceiving() [localId:%s]",i),a=this._mapMidTransceiver.get(i)){e.next=11;break}throw new Error("associated RTCRtpTransceiver not found");case 11:a.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(i);case 13:e.next=5;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(3),r.e(e.t0);case 20:return e.prev=20,r.f(),e.finish(20);case 23:return s={type:"offer",sdp:this._remoteSdp.getSdp()},T.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",s),e.next=27,this._pc.setRemoteDescription(s);case 27:return e.next=29,this._pc.createAnswer();case 29:return c=e.sent,T.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",c),e.next=33,this._pc.setLocalDescription(c);case 33:case"end":return e.stop()}}),e,this,[[3,17,20,23]])}))),function(e){return v.apply(this,arguments)})},{key:"getReceiverStats",value:(f=l(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertRecvDirection(),r=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return e.abrupt("return",r.receiver.getStats());case 6:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"receiveDataChannel",value:(p=l(u().mark((function e(t){var r,n,o,i,a,s,c,p,l,d,f,h,m;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.sctpStreamParameters,n=t.label,o=t.protocol,this.assertNotClosed(),this.assertRecvDirection(),i=r.streamId,a=r.ordered,s=r.maxPacketLifeTime,c=r.maxRetransmits,p={negotiated:!0,id:i,ordered:a,maxPacketLifeTime:s,maxRetransmits:c,protocol:o},T.debug("receiveDataChannel() [options:%o]",p),l=this._pc.createDataChannel(n,p),this._hasDataChannelMediaSection){e.next=24;break}return this._remoteSdp.receiveSctpAssociation(),d={type:"offer",sdp:this._remoteSdp.getSdp()},T.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),e.next=13,this._pc.setRemoteDescription(d);case 13:return e.next=15,this._pc.createAnswer();case 15:if(f=e.sent,this._transportReady){e.next=20;break}return m=b.parse(f.sdp),e.next=20,this.setupTransport({localDtlsRole:null!==(h=this._forcedLocalDtlsRole)&&void 0!==h?h:"client",localSdpObject:m});case 20:return T.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),e.next=23,this._pc.setLocalDescription(f);case 23:this._hasDataChannelMediaSection=!0;case 24:return e.abrupt("return",{dataChannel:l});case 25:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"setupTransport",value:(s=l(u().mark((function e(t){var r,n,o,i=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.localDtlsRole,(n=t.localSdpObject)||(n=b.parse(this._pc.localDescription.sdp)),(o=k.extractDtlsParameters({sdpObject:n})).role=r,this._remoteSdp.updateDtlsRole("client"===r?"server":"client"),e.next=7,new Promise((function(e,t){i.safeEmit("@connect",{dtlsParameters:o},e,t)}));case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"assertNotClosed",value:function(){if(this._closed)throw new P.InvalidStateError("method called in a closed handler")}},{key:"assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],i=[{key:"createFactory",value:function(){return function(){return new Y}}}],r&&d(t.prototype,r),i&&d(t,i),Object.defineProperty(t,"prototype",{writable:!1}),Y}(C.HandlerInterface);t.Chrome74=D},7042:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){var n,o,i;n=e,o=t,i=r[t],(o=d(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(){a=function(){return t};var e,t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",p=s.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof b?t:b,a=Object.create(o.prototype),s=new D(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var h="suspendedStart",m="suspendedYield",v="executing",y="completed",g={};function b(){}function w(){}function _(){}var S={};l(S,c,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(L([])));x&&x!==r&&o.call(x,c)&&(S=x);var R=_.prototype=b.prototype=Object.create(S);function P(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(i,a,s,c){var u=f(e[i],e,a);if("throw"!==u.type){var p=u.arg,l=p.value;return l&&"object"==n(l)&&o.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):t.resolve(l).then((function(e){p.value=e,s(p)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var a;i(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function O(t,r,n){var o=h;return function(i,a){if(o===v)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=E(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?y:m,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function E(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,E(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function r(){for(;++i<t.length;)if(o.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(n(t)+" is not iterable")}return w.prototype=_,i(R,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:w,configurable:!0}),w.displayName=l(_,p,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,l(e,p,"GeneratorFunction")),e.prototype=Object.create(R),e},t.awrap=function(e){return{__await:e}},P(C.prototype),l(C.prototype,u,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new C(d(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},P(R),l(R,p,"Generator"),l(R,c,(function(){return this})),l(R,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function s(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function c(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){s(i,n,o,a,c,"next",e)}function c(e){s(i,n,o,a,c,"throw",e)}a(void 0)}))}}function u(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d(n.key),n)}}function d(e){var t=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===n(t)?t:String(t)}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}var m=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),v=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),y=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&m(t,e,r);return v(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Edge11=void 0;var g=r(1916),b=r(6020),w=y(r(5234)),_=y(r(6059)),S=y(r(6819)),k=r(1144),x=new g.Logger("Edge11"),R=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(V,e);var t,r,o,s,p,d,m,v,y,g,k,R,P,C,O,E,T,j,D,L,I,M,A,N,F,B,G=(F=V,B=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(F);if(B){var r=h(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function V(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,V),(e=G.call(this))._rtpSenders=new Map,e._rtpReceivers=new Map,e._nextSendLocalId=0,e._transportReady=!1,e}return t=V,r=[{key:"name",get:function(){return"Edge11"}},{key:"close",value:function(){x.debug("close()");try{this._iceGatherer.close()}catch(e){}try{this._iceTransport.stop()}catch(e){}try{this._dtlsTransport.stop()}catch(e){}var e,t=u(this._rtpSenders.values());try{for(t.s();!(e=t.n()).done;){var r=e.value;try{r.stop()}catch(e){}}}catch(e){t.e(e)}finally{t.f()}var n,o=u(this._rtpReceivers.values());try{for(o.s();!(n=o.n()).done;){var i=n.value;try{i.stop()}catch(e){}}}catch(e){o.e(e)}finally{o.f()}this.emit("@close")}},{key:"getNativeRtpCapabilities",value:(N=c(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x.debug("getNativeRtpCapabilities()"),e.abrupt("return",S.getCapabilities());case 2:case"end":return e.stop()}}),e)}))),function(){return N.apply(this,arguments)})},{key:"getNativeSctpCapabilities",value:(A=c(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:{OS:0,MIS:0}});case 2:case"end":return e.stop()}}),e)}))),function(){return A.apply(this,arguments)})},{key:"run",value:function(e){e.direction;var t=e.iceParameters,r=e.iceCandidates,n=e.dtlsParameters,o=(e.sctpParameters,e.iceServers),i=e.iceTransportPolicy,a=(e.additionalSettings,e.proprietaryConstraints,e.extendedRtpCapabilities);x.debug("run()"),this._sendingRtpParametersByKind={audio:_.getSendingRtpParameters("audio",a),video:_.getSendingRtpParameters("video",a)},this._remoteIceParameters=t,this._remoteIceCandidates=r,this._remoteDtlsParameters=n,this._cname="CNAME-".concat(w.generateRandomNumber()),this.setIceGatherer({iceServers:o,iceTransportPolicy:i}),this.setIceTransport(),this.setDtlsTransport()}},{key:"updateIceServers",value:(M=c(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new b.UnsupportedError("not supported");case 1:case"end":return e.stop()}}),e)}))),function(e){return M.apply(this,arguments)})},{key:"restartIce",value:(I=c(a().mark((function e(t){var r,n,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x.debug("restartIce()"),this._remoteIceParameters=t,this._transportReady){e.next=4;break}return e.abrupt("return");case 4:x.debug("restartIce() | calling iceTransport.start()"),this._iceTransport.start(this._iceGatherer,t,"controlling"),r=u(this._remoteIceCandidates);try{for(r.s();!(n=r.n()).done;)o=n.value,this._iceTransport.addRemoteCandidate(o)}catch(e){r.e(e)}finally{r.f()}this._iceTransport.addRemoteCandidate({});case 9:case"end":return e.stop()}}),e,this)}))),function(e){return I.apply(this,arguments)})},{key:"getTransportStats",value:(L=c(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._iceTransport.getStats());case 1:case"end":return e.stop()}}),e,this)}))),function(){return L.apply(this,arguments)})},{key:"send",value:(D=c(a().mark((function e(t){var r,n,o,i,s,c,p,l,d,f,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.track,n=t.encodings,t.codecOptions,o=t.codec,x.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),this._transportReady){e.next=5;break}return e.next=5,this.setupTransport({localDtlsRole:"server"});case 5:x.debug("send() | calling new RTCRtpSender()"),i=new RTCRtpSender(r,this._dtlsTransport),(s=w.clone(this._sendingRtpParametersByKind[r.kind])).codecs=_.reduceCodecs(s.codecs,o),c=s.codecs.some((function(e){return/.+\/rtx$/i.test(e.mimeType)})),n||(n=[{}]),p=u(n);try{for(p.s();!(l=p.n()).done;)(d=l.value).ssrc=w.generateRandomNumber(),c&&(d.rtx={ssrc:w.generateRandomNumber()})}catch(e){p.e(e)}finally{p.f()}return s.encodings=n,s.rtcp={cname:this._cname,reducedSize:!0,mux:!0},f=S.mangleRtpParameters(s),x.debug("send() | calling rtpSender.send() [params:%o]",f),e.next=19,i.send(f);case 19:return h=String(this._nextSendLocalId),this._nextSendLocalId++,this._rtpSenders.set(h,i),e.abrupt("return",{localId:h,rtpParameters:s,rtpSender:i});case 23:case"end":return e.stop()}}),e,this)}))),function(e){return D.apply(this,arguments)})},{key:"stopSending",value:(j=c(a().mark((function e(t){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x.debug("stopSending() [localId:%s]",t),r=this._rtpSenders.get(t)){e.next=4;break}throw new Error("RTCRtpSender not found");case 4:this._rtpSenders.delete(t),e.prev=5,x.debug("stopSending() | calling rtpSender.stop()"),r.stop(),e.next=14;break;case 10:throw e.prev=10,e.t0=e.catch(5),x.warn("stopSending() | rtpSender.stop() failed:%o",e.t0),e.t0;case 14:case"end":return e.stop()}}),e,this,[[5,10]])}))),function(e){return j.apply(this,arguments)})},{key:"pauseSending",value:(T=c(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return T.apply(this,arguments)})},{key:"resumeSending",value:(E=c(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return E.apply(this,arguments)})},{key:"replaceTrack",value:(O=c(a().mark((function e(t,r){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r?x.debug("replaceTrack() [localId:%s, track.id:%s]",t,r.id):x.debug("replaceTrack() [localId:%s, no track]",t),n=this._rtpSenders.get(t)){e.next=4;break}throw new Error("RTCRtpSender not found");case 4:n.setTrack(r);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return O.apply(this,arguments)})},{key:"setMaxSpatialLayer",value:(C=c(a().mark((function e(t,r){var n,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,r),n=this._rtpSenders.get(t)){e.next=4;break}throw new Error("RTCRtpSender not found");case 4:return(o=n.getParameters()).encodings.forEach((function(e,t){e.active=t<=r})),e.next=8,n.setParameters(o);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return C.apply(this,arguments)})},{key:"setRtpEncodingParameters",value:(P=c(a().mark((function e(t,r){var n,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,r),n=this._rtpSenders.get(t)){e.next=4;break}throw new Error("RTCRtpSender not found");case 4:return(o=n.getParameters()).encodings.forEach((function(e,t){o.encodings[t]=i(i({},e),r)})),e.next=8,n.setParameters(o);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return P.apply(this,arguments)})},{key:"getSenderStats",value:(R=c(a().mark((function e(t){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this._rtpSenders.get(t)){e.next=3;break}throw new Error("RTCRtpSender not found");case 3:return e.abrupt("return",r.getStats());case 4:case"end":return e.stop()}}),e,this)}))),function(e){return R.apply(this,arguments)})},{key:"sendDataChannel",value:(k=c(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new b.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)}))),function(e){return k.apply(this,arguments)})},{key:"receive",value:(g=c(a().mark((function e(t){var r,n,o,i,s,c,p,l,d,f,h,m,v,y,g;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],n=u(t);try{for(n.s();!(o=n.n()).done;)i=o.value,s=i.trackId,c=i.kind,x.debug("receive() [trackId:%s, kind:%s]",s,c)}catch(e){n.e(e)}finally{n.f()}if(this._transportReady){e.next=6;break}return e.next=6,this.setupTransport({localDtlsRole:"server"});case 6:p=u(t),e.prev=7,p.s();case 9:if((l=p.n()).done){e.next=24;break}return d=l.value,f=d.trackId,h=d.kind,m=d.rtpParameters,x.debug("receive() | calling new RTCRtpReceiver()"),(v=new RTCRtpReceiver(this._dtlsTransport,h)).addEventListener("error",(function(e){x.error('rtpReceiver "error" event [event:%o]',e)})),y=S.mangleRtpParameters(m),x.debug("receive() | calling rtpReceiver.receive() [params:%o]",y),e.next=19,v.receive(y);case 19:g=f,this._rtpReceivers.set(g,v),r.push({localId:g,track:v.track,rtpReceiver:v});case 22:e.next=9;break;case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(7),p.e(e.t0);case 29:return e.prev=29,p.f(),e.finish(29);case 32:return e.abrupt("return",r);case 33:case"end":return e.stop()}}),e,this,[[7,26,29,32]])}))),function(e){return g.apply(this,arguments)})},{key:"stopReceiving",value:(y=c(a().mark((function e(t){var r,n,o,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=u(t),e.prev=1,r.s();case 3:if((n=r.n()).done){e.next=13;break}if(o=n.value,x.debug("stopReceiving() [localId:%s]",o),i=this._rtpReceivers.get(o)){e.next=9;break}throw new Error("RTCRtpReceiver not found");case 9:this._rtpReceivers.delete(o);try{x.debug("stopReceiving() | calling rtpReceiver.stop()"),i.stop()}catch(e){x.warn("stopReceiving() | rtpReceiver.stop() failed:%o",e)}case 11:e.next=3;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:case"end":return e.stop()}}),e,this,[[1,15,18,21]])}))),function(e){return y.apply(this,arguments)})},{key:"pauseReceiving",value:(v=c(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return v.apply(this,arguments)})},{key:"resumeReceiving",value:(m=c(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return m.apply(this,arguments)})},{key:"getReceiverStats",value:(d=c(a().mark((function e(t){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this._rtpReceivers.get(t)){e.next=3;break}throw new Error("RTCRtpReceiver not found");case 3:return e.abrupt("return",r.getStats());case 4:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"receiveDataChannel",value:(p=c(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new b.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)}))),function(e){return p.apply(this,arguments)})},{key:"setIceGatherer",value:function(e){var t=e.iceServers,r=e.iceTransportPolicy,n=new RTCIceGatherer({iceServers:t||[],gatherPolicy:r||"all"});n.addEventListener("error",(function(e){x.error('iceGatherer "error" event [event:%o]',e)}));try{n.gather()}catch(e){x.debug("setIceGatherer() | iceGatherer.gather() failed: %s",e.toString())}this._iceGatherer=n}},{key:"setIceTransport",value:function(){var e=this,t=new RTCIceTransport(this._iceGatherer);t.addEventListener("statechange",(function(){switch(t.state){case"checking":e.emit("@connectionstatechange","connecting");break;case"connected":case"completed":e.emit("@connectionstatechange","connected");break;case"failed":e.emit("@connectionstatechange","failed");break;case"disconnected":e.emit("@connectionstatechange","disconnected");break;case"closed":e.emit("@connectionstatechange","closed")}})),t.addEventListener("icestatechange",(function(){switch(t.state){case"checking":e.emit("@connectionstatechange","connecting");break;case"connected":case"completed":e.emit("@connectionstatechange","connected");break;case"failed":e.emit("@connectionstatechange","failed");break;case"disconnected":e.emit("@connectionstatechange","disconnected");break;case"closed":e.emit("@connectionstatechange","closed")}})),t.addEventListener("candidatepairchange",(function(e){x.debug('iceTransport "candidatepairchange" event [pair:%o]',e.pair)})),this._iceTransport=t}},{key:"setDtlsTransport",value:function(){var e=this,t=new RTCDtlsTransport(this._iceTransport);t.addEventListener("statechange",(function(){x.debug('dtlsTransport "statechange" event [state:%s]',t.state)})),t.addEventListener("dtlsstatechange",(function(){x.debug('dtlsTransport "dtlsstatechange" event [state:%s]',t.state),"closed"===t.state&&e.emit("@connectionstatechange","closed")})),t.addEventListener("error",(function(e){x.error('dtlsTransport "error" event [event:%o]',e)})),this._dtlsTransport=t}},{key:"setupTransport",value:(s=c(a().mark((function e(t){var r,n,o,i,s,c=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.localDtlsRole,x.debug("setupTransport()"),(n=this._dtlsTransport.getLocalParameters()).role=r,e.next=6,new Promise((function(e,t){c.safeEmit("@connect",{dtlsParameters:n},e,t)}));case 6:this._iceTransport.start(this._iceGatherer,this._remoteIceParameters,"controlling"),o=u(this._remoteIceCandidates);try{for(o.s();!(i=o.n()).done;)s=i.value,this._iceTransport.addRemoteCandidate(s)}catch(e){o.e(e)}finally{o.f()}this._iceTransport.addRemoteCandidate({}),this._remoteDtlsParameters.fingerprints=this._remoteDtlsParameters.fingerprints.filter((function(e){return"sha-256"===e.algorithm||"sha-384"===e.algorithm||"sha-512"===e.algorithm})),this._dtlsTransport.start(this._remoteDtlsParameters),this._transportReady=!0;case 13:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})}],o=[{key:"createFactory",value:function(){return function(){return new V}}}],r&&l(t.prototype,r),o&&l(t,o),Object.defineProperty(t,"prototype",{writable:!1}),V}(k.HandlerInterface);t.Edge11=R},246:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a.apply(this,arguments)}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){var n,o,i;n=e,o=t,i=r[t],(o=f(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(){u=function(){return t};var e,t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",p=a.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof b?t:b,a=Object.create(o.prototype),s=new D(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var h="suspendedStart",m="suspendedYield",v="executing",y="completed",g={};function b(){}function w(){}function _(){}var S={};l(S,s,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(L([])));x&&x!==r&&o.call(x,s)&&(S=x);var R=_.prototype=b.prototype=Object.create(S);function P(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(i,a,s,c){var u=f(e[i],e,a);if("throw"!==u.type){var p=u.arg,l=p.value;return l&&"object"==n(l)&&o.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):t.resolve(l).then((function(e){p.value=e,s(p)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var a;i(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function O(t,r,n){var o=h;return function(i,a){if(o===v)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=E(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?y:m,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function E(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,E(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[s];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function r(){for(;++i<t.length;)if(o.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(n(t)+" is not iterable")}return w.prototype=_,i(R,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:w,configurable:!0}),w.displayName=l(_,p,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,l(e,p,"GeneratorFunction")),e.prototype=Object.create(R),e},t.awrap=function(e){return{__await:e}},P(C.prototype),l(C.prototype,c,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new C(d(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},P(R),l(R,p,"Generator"),l(R,s,(function(){return this})),l(R,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function p(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){p(i,n,o,a,s,"next",e)}function s(e){p(i,n,o,a,s,"throw",e)}a(void 0)}))}}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function f(e){var t=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===n(t)?t:String(t)}function h(e,t){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},h(e,t)}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}var v=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),y=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),g=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&v(t,e,r);return y(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Firefox60=void 0;var b=g(r(9652)),w=r(1916),_=r(6020),S=g(r(5234)),k=g(r(6059)),x=g(r(5388)),R=g(r(8538)),P=r(1144),C=r(9196),O=r(9975),E=new w.Logger("Firefox60"),T={OS:16,MIS:2048},j=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(H,e);var t,r,i,s,p,f,v,y,g,w,P,j,D,L,I,M,A,N,F,B,G,V,U,q,z,W,K=(z=H,W=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=m(z);if(W){var r=m(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function H(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,H),(e=K.call(this))._closed=!1,e._mapMidTransceiver=new Map,e._sendStream=new MediaStream,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return t=H,r=[{key:"name",get:function(){return"Firefox60"}},{key:"close",value:function(){if(E.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}}},{key:"getNativeRtpCapabilities",value:(q=l(u().mark((function e(){var t,r,n,o,i,a,s,c,p,l;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return E.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"}),(r=document.createElement("canvas")).getContext("2d"),n=r.captureStream(),o=n.getVideoTracks()[0],e.prev=6,t.addTransceiver("audio",{direction:"sendrecv"}),i=t.addTransceiver(o,{direction:"sendrecv"}),a=i.sender.getParameters(),s=[{rid:"r0",maxBitrate:1e5},{rid:"r1",maxBitrate:5e5}],a.encodings=s,e.next=14,i.sender.setParameters(a);case 14:return e.next=16,t.createOffer();case 16:c=e.sent;try{r.remove()}catch(e){}try{o.stop()}catch(e){}try{t.close()}catch(e){}return p=b.parse(c.sdp),l=x.extractRtpCapabilities({sdpObject:p}),e.abrupt("return",l);case 25:e.prev=25,e.t0=e.catch(6);try{r.remove()}catch(e){}try{o.stop()}catch(e){}try{t.close()}catch(e){}throw e.t0;case 31:case"end":return e.stop()}}),e,null,[[6,25]])}))),function(){return q.apply(this,arguments)})},{key:"getNativeSctpCapabilities",value:(U=l(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return E.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:T});case 2:case"end":return e.stop()}}),e)}))),function(){return U.apply(this,arguments)})},{key:"run",value:function(e){var t=this,r=e.direction,n=e.iceParameters,o=e.iceCandidates,i=e.dtlsParameters,a=e.sctpParameters,s=e.iceServers,u=e.iceTransportPolicy,p=e.additionalSettings,l=e.proprietaryConstraints,d=e.extendedRtpCapabilities;this.assertNotClosed(),E.debug("run()"),this._direction=r,this._remoteSdp=new C.RemoteSdp({iceParameters:n,iceCandidates:o,dtlsParameters:i,sctpParameters:a}),this._sendingRtpParametersByKind={audio:k.getSendingRtpParameters("audio",d),video:k.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:k.getSendingRemoteRtpParameters("audio",d),video:k.getSendingRemoteRtpParameters("video",d)},this._pc=new RTCPeerConnection(c({iceServers:s||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},p),l),this._pc.addEventListener("icegatheringstatechange",(function(){t.emit("@icegatheringstatechange",t._pc.iceGatheringState)})),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(function(){t.emit("@connectionstatechange",t._pc.connectionState)})):this._pc.addEventListener("iceconnectionstatechange",(function(){switch(E.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:(V=l(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw this.assertNotClosed(),new _.UnsupportedError("not supported");case 2:case"end":return e.stop()}}),e,this)}))),function(e){return V.apply(this,arguments)})},{key:"restartIce",value:(G=l(u().mark((function e(t){var r,n,o,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),E.debug("restartIce()"),this._remoteSdp.updateIceParameters(t),this._transportReady){e.next=5;break}return e.abrupt("return");case 5:if("send"!==this._direction){e.next=18;break}return e.next=8,this._pc.createOffer({iceRestart:!0});case 8:return r=e.sent,E.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),e.next=12,this._pc.setLocalDescription(r);case 12:return n={type:"answer",sdp:this._remoteSdp.getSdp()},E.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),e.next=16,this._pc.setRemoteDescription(n);case 16:e.next=28;break;case 18:return o={type:"offer",sdp:this._remoteSdp.getSdp()},E.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=22,this._pc.setRemoteDescription(o);case 22:return e.next=24,this._pc.createAnswer();case 24:return i=e.sent,E.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",i),e.next=28,this._pc.setLocalDescription(i);case 28:case"end":return e.stop()}}),e,this)}))),function(e){return G.apply(this,arguments)})},{key:"getTransportStats",value:(B=l(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.assertNotClosed(),e.abrupt("return",this._pc.getStats());case 2:case"end":return e.stop()}}),e,this)}))),function(){return B.apply(this,arguments)})},{key:"send",value:(F=l(u().mark((function e(t){var r,n,i,s,c,p,l,d,f,h,m,v,y,g,w,_,P,C;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.track,n=t.encodings,i=t.codecOptions,s=t.codec,this.assertNotClosed(),this.assertSendDirection(),E.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),n&&(n=S.clone(n)).length>1&&(n.forEach((function(e,t){e.rid="r".concat(t)})),n.reverse()),(c=S.clone(this._sendingRtpParametersByKind[r.kind])).codecs=k.reduceCodecs(c.codecs,s),(p=S.clone(this._sendingRemoteRtpParametersByKind[r.kind])).codecs=k.reduceCodecs(p.codecs,s),l=this._pc.addTransceiver(r,{direction:"sendonly",streams:[this._sendStream]}),!n){e.next=15;break}return(d=l.sender.getParameters()).encodings=n,e.next=15,l.sender.setParameters(d);case 15:return e.next=17,this._pc.createOffer();case 17:if(f=e.sent,h=b.parse(f.sdp),this._transportReady){e.next=22;break}return e.next=22,this.setupTransport({localDtlsRole:"client",localSdpObject:h});case 22:return m=(0,O.parse)((n||[{}])[0].scalabilityMode),E.debug("send() | calling pc.setLocalDescription() [offer:%o]",f),e.next=26,this._pc.setLocalDescription(f);case 26:if(v=l.mid,c.mid=v,h=b.parse(this._pc.localDescription.sdp),y=h.media[h.media.length-1],c.rtcp.cname=x.getCname({offerMediaObject:y}),n?1===n.length?(a((g=R.getRtpEncodings({offerMediaObject:y}))[0],n[0]),c.encodings=g):c.encodings=n.reverse():c.encodings=R.getRtpEncodings({offerMediaObject:y}),c.encodings.length>1&&("video/vp8"===c.codecs[0].mimeType.toLowerCase()||"video/h264"===c.codecs[0].mimeType.toLowerCase())){w=o(c.encodings);try{for(w.s();!(_=w.n()).done;)(P=_.value).scalabilityMode?P.scalabilityMode="L1T".concat(m.temporalLayers):P.scalabilityMode="L1T3"}catch(e){w.e(e)}finally{w.f()}}return this._remoteSdp.send({offerMediaObject:y,offerRtpParameters:c,answerRtpParameters:p,codecOptions:i,extmapAllowMixed:!0}),C={type:"answer",sdp:this._remoteSdp.getSdp()},E.debug("send() | calling pc.setRemoteDescription() [answer:%o]",C),e.next=38,this._pc.setRemoteDescription(C);case 38:return this._mapMidTransceiver.set(v,l),e.abrupt("return",{localId:v,rtpParameters:c,rtpSender:l.sender});case 40:case"end":return e.stop()}}),e,this)}))),function(e){return F.apply(this,arguments)})},{key:"stopSending",value:(N=l(u().mark((function e(t){var r,n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),E.debug("stopSending() [localId:%s]",t),!this._closed){e.next=4;break}return e.abrupt("return");case 4:if(r=this._mapMidTransceiver.get(t)){e.next=7;break}throw new Error("associated transceiver not found");case 7:return r.sender.replaceTrack(null),this._pc.removeTrack(r.sender),this._remoteSdp.disableMediaSection(r.mid),e.next=12,this._pc.createOffer();case 12:return n=e.sent,E.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),e.next=16,this._pc.setLocalDescription(n);case 16:return o={type:"answer",sdp:this._remoteSdp.getSdp()},E.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=20,this._pc.setRemoteDescription(o);case 20:this._mapMidTransceiver.delete(t);case 21:case"end":return e.stop()}}),e,this)}))),function(e){return N.apply(this,arguments)})},{key:"pauseSending",value:(A=l(u().mark((function e(t){var r,n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertSendDirection(),E.debug("pauseSending() [localId:%s]",t),r=this._mapMidTransceiver.get(t)){e.next=6;break}throw new Error("associated RTCRtpTransceiver not found");case 6:return r.direction="inactive",this._remoteSdp.pauseMediaSection(t),e.next=10,this._pc.createOffer();case 10:return n=e.sent,E.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",n),e.next=14,this._pc.setLocalDescription(n);case 14:return o={type:"answer",sdp:this._remoteSdp.getSdp()},E.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=18,this._pc.setRemoteDescription(o);case 18:case"end":return e.stop()}}),e,this)}))),function(e){return A.apply(this,arguments)})},{key:"resumeSending",value:(M=l(u().mark((function e(t){var r,n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertSendDirection(),E.debug("resumeSending() [localId:%s]",t),r=this._mapMidTransceiver.get(t)){e.next=6;break}throw new Error("associated RTCRtpTransceiver not found");case 6:return r.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(t),e.next=10,this._pc.createOffer();case 10:return n=e.sent,E.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",n),e.next=14,this._pc.setLocalDescription(n);case 14:return o={type:"answer",sdp:this._remoteSdp.getSdp()},E.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=18,this._pc.setRemoteDescription(o);case 18:case"end":return e.stop()}}),e,this)}))),function(e){return M.apply(this,arguments)})},{key:"replaceTrack",value:(I=l(u().mark((function e(t,r){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertSendDirection(),r?E.debug("replaceTrack() [localId:%s, track.id:%s]",t,r.id):E.debug("replaceTrack() [localId:%s, no track]",t),n=this._mapMidTransceiver.get(t)){e.next=6;break}throw new Error("associated RTCRtpTransceiver not found");case 6:return e.next=8,n.sender.replaceTrack(r);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return I.apply(this,arguments)})},{key:"setMaxSpatialLayer",value:(L=l(u().mark((function e(t,r){var n,o,i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertSendDirection(),E.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,r),n=this._mapMidTransceiver.get(t)){e.next=6;break}throw new Error("associated transceiver not found");case 6:return o=n.sender.getParameters(),r=o.encodings.length-1-r,o.encodings.forEach((function(e,t){e.active=t>=r})),e.next=11,n.sender.setParameters(o);case 11:return this._remoteSdp.muxMediaSectionSimulcast(t,o.encodings),e.next=14,this._pc.createOffer();case 14:return i=e.sent,E.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",i),e.next=18,this._pc.setLocalDescription(i);case 18:return a={type:"answer",sdp:this._remoteSdp.getSdp()},E.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=22,this._pc.setRemoteDescription(a);case 22:case"end":return e.stop()}}),e,this)}))),function(e,t){return L.apply(this,arguments)})},{key:"setRtpEncodingParameters",value:(D=l(u().mark((function e(t,r){var n,o,i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertSendDirection(),E.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,r),n=this._mapMidTransceiver.get(t)){e.next=6;break}throw new Error("associated RTCRtpTransceiver not found");case 6:return(o=n.sender.getParameters()).encodings.forEach((function(e,t){o.encodings[t]=c(c({},e),r)})),e.next=10,n.sender.setParameters(o);case 10:return this._remoteSdp.muxMediaSectionSimulcast(t,o.encodings),e.next=13,this._pc.createOffer();case 13:return i=e.sent,E.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",i),e.next=17,this._pc.setLocalDescription(i);case 17:return a={type:"answer",sdp:this._remoteSdp.getSdp()},E.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=21,this._pc.setRemoteDescription(a);case 21:case"end":return e.stop()}}),e,this)}))),function(e,t){return D.apply(this,arguments)})},{key:"getSenderStats",value:(j=l(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertSendDirection(),r=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return e.abrupt("return",r.sender.getStats());case 6:case"end":return e.stop()}}),e,this)}))),function(e){return j.apply(this,arguments)})},{key:"sendDataChannel",value:(P=l(u().mark((function e(t){var r,n,o,i,a,s,c,p,l,d,f,h;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.ordered,n=t.maxPacketLifeTime,o=t.maxRetransmits,i=t.label,a=t.protocol,this.assertNotClosed(),this.assertSendDirection(),s={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmits:o,protocol:a},E.debug("sendDataChannel() [options:%o]",s),c=this._pc.createDataChannel(i,s),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%T.MIS,this._hasDataChannelMediaSection){e.next=25;break}return e.next=10,this._pc.createOffer();case 10:if(p=e.sent,l=b.parse(p.sdp),d=l.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=16;break}return e.next=16,this.setupTransport({localDtlsRole:"client",localSdpObject:l});case 16:return E.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",p),e.next=19,this._pc.setLocalDescription(p);case 19:return this._remoteSdp.sendSctpAssociation({offerMediaObject:d}),f={type:"answer",sdp:this._remoteSdp.getSdp()},E.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),e.next=24,this._pc.setRemoteDescription(f);case 24:this._hasDataChannelMediaSection=!0;case 25:return h={streamId:s.id,ordered:s.ordered,maxPacketLifeTime:s.maxPacketLifeTime,maxRetransmits:s.maxRetransmits},e.abrupt("return",{dataChannel:c,sctpStreamParameters:h});case 27:case"end":return e.stop()}}),e,this)}))),function(e){return P.apply(this,arguments)})},{key:"receive",value:(w=l(u().mark((function e(t){var r,n,i,a,s,c,p,l,d,f,h,m,v,y,g,w,_,S,k,R=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertNotClosed(),this.assertRecvDirection(),r=[],n=new Map,i=o(t);try{for(i.s();!(a=i.n()).done;)s=a.value,c=s.trackId,p=s.kind,l=s.rtpParameters,d=s.streamId,E.debug("receive() [trackId:%s, kind:%s]",c,p),f=l.mid||String(this._mapMidTransceiver.size),n.set(c,f),this._remoteSdp.receive({mid:f,kind:p,offerRtpParameters:l,streamId:d||l.rtcp.cname,trackId:c})}catch(e){i.e(e)}finally{i.f()}return h={type:"offer",sdp:this._remoteSdp.getSdp()},E.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",h),e.next=10,this._pc.setRemoteDescription(h);case 10:return e.next=12,this._pc.createAnswer();case 12:m=e.sent,v=b.parse(m.sdp),y=o(t),e.prev=15,w=u().mark((function e(){var t,r,o,i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=g.value,r=t.trackId,o=t.rtpParameters,i=n.get(r),a=v.media.find((function(e){return String(e.mid)===i})),x.applyCodecParameters({offerRtpParameters:o,answerMediaObject:a}),m={type:"answer",sdp:b.write(v)};case 6:case"end":return e.stop()}}),e)})),y.s();case 18:if((g=y.n()).done){e.next=22;break}return e.delegateYield(w(),"t0",20);case 20:e.next=18;break;case 22:e.next=27;break;case 24:e.prev=24,e.t1=e.catch(15),y.e(e.t1);case 27:return e.prev=27,y.f(),e.finish(27);case 30:if(this._transportReady){e.next=33;break}return e.next=33,this.setupTransport({localDtlsRole:"client",localSdpObject:v});case 33:return E.debug("receive() | calling pc.setLocalDescription() [answer:%o]",m),e.next=36,this._pc.setLocalDescription(m);case 36:_=o(t),e.prev=37,k=u().mark((function e(){var t,o,i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=S.value,o=t.trackId,i=n.get(o),a=R._pc.getTransceivers().find((function(e){return e.mid===i}))){e.next=6;break}throw new Error("new RTCRtpTransceiver not found");case 6:R._mapMidTransceiver.set(i,a),r.push({localId:i,track:a.receiver.track,rtpReceiver:a.receiver});case 8:case"end":return e.stop()}}),e)})),_.s();case 40:if((S=_.n()).done){e.next=44;break}return e.delegateYield(k(),"t2",42);case 42:e.next=40;break;case 44:e.next=49;break;case 46:e.prev=46,e.t3=e.catch(37),_.e(e.t3);case 49:return e.prev=49,_.f(),e.finish(49);case 52:return e.abrupt("return",r);case 53:case"end":return e.stop()}}),e,this,[[15,24,27,30],[37,46,49,52]])}))),function(e){return w.apply(this,arguments)})},{key:"stopReceiving",value:(g=l(u().mark((function e(t){var r,n,i,a,s,c,p,l,d;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertRecvDirection(),!this._closed){e.next=3;break}return e.abrupt("return");case 3:r=o(t),e.prev=4,r.s();case 6:if((n=r.n()).done){e.next=15;break}if(i=n.value,E.debug("stopReceiving() [localId:%s]",i),a=this._mapMidTransceiver.get(i)){e.next=12;break}throw new Error("associated RTCRtpTransceiver not found");case 12:this._remoteSdp.closeMediaSection(a.mid);case 13:e.next=6;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(4),r.e(e.t0);case 20:return e.prev=20,r.f(),e.finish(20);case 23:return s={type:"offer",sdp:this._remoteSdp.getSdp()},E.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",s),e.next=27,this._pc.setRemoteDescription(s);case 27:return e.next=29,this._pc.createAnswer();case 29:return c=e.sent,E.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",c),e.next=33,this._pc.setLocalDescription(c);case 33:p=o(t);try{for(p.s();!(l=p.n()).done;)d=l.value,this._mapMidTransceiver.delete(d)}catch(e){p.e(e)}finally{p.f()}case 35:case"end":return e.stop()}}),e,this,[[4,17,20,23]])}))),function(e){return g.apply(this,arguments)})},{key:"pauseReceiving",value:(y=l(u().mark((function e(t){var r,n,i,a,s,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertNotClosed(),this.assertRecvDirection(),r=o(t),e.prev=3,r.s();case 5:if((n=r.n()).done){e.next=15;break}if(i=n.value,E.debug("pauseReceiving() [localId:%s]",i),a=this._mapMidTransceiver.get(i)){e.next=11;break}throw new Error("associated RTCRtpTransceiver not found");case 11:a.direction="inactive",this._remoteSdp.pauseMediaSection(i);case 13:e.next=5;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(3),r.e(e.t0);case 20:return e.prev=20,r.f(),e.finish(20);case 23:return s={type:"offer",sdp:this._remoteSdp.getSdp()},E.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",s),e.next=27,this._pc.setRemoteDescription(s);case 27:return e.next=29,this._pc.createAnswer();case 29:return c=e.sent,E.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",c),e.next=33,this._pc.setLocalDescription(c);case 33:case"end":return e.stop()}}),e,this,[[3,17,20,23]])}))),function(e){return y.apply(this,arguments)})},{key:"resumeReceiving",value:(v=l(u().mark((function e(t){var r,n,i,a,s,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertNotClosed(),this.assertRecvDirection(),r=o(t),e.prev=3,r.s();case 5:if((n=r.n()).done){e.next=15;break}if(i=n.value,E.debug("resumeReceiving() [localId:%s]",i),a=this._mapMidTransceiver.get(i)){e.next=11;break}throw new Error("associated RTCRtpTransceiver not found");case 11:a.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(i);case 13:e.next=5;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(3),r.e(e.t0);case 20:return e.prev=20,r.f(),e.finish(20);case 23:return s={type:"offer",sdp:this._remoteSdp.getSdp()},E.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",s),e.next=27,this._pc.setRemoteDescription(s);case 27:return e.next=29,this._pc.createAnswer();case 29:return c=e.sent,E.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",c),e.next=33,this._pc.setLocalDescription(c);case 33:case"end":return e.stop()}}),e,this,[[3,17,20,23]])}))),function(e){return v.apply(this,arguments)})},{key:"getReceiverStats",value:(f=l(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertRecvDirection(),r=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return e.abrupt("return",r.receiver.getStats());case 5:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"receiveDataChannel",value:(p=l(u().mark((function e(t){var r,n,o,i,a,s,c,p,l,d,f,h;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.sctpStreamParameters,n=t.label,o=t.protocol,this.assertNotClosed(),this.assertRecvDirection(),i=r.streamId,a=r.ordered,s=r.maxPacketLifeTime,c=r.maxRetransmits,p={negotiated:!0,id:i,ordered:a,maxPacketLifeTime:s,maxRetransmits:c,protocol:o},E.debug("receiveDataChannel() [options:%o]",p),l=this._pc.createDataChannel(n,p),this._hasDataChannelMediaSection){e.next=24;break}return this._remoteSdp.receiveSctpAssociation(),d={type:"offer",sdp:this._remoteSdp.getSdp()},E.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),e.next=13,this._pc.setRemoteDescription(d);case 13:return e.next=15,this._pc.createAnswer();case 15:if(f=e.sent,this._transportReady){e.next=20;break}return h=b.parse(f.sdp),e.next=20,this.setupTransport({localDtlsRole:"client",localSdpObject:h});case 20:return E.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),e.next=23,this._pc.setLocalDescription(f);case 23:this._hasDataChannelMediaSection=!0;case 24:return e.abrupt("return",{dataChannel:l});case 25:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"setupTransport",value:(s=l(u().mark((function e(t){var r,n,o,i=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.localDtlsRole,(n=t.localSdpObject)||(n=b.parse(this._pc.localDescription.sdp)),(o=x.extractDtlsParameters({sdpObject:n})).role=r,this._remoteSdp.updateDtlsRole("client"===r?"server":"client"),e.next=7,new Promise((function(e,t){i.safeEmit("@connect",{dtlsParameters:o},e,t)}));case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"assertNotClosed",value:function(){if(this._closed)throw new _.InvalidStateError("method called in a closed handler")}},{key:"assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],i=[{key:"createFactory",value:function(){return function(){return new H}}}],r&&d(t.prototype,r),i&&d(t,i),Object.defineProperty(t,"prototype",{writable:!1}),H}(P.HandlerInterface);t.Firefox60=j},1144:(e,t,r)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},o(e,t)}function i(e){return i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},i(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.HandlerInterface=void 0;var a=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o(e,t)}(c,e);var t,r,a,s=(r=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=i(r);if(a){var o=i(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function c(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),s.call(this)}return t=c,Object.defineProperty(t,"prototype",{writable:!1}),t}(r(5324).EnhancedEventEmitter);t.HandlerInterface=a},463:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a.apply(this,arguments)}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(){c=function(){return t};var e,t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",p=a.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof b?t:b,a=Object.create(o.prototype),s=new D(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var h="suspendedStart",m="suspendedYield",v="executing",y="completed",g={};function b(){}function w(){}function _(){}var S={};l(S,s,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(L([])));x&&x!==r&&o.call(x,s)&&(S=x);var R=_.prototype=b.prototype=Object.create(S);function P(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(i,a,s,c){var u=f(e[i],e,a);if("throw"!==u.type){var p=u.arg,l=p.value;return l&&"object"==n(l)&&o.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):t.resolve(l).then((function(e){p.value=e,s(p)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var a;i(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function O(t,r,n){var o=h;return function(i,a){if(o===v)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=E(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?y:m,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function E(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,E(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[s];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function r(){for(;++i<t.length;)if(o.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(n(t)+" is not iterable")}return w.prototype=_,i(R,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:w,configurable:!0}),w.displayName=l(_,p,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,l(e,p,"GeneratorFunction")),e.prototype=Object.create(R),e},t.awrap=function(e){return{__await:e}},P(C.prototype),l(C.prototype,u,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new C(d(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},P(R),l(R,p,"Generator"),l(R,s,(function(){return this})),l(R,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function u(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function p(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){u(i,n,o,a,s,"next",e)}function s(e){u(i,n,o,a,s,"throw",e)}a(void 0)}))}}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d(n.key),n)}}function d(e){var t=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===n(t)?t:String(t)}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}var m=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),v=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),y=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&m(t,e,r);return v(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ReactNative=void 0;var g=y(r(9652)),b=r(1916),w=r(6020),_=y(r(5234)),S=y(r(6059)),k=y(r(5388)),x=y(r(5156)),R=r(1144),P=r(9196),C=new b.Logger("ReactNative"),O={OS:1024,MIS:1024},E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(H,e);var t,r,i,u,m,v,y,b,R,E,T,j,D,L,I,M,A,N,F,B,G,V,U,q,z,W,K=(z=H,W=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(z);if(W){var r=h(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function H(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,H),(e=K.call(this))._sendStream=new MediaStream,e._mapSendLocalIdTrack=new Map,e._nextSendLocalId=0,e._mapRecvLocalIdInfo=new Map,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return t=H,r=[{key:"name",get:function(){return"ReactNative"}},{key:"close",value:function(){if(C.debug("close()"),this._sendStream.release(!1),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}},{key:"getNativeRtpCapabilities",value:(q=p(c().mark((function e(){var t,r,n,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"}),e.prev=2,e.next=5,t.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});case 5:r=e.sent;try{t.close()}catch(e){}return n=g.parse(r.sdp),o=k.extractRtpCapabilities({sdpObject:n}),e.abrupt("return",o);case 12:e.prev=12,e.t0=e.catch(2);try{t.close()}catch(e){}throw e.t0;case 16:case"end":return e.stop()}}),e,null,[[2,12]])}))),function(){return q.apply(this,arguments)})},{key:"getNativeSctpCapabilities",value:(U=p(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:O});case 2:case"end":return e.stop()}}),e)}))),function(){return U.apply(this,arguments)})},{key:"run",value:function(e){var t=this,r=e.direction,n=e.iceParameters,o=e.iceCandidates,i=e.dtlsParameters,a=e.sctpParameters,c=e.iceServers,u=e.iceTransportPolicy,p=e.additionalSettings,l=e.proprietaryConstraints,f=e.extendedRtpCapabilities;C.debug("run()"),this._direction=r,this._remoteSdp=new P.RemoteSdp({iceParameters:n,iceCandidates:o,dtlsParameters:i,sctpParameters:a,planB:!0}),this._sendingRtpParametersByKind={audio:S.getSendingRtpParameters("audio",f),video:S.getSendingRtpParameters("video",f)},this._sendingRemoteRtpParametersByKind={audio:S.getSendingRemoteRtpParameters("audio",f),video:S.getSendingRemoteRtpParameters("video",f)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){var n,o,i;n=e,o=t,i=r[t],(o=d(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({iceServers:c||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"},p),l),this._pc.addEventListener("icegatheringstatechange",(function(){t.emit("@icegatheringstatechange",t._pc.iceGatheringState)})),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(function(){t.emit("@connectionstatechange",t._pc.connectionState)})):this._pc.addEventListener("iceconnectionstatechange",(function(){switch(C.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:(V=p(c().mark((function e(t){var r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C.debug("updateIceServers()"),(r=this._pc.getConfiguration()).iceServers=t,this._pc.setConfiguration(r);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return V.apply(this,arguments)})},{key:"restartIce",value:(G=p(c().mark((function e(t){var r,n,o,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(C.debug("restartIce()"),this._remoteSdp.updateIceParameters(t),this._transportReady){e.next=4;break}return e.abrupt("return");case 4:if("send"!==this._direction){e.next=17;break}return e.next=7,this._pc.createOffer({iceRestart:!0});case 7:return r=e.sent,C.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),e.next=11,this._pc.setLocalDescription(r);case 11:return n={type:"answer",sdp:this._remoteSdp.getSdp()},C.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),e.next=15,this._pc.setRemoteDescription(n);case 15:e.next=27;break;case 17:return o={type:"offer",sdp:this._remoteSdp.getSdp()},C.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=21,this._pc.setRemoteDescription(o);case 21:return e.next=23,this._pc.createAnswer();case 23:return i=e.sent,C.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",i),e.next=27,this._pc.setLocalDescription(i);case 27:case"end":return e.stop()}}),e,this)}))),function(e){return G.apply(this,arguments)})},{key:"getTransportStats",value:(B=p(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)}))),function(){return B.apply(this,arguments)})},{key:"send",value:(F=p(c().mark((function e(t){var r,n,i,s,u,p,l,d,f,h,m,v,y,b,w;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.track,n=t.encodings,i=t.codecOptions,s=t.codec,this.assertSendDirection(),C.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),s&&C.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(r),this._pc.addStream(this._sendStream),e.next=8,this._pc.createOffer();case 8:if(u=e.sent,p=g.parse(u.sdp),(d=_.clone(this._sendingRtpParametersByKind[r.kind])).codecs=S.reduceCodecs(d.codecs),(f=_.clone(this._sendingRemoteRtpParametersByKind[r.kind])).codecs=S.reduceCodecs(f.codecs),this._transportReady){e.next=17;break}return e.next=17,this.setupTransport({localDtlsRole:null!==(h=this._forcedLocalDtlsRole)&&void 0!==h?h:"client",localSdpObject:p});case 17:return"video"===r.kind&&n&&n.length>1&&(C.debug("send() | enabling simulcast"),p=g.parse(u.sdp),l=p.media.find((function(e){return"video"===e.type})),x.addLegacySimulcast({offerMediaObject:l,track:r,numStreams:n.length}),u={type:"offer",sdp:g.write(p)}),C.debug("send() | calling pc.setLocalDescription() [offer:%o]",u),e.next=21,this._pc.setLocalDescription(u);case 21:if(p=g.parse(this._pc.localDescription.sdp),l=p.media.find((function(e){return e.type===r.kind})),d.rtcp.cname=k.getCname({offerMediaObject:l}),d.encodings=x.getRtpEncodings({offerMediaObject:l,track:r}),n)for(m=0;m<d.encodings.length;++m)n[m]&&a(d.encodings[m],n[m]);if(d.encodings.length>1&&("video/vp8"===d.codecs[0].mimeType.toLowerCase()||"video/h264"===d.codecs[0].mimeType.toLowerCase())){v=o(d.encodings);try{for(v.s();!(y=v.n()).done;)y.value.scalabilityMode="L1T3"}catch(e){v.e(e)}finally{v.f()}}return this._remoteSdp.send({offerMediaObject:l,offerRtpParameters:d,answerRtpParameters:f,codecOptions:i}),b={type:"answer",sdp:this._remoteSdp.getSdp()},C.debug("send() | calling pc.setRemoteDescription() [answer:%o]",b),e.next=32,this._pc.setRemoteDescription(b);case 32:return w=String(this._nextSendLocalId),this._nextSendLocalId++,this._mapSendLocalIdTrack.set(w,r),e.abrupt("return",{localId:w,rtpParameters:d});case 36:case"end":return e.stop()}}),e,this)}))),function(e){return F.apply(this,arguments)})},{key:"stopSending",value:(N=p(c().mark((function e(t){var r,n,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),C.debug("stopSending() [localId:%s]",t),r=this._mapSendLocalIdTrack.get(t)){e.next=5;break}throw new Error("track not found");case 5:return this._mapSendLocalIdTrack.delete(t),this._sendStream.removeTrack(r),this._pc.addStream(this._sendStream),e.next=10,this._pc.createOffer();case 10:return n=e.sent,C.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),e.prev=12,e.next=15,this._pc.setLocalDescription(n);case 15:e.next=23;break;case 17:if(e.prev=17,e.t0=e.catch(12),0!==this._sendStream.getTracks().length){e.next=22;break}return C.warn("stopSending() | ignoring expected error due no sending tracks: %s",e.t0.toString()),e.abrupt("return");case 22:throw e.t0;case 23:if("stable"!==this._pc.signalingState){e.next=25;break}return e.abrupt("return");case 25:return o={type:"answer",sdp:this._remoteSdp.getSdp()},C.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=29,this._pc.setRemoteDescription(o);case 29:case"end":return e.stop()}}),e,this,[[12,17]])}))),function(e){return N.apply(this,arguments)})},{key:"pauseSending",value:(A=p(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return A.apply(this,arguments)})},{key:"resumeSending",value:(M=p(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return M.apply(this,arguments)})},{key:"replaceTrack",value:(I=p(c().mark((function e(t,r){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new w.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)}))),function(e,t){return I.apply(this,arguments)})},{key:"setMaxSpatialLayer",value:(L=p(c().mark((function e(t,r){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new w.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)}))),function(e,t){return L.apply(this,arguments)})},{key:"setRtpEncodingParameters",value:(D=p(c().mark((function e(t,r){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new w.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)}))),function(e,t){return D.apply(this,arguments)})},{key:"getSenderStats",value:(j=p(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new w.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)}))),function(e){return j.apply(this,arguments)})},{key:"sendDataChannel",value:(T=p(c().mark((function e(t){var r,n,o,i,a,s,u,p,l,d,f,h,m;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.ordered,n=t.maxPacketLifeTime,o=t.maxRetransmits,i=t.label,a=t.protocol,this.assertSendDirection(),s={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmitTime:n,maxRetransmits:o,protocol:a},C.debug("sendDataChannel() [options:%o]",s),u=this._pc.createDataChannel(i,s),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%O.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=9,this._pc.createOffer();case 9:if(p=e.sent,l=g.parse(p.sdp),d=l.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=15;break}return e.next=15,this.setupTransport({localDtlsRole:null!==(f=this._forcedLocalDtlsRole)&&void 0!==f?f:"client",localSdpObject:l});case 15:return C.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",p),e.next=18,this._pc.setLocalDescription(p);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:d}),h={type:"answer",sdp:this._remoteSdp.getSdp()},C.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",h),e.next=23,this._pc.setRemoteDescription(h);case 23:this._hasDataChannelMediaSection=!0;case 24:return m={streamId:s.id,ordered:s.ordered,maxPacketLifeTime:s.maxPacketLifeTime,maxRetransmits:s.maxRetransmits},e.abrupt("return",{dataChannel:u,sctpStreamParameters:m});case 26:case"end":return e.stop()}}),e,this)}))),function(e){return T.apply(this,arguments)})},{key:"receive",value:(E=p(c().mark((function e(t){var r,n,i,a,s,u,p,l,d,f,h,m,v,y,b,w,S,x,R,P,O=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=[],n=new Map,i=o(t);try{for(i.s();!(a=i.n()).done;)s=a.value,u=s.trackId,p=s.kind,l=s.rtpParameters,C.debug("receive() [trackId:%s, kind:%s]",u,p),d=p,f=s.streamId||l.rtcp.cname,C.debug("receive() | forcing a random remote streamId to avoid well known bug in react-native-webrtc"),f+="-hack-".concat(_.generateRandomNumber()),n.set(u,f),this._remoteSdp.receive({mid:d,kind:p,offerRtpParameters:l,streamId:f,trackId:u})}catch(e){i.e(e)}finally{i.f()}return h={type:"offer",sdp:this._remoteSdp.getSdp()},C.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",h),e.next=9,this._pc.setRemoteDescription(h);case 9:return e.next=11,this._pc.createAnswer();case 11:m=e.sent,v=g.parse(m.sdp),y=o(t),e.prev=14,w=c().mark((function e(){var t,r,n,o,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=b.value,r=t.kind,n=t.rtpParameters,o=r,i=v.media.find((function(e){return String(e.mid)===o})),k.applyCodecParameters({offerRtpParameters:n,answerMediaObject:i});case 5:case"end":return e.stop()}}),e)})),y.s();case 17:if((b=y.n()).done){e.next=21;break}return e.delegateYield(w(),"t0",19);case 19:e.next=17;break;case 21:e.next=26;break;case 23:e.prev=23,e.t1=e.catch(14),y.e(e.t1);case 26:return e.prev=26,y.f(),e.finish(26);case 29:if(m={type:"answer",sdp:g.write(v)},this._transportReady){e.next=33;break}return e.next=33,this.setupTransport({localDtlsRole:null!==(S=this._forcedLocalDtlsRole)&&void 0!==S?S:"client",localSdpObject:v});case 33:return C.debug("receive() | calling pc.setLocalDescription() [answer:%o]",m),e.next=36,this._pc.setLocalDescription(m);case 36:x=o(t),e.prev=37,P=c().mark((function e(){var t,o,i,a,s,u,p,l,d;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=R.value,o=t.kind,i=t.trackId,a=t.rtpParameters,s=i,u=o,p=n.get(i),l=O._pc.getRemoteStreams().find((function(e){return e.id===p})),d=l.getTrackById(s)){e.next=9;break}throw new Error("remote track not found");case 9:O._mapRecvLocalIdInfo.set(s,{mid:u,rtpParameters:a}),r.push({localId:s,track:d});case 11:case"end":return e.stop()}}),e)})),x.s();case 40:if((R=x.n()).done){e.next=44;break}return e.delegateYield(P(),"t2",42);case 42:e.next=40;break;case 44:e.next=49;break;case 46:e.prev=46,e.t3=e.catch(37),x.e(e.t3);case 49:return e.prev=49,x.f(),e.finish(49);case 52:return e.abrupt("return",r);case 53:case"end":return e.stop()}}),e,this,[[14,23,26,29],[37,46,49,52]])}))),function(e){return E.apply(this,arguments)})},{key:"stopReceiving",value:(R=p(c().mark((function e(t){var r,n,i,a,s,u,p,l;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=o(t);try{for(r.s();!(n=r.n()).done;)i=n.value,C.debug("stopReceiving() [localId:%s]",i),a=this._mapRecvLocalIdInfo.get(i)||{},s=a.mid,u=a.rtpParameters,this._mapRecvLocalIdInfo.delete(i),this._remoteSdp.planBStopReceiving({mid:s,offerRtpParameters:u})}catch(e){r.e(e)}finally{r.f()}return p={type:"offer",sdp:this._remoteSdp.getSdp()},C.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",p),e.next=7,this._pc.setRemoteDescription(p);case 7:return e.next=9,this._pc.createAnswer();case 9:return l=e.sent,C.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",l),e.next=13,this._pc.setLocalDescription(l);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return R.apply(this,arguments)})},{key:"pauseReceiving",value:(b=p(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return b.apply(this,arguments)})},{key:"resumeReceiving",value:(y=p(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return y.apply(this,arguments)})},{key:"getReceiverStats",value:(v=p(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new w.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)}))),function(e){return v.apply(this,arguments)})},{key:"receiveDataChannel",value:(m=p(c().mark((function e(t){var r,n,o,i,a,s,u,p,l,d,f,h,m;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.sctpStreamParameters,n=t.label,o=t.protocol,this.assertRecvDirection(),i=r.streamId,a=r.ordered,s=r.maxPacketLifeTime,u=r.maxRetransmits,p={negotiated:!0,id:i,ordered:a,maxPacketLifeTime:s,maxRetransmitTime:s,maxRetransmits:u,protocol:o},C.debug("receiveDataChannel() [options:%o]",p),l=this._pc.createDataChannel(n,p),this._hasDataChannelMediaSection){e.next=23;break}return this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0}),d={type:"offer",sdp:this._remoteSdp.getSdp()},C.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),e.next=12,this._pc.setRemoteDescription(d);case 12:return e.next=14,this._pc.createAnswer();case 14:if(f=e.sent,this._transportReady){e.next=19;break}return m=g.parse(f.sdp),e.next=19,this.setupTransport({localDtlsRole:null!==(h=this._forcedLocalDtlsRole)&&void 0!==h?h:"client",localSdpObject:m});case 19:return C.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),e.next=22,this._pc.setLocalDescription(f);case 22:this._hasDataChannelMediaSection=!0;case 23:return e.abrupt("return",{dataChannel:l});case 24:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"setupTransport",value:(u=p(c().mark((function e(t){var r,n,o,i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.localDtlsRole,(n=t.localSdpObject)||(n=g.parse(this._pc.localDescription.sdp)),(o=k.extractDtlsParameters({sdpObject:n})).role=r,this._remoteSdp.updateDtlsRole("client"===r?"server":"client"),e.next=7,new Promise((function(e,t){i.safeEmit("@connect",{dtlsParameters:o},e,t)}));case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],i=[{key:"createFactory",value:function(){return function(){return new H}}}],r&&l(t.prototype,r),i&&l(t,i),Object.defineProperty(t,"prototype",{writable:!1}),H}(R.HandlerInterface);t.ReactNative=E},2295:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a.apply(this,arguments)}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){var n,o,i;n=e,o=t,i=r[t],(o=f(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(){u=function(){return t};var e,t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",p=a.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof b?t:b,a=Object.create(o.prototype),s=new D(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var h="suspendedStart",m="suspendedYield",v="executing",y="completed",g={};function b(){}function w(){}function _(){}var S={};l(S,s,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(L([])));x&&x!==r&&o.call(x,s)&&(S=x);var R=_.prototype=b.prototype=Object.create(S);function P(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(i,a,s,c){var u=f(e[i],e,a);if("throw"!==u.type){var p=u.arg,l=p.value;return l&&"object"==n(l)&&o.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):t.resolve(l).then((function(e){p.value=e,s(p)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var a;i(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function O(t,r,n){var o=h;return function(i,a){if(o===v)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=E(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?y:m,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function E(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,E(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[s];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function r(){for(;++i<t.length;)if(o.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(n(t)+" is not iterable")}return w.prototype=_,i(R,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:w,configurable:!0}),w.displayName=l(_,p,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,l(e,p,"GeneratorFunction")),e.prototype=Object.create(R),e},t.awrap=function(e){return{__await:e}},P(C.prototype),l(C.prototype,c,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new C(d(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},P(R),l(R,p,"Generator"),l(R,s,(function(){return this})),l(R,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function p(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){p(i,n,o,a,s,"next",e)}function s(e){p(i,n,o,a,s,"throw",e)}a(void 0)}))}}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function f(e){var t=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===n(t)?t:String(t)}function h(e,t){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},h(e,t)}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}var v=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),y=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),g=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&v(t,e,r);return y(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ReactNativeUnifiedPlan=void 0;var b=g(r(9652)),w=r(1916),_=g(r(5234)),S=g(r(6059)),k=g(r(5388)),x=g(r(8538)),R=g(r(337)),P=r(6020),C=r(1144),O=r(9196),E=r(9975),T=new w.Logger("ReactNativeUnifiedPlan"),j={OS:1024,MIS:1024},D=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(Y,e);var t,r,i,s,p,f,v,y,g,w,C,D,L,I,M,A,N,F,B,G,V,U,q,z,W,K,H=(W=Y,K=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=m(W);if(K){var r=m(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function Y(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Y),(e=H.call(this))._closed=!1,e._mapMidTransceiver=new Map,e._sendStream=new MediaStream,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return t=Y,r=[{key:"name",get:function(){return"ReactNativeUnifiedPlan"}},{key:"close",value:function(){if(T.debug("close()"),!this._closed){if(this._closed=!0,this._sendStream.release(!1),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}}},{key:"getNativeRtpCapabilities",value:(z=l(u().mark((function e(){var t,r,n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"}),e.prev=2,t.addTransceiver("audio"),t.addTransceiver("video"),e.next=7,t.createOffer();case 7:r=e.sent;try{t.close()}catch(e){}return n=b.parse(r.sdp),o=k.extractRtpCapabilities({sdpObject:n}),R.addNackSuppportForOpus(o),e.abrupt("return",o);case 15:e.prev=15,e.t0=e.catch(2);try{t.close()}catch(e){}throw e.t0;case 19:case"end":return e.stop()}}),e,null,[[2,15]])}))),function(){return z.apply(this,arguments)})},{key:"getNativeSctpCapabilities",value:(q=l(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:j});case 2:case"end":return e.stop()}}),e)}))),function(){return q.apply(this,arguments)})},{key:"run",value:function(e){var t=this,r=e.direction,n=e.iceParameters,o=e.iceCandidates,i=e.dtlsParameters,a=e.sctpParameters,s=e.iceServers,u=e.iceTransportPolicy,p=e.additionalSettings,l=e.proprietaryConstraints,d=e.extendedRtpCapabilities;this.assertNotClosed(),T.debug("run()"),this._direction=r,this._remoteSdp=new O.RemoteSdp({iceParameters:n,iceCandidates:o,dtlsParameters:i,sctpParameters:a}),this._sendingRtpParametersByKind={audio:S.getSendingRtpParameters("audio",d),video:S.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:S.getSendingRemoteRtpParameters("audio",d),video:S.getSendingRemoteRtpParameters("video",d)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection(c({iceServers:s||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"},p),l),this._pc.addEventListener("icegatheringstatechange",(function(){t.emit("@icegatheringstatechange",t._pc.iceGatheringState)})),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(function(){t.emit("@connectionstatechange",t._pc.connectionState)})):this._pc.addEventListener("iceconnectionstatechange",(function(){switch(T.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:(U=l(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertNotClosed(),T.debug("updateIceServers()"),(r=this._pc.getConfiguration()).iceServers=t,this._pc.setConfiguration(r);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return U.apply(this,arguments)})},{key:"restartIce",value:(V=l(u().mark((function e(t){var r,n,o,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),T.debug("restartIce()"),this._remoteSdp.updateIceParameters(t),this._transportReady){e.next=5;break}return e.abrupt("return");case 5:if("send"!==this._direction){e.next=18;break}return e.next=8,this._pc.createOffer({iceRestart:!0});case 8:return r=e.sent,T.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),e.next=12,this._pc.setLocalDescription(r);case 12:return n={type:"answer",sdp:this._remoteSdp.getSdp()},T.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),e.next=16,this._pc.setRemoteDescription(n);case 16:e.next=28;break;case 18:return o={type:"offer",sdp:this._remoteSdp.getSdp()},T.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=22,this._pc.setRemoteDescription(o);case 22:return e.next=24,this._pc.createAnswer();case 24:return i=e.sent,T.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",i),e.next=28,this._pc.setLocalDescription(i);case 28:case"end":return e.stop()}}),e,this)}))),function(e){return V.apply(this,arguments)})},{key:"getTransportStats",value:(G=l(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.assertNotClosed(),e.abrupt("return",this._pc.getStats());case 2:case"end":return e.stop()}}),e,this)}))),function(){return G.apply(this,arguments)})},{key:"send",value:(B=l(u().mark((function e(t){var r,n,i,s,c,p,l,d,f,h,m,v,y,g,w,R,P,C,O,j,D;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.track,i=t.encodings,s=t.codecOptions,c=t.codec,this.assertNotClosed(),this.assertSendDirection(),T.debug("send() [kind:%s, track.id:%s]",n.kind,n.id),i&&i.length>1&&i.forEach((function(e,t){e.rid="r".concat(t)})),(p=_.clone(this._sendingRtpParametersByKind[n.kind])).codecs=S.reduceCodecs(p.codecs,c),(l=_.clone(this._sendingRemoteRtpParametersByKind[n.kind])).codecs=S.reduceCodecs(l.codecs,c),d=this._remoteSdp.getNextMediaSectionIdx(),f=this._pc.addTransceiver(n,{direction:"sendonly",streams:[this._sendStream],sendEncodings:i}),e.next=13,this._pc.createOffer();case 13:if(h=e.sent,m=b.parse(h.sdp),this._transportReady){e.next=18;break}return e.next=18,this.setupTransport({localDtlsRole:null!==(y=this._forcedLocalDtlsRole)&&void 0!==y?y:"client",localSdpObject:m});case 18:return g=!1,w=(0,E.parse)((i||[{}])[0].scalabilityMode),i&&1===i.length&&w.spatialLayers>1&&"video/vp9"===p.codecs[0].mimeType.toLowerCase()&&(T.debug("send() | enabling legacy simulcast for VP9 SVC"),g=!0,m=b.parse(h.sdp),v=m.media[d.idx],x.addLegacySimulcast({offerMediaObject:v,numStreams:w.spatialLayers}),h={type:"offer",sdp:b.write(m)}),T.debug("send() | calling pc.setLocalDescription() [offer:%o]",h),e.next=24,this._pc.setLocalDescription(h);case 24:if((R=null!==(r=f.mid)&&void 0!==r?r:void 0)||T.warn("send() | missing transceiver.mid (bug in react-native-webrtc, using a workaround"),p.mid=R,m=b.parse(this._pc.localDescription.sdp),v=m.media[d.idx],p.rtcp.cname=k.getCname({offerMediaObject:v}),i?1===i.length?(a((P=x.getRtpEncodings({offerMediaObject:v}))[0],i[0]),g&&(P=[P[0]]),p.encodings=P):p.encodings=i:p.encodings=x.getRtpEncodings({offerMediaObject:v}),p.encodings.length>1&&("video/vp8"===p.codecs[0].mimeType.toLowerCase()||"video/h264"===p.codecs[0].mimeType.toLowerCase())){C=o(p.encodings);try{for(C.s();!(O=C.n()).done;)(j=O.value).scalabilityMode?j.scalabilityMode="L1T".concat(w.temporalLayers):j.scalabilityMode="L1T3"}catch(e){C.e(e)}finally{C.f()}}return this._remoteSdp.send({offerMediaObject:v,reuseMid:d.reuseMid,offerRtpParameters:p,answerRtpParameters:l,codecOptions:s,extmapAllowMixed:!0}),D={type:"answer",sdp:this._remoteSdp.getSdp()},T.debug("send() | calling pc.setRemoteDescription() [answer:%o]",D),e.next=37,this._pc.setRemoteDescription(D);case 37:return R||(R=f.mid,p.mid=R),this._mapMidTransceiver.set(R,f),e.abrupt("return",{localId:R,rtpParameters:p,rtpSender:f.sender});case 40:case"end":return e.stop()}}),e,this)}))),function(e){return B.apply(this,arguments)})},{key:"stopSending",value:(F=l(u().mark((function e(t){var r,n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),!this._closed){e.next=3;break}return e.abrupt("return");case 3:if(T.debug("stopSending() [localId:%s]",t),r=this._mapMidTransceiver.get(t)){e.next=7;break}throw new Error("associated RTCRtpTransceiver not found");case 7:if(r.sender.replaceTrack(null),this._pc.removeTrack(r.sender),this._remoteSdp.closeMediaSection(r.mid))try{r.stop()}catch(e){}return e.next=13,this._pc.createOffer();case 13:return n=e.sent,T.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),e.next=17,this._pc.setLocalDescription(n);case 17:return o={type:"answer",sdp:this._remoteSdp.getSdp()},T.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=21,this._pc.setRemoteDescription(o);case 21:this._mapMidTransceiver.delete(t);case 22:case"end":return e.stop()}}),e,this)}))),function(e){return F.apply(this,arguments)})},{key:"pauseSending",value:(N=l(u().mark((function e(t){var r,n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertSendDirection(),T.debug("pauseSending() [localId:%s]",t),r=this._mapMidTransceiver.get(t)){e.next=6;break}throw new Error("associated RTCRtpTransceiver not found");case 6:return r.direction="inactive",this._remoteSdp.pauseMediaSection(t),e.next=10,this._pc.createOffer();case 10:return n=e.sent,T.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",n),e.next=14,this._pc.setLocalDescription(n);case 14:return o={type:"answer",sdp:this._remoteSdp.getSdp()},T.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=18,this._pc.setRemoteDescription(o);case 18:case"end":return e.stop()}}),e,this)}))),function(e){return N.apply(this,arguments)})},{key:"resumeSending",value:(A=l(u().mark((function e(t){var r,n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertSendDirection(),T.debug("resumeSending() [localId:%s]",t),r=this._mapMidTransceiver.get(t),this._remoteSdp.resumeSendingMediaSection(t),r){e.next=7;break}throw new Error("associated RTCRtpTransceiver not found");case 7:return r.direction="sendonly",e.next=10,this._pc.createOffer();case 10:return n=e.sent,T.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",n),e.next=14,this._pc.setLocalDescription(n);case 14:return o={type:"answer",sdp:this._remoteSdp.getSdp()},T.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=18,this._pc.setRemoteDescription(o);case 18:case"end":return e.stop()}}),e,this)}))),function(e){return A.apply(this,arguments)})},{key:"replaceTrack",value:(M=l(u().mark((function e(t,r){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertSendDirection(),r?T.debug("replaceTrack() [localId:%s, track.id:%s]",t,r.id):T.debug("replaceTrack() [localId:%s, no track]",t),n=this._mapMidTransceiver.get(t)){e.next=6;break}throw new Error("associated RTCRtpTransceiver not found");case 6:return e.next=8,n.sender.replaceTrack(r);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return M.apply(this,arguments)})},{key:"setMaxSpatialLayer",value:(I=l(u().mark((function e(t,r){var n,o,i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertSendDirection(),T.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,r),n=this._mapMidTransceiver.get(t)){e.next=6;break}throw new Error("associated RTCRtpTransceiver not found");case 6:return(o=n.sender.getParameters()).encodings.forEach((function(e,t){e.active=t<=r})),e.next=10,n.sender.setParameters(o);case 10:return this._remoteSdp.muxMediaSectionSimulcast(t,o.encodings),e.next=13,this._pc.createOffer();case 13:return i=e.sent,T.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",i),e.next=17,this._pc.setLocalDescription(i);case 17:return a={type:"answer",sdp:this._remoteSdp.getSdp()},T.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=21,this._pc.setRemoteDescription(a);case 21:case"end":return e.stop()}}),e,this)}))),function(e,t){return I.apply(this,arguments)})},{key:"setRtpEncodingParameters",value:(L=l(u().mark((function e(t,r){var n,o,i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertSendDirection(),T.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,r),n=this._mapMidTransceiver.get(t)){e.next=6;break}throw new Error("associated RTCRtpTransceiver not found");case 6:return(o=n.sender.getParameters()).encodings.forEach((function(e,t){o.encodings[t]=c(c({},e),r)})),e.next=10,n.sender.setParameters(o);case 10:return this._remoteSdp.muxMediaSectionSimulcast(t,o.encodings),e.next=13,this._pc.createOffer();case 13:return i=e.sent,T.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",i),e.next=17,this._pc.setLocalDescription(i);case 17:return a={type:"answer",sdp:this._remoteSdp.getSdp()},T.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=21,this._pc.setRemoteDescription(a);case 21:case"end":return e.stop()}}),e,this)}))),function(e,t){return L.apply(this,arguments)})},{key:"getSenderStats",value:(D=l(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertSendDirection(),r=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return e.abrupt("return",r.sender.getStats());case 6:case"end":return e.stop()}}),e,this)}))),function(e){return D.apply(this,arguments)})},{key:"sendDataChannel",value:(C=l(u().mark((function e(t){var r,n,o,i,a,s,c,p,l,d,f,h,m;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.ordered,n=t.maxPacketLifeTime,o=t.maxRetransmits,i=t.label,a=t.protocol,this.assertNotClosed(),this.assertSendDirection(),s={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmits:o,protocol:a},T.debug("sendDataChannel() [options:%o]",s),c=this._pc.createDataChannel(i,s),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%j.MIS,this._hasDataChannelMediaSection){e.next=25;break}return e.next=10,this._pc.createOffer();case 10:if(p=e.sent,l=b.parse(p.sdp),d=l.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=16;break}return e.next=16,this.setupTransport({localDtlsRole:null!==(f=this._forcedLocalDtlsRole)&&void 0!==f?f:"client",localSdpObject:l});case 16:return T.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",p),e.next=19,this._pc.setLocalDescription(p);case 19:return this._remoteSdp.sendSctpAssociation({offerMediaObject:d}),h={type:"answer",sdp:this._remoteSdp.getSdp()},T.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",h),e.next=24,this._pc.setRemoteDescription(h);case 24:this._hasDataChannelMediaSection=!0;case 25:return m={streamId:s.id,ordered:s.ordered,maxPacketLifeTime:s.maxPacketLifeTime,maxRetransmits:s.maxRetransmits},e.abrupt("return",{dataChannel:c,sctpStreamParameters:m});case 27:case"end":return e.stop()}}),e,this)}))),function(e){return C.apply(this,arguments)})},{key:"receive",value:(w=l(u().mark((function e(t){var r,n,i,a,s,c,p,l,d,f,h,m,v,y,g,w,_,S,x,R,P=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertNotClosed(),this.assertRecvDirection(),r=[],n=new Map,i=o(t);try{for(i.s();!(a=i.n()).done;)s=a.value,c=s.trackId,p=s.kind,l=s.rtpParameters,d=s.streamId,T.debug("receive() [trackId:%s, kind:%s]",c,p),f=l.mid||String(this._mapMidTransceiver.size),n.set(c,f),this._remoteSdp.receive({mid:f,kind:p,offerRtpParameters:l,streamId:d||l.rtcp.cname,trackId:c})}catch(e){i.e(e)}finally{i.f()}return h={type:"offer",sdp:this._remoteSdp.getSdp()},T.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",h),e.next=10,this._pc.setRemoteDescription(h);case 10:return e.next=12,this._pc.createAnswer();case 12:m=e.sent,v=b.parse(m.sdp),y=o(t),e.prev=15,w=u().mark((function e(){var t,r,o,i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=g.value,r=t.trackId,o=t.rtpParameters,i=n.get(r),a=v.media.find((function(e){return String(e.mid)===i})),k.applyCodecParameters({offerRtpParameters:o,answerMediaObject:a});case 5:case"end":return e.stop()}}),e)})),y.s();case 18:if((g=y.n()).done){e.next=22;break}return e.delegateYield(w(),"t0",20);case 20:e.next=18;break;case 22:e.next=27;break;case 24:e.prev=24,e.t1=e.catch(15),y.e(e.t1);case 27:return e.prev=27,y.f(),e.finish(27);case 30:if(m={type:"answer",sdp:b.write(v)},this._transportReady){e.next=34;break}return e.next=34,this.setupTransport({localDtlsRole:null!==(_=this._forcedLocalDtlsRole)&&void 0!==_?_:"client",localSdpObject:v});case 34:return T.debug("receive() | calling pc.setLocalDescription() [answer:%o]",m),e.next=37,this._pc.setLocalDescription(m);case 37:S=o(t),e.prev=38,R=u().mark((function e(){var t,o,i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=x.value,o=t.trackId,i=n.get(o),a=P._pc.getTransceivers().find((function(e){return e.mid===i}))){e.next=8;break}throw new Error("new RTCRtpTransceiver not found");case 8:P._mapMidTransceiver.set(i,a),r.push({localId:i,track:a.receiver.track,rtpReceiver:a.receiver});case 10:case"end":return e.stop()}}),e)})),S.s();case 41:if((x=S.n()).done){e.next=45;break}return e.delegateYield(R(),"t2",43);case 43:e.next=41;break;case 45:e.next=50;break;case 47:e.prev=47,e.t3=e.catch(38),S.e(e.t3);case 50:return e.prev=50,S.f(),e.finish(50);case 53:return e.abrupt("return",r);case 54:case"end":return e.stop()}}),e,this,[[15,24,27,30],[38,47,50,53]])}))),function(e){return w.apply(this,arguments)})},{key:"stopReceiving",value:(g=l(u().mark((function e(t){var r,n,i,a,s,c,p,l,d;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertRecvDirection(),!this._closed){e.next=3;break}return e.abrupt("return");case 3:r=o(t),e.prev=4,r.s();case 6:if((n=r.n()).done){e.next=15;break}if(i=n.value,T.debug("stopReceiving() [localId:%s]",i),a=this._mapMidTransceiver.get(i)){e.next=12;break}throw new Error("associated RTCRtpTransceiver not found");case 12:this._remoteSdp.closeMediaSection(a.mid);case 13:e.next=6;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(4),r.e(e.t0);case 20:return e.prev=20,r.f(),e.finish(20);case 23:return s={type:"offer",sdp:this._remoteSdp.getSdp()},T.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",s),e.next=27,this._pc.setRemoteDescription(s);case 27:return e.next=29,this._pc.createAnswer();case 29:return c=e.sent,T.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",c),e.next=33,this._pc.setLocalDescription(c);case 33:p=o(t);try{for(p.s();!(l=p.n()).done;)d=l.value,this._mapMidTransceiver.delete(d)}catch(e){p.e(e)}finally{p.f()}case 35:case"end":return e.stop()}}),e,this,[[4,17,20,23]])}))),function(e){return g.apply(this,arguments)})},{key:"pauseReceiving",value:(y=l(u().mark((function e(t){var r,n,i,a,s,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertNotClosed(),this.assertRecvDirection(),r=o(t),e.prev=3,r.s();case 5:if((n=r.n()).done){e.next=15;break}if(i=n.value,T.debug("pauseReceiving() [localId:%s]",i),a=this._mapMidTransceiver.get(i)){e.next=11;break}throw new Error("associated RTCRtpTransceiver not found");case 11:a.direction="inactive",this._remoteSdp.pauseMediaSection(i);case 13:e.next=5;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(3),r.e(e.t0);case 20:return e.prev=20,r.f(),e.finish(20);case 23:return s={type:"offer",sdp:this._remoteSdp.getSdp()},T.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",s),e.next=27,this._pc.setRemoteDescription(s);case 27:return e.next=29,this._pc.createAnswer();case 29:return c=e.sent,T.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",c),e.next=33,this._pc.setLocalDescription(c);case 33:case"end":return e.stop()}}),e,this,[[3,17,20,23]])}))),function(e){return y.apply(this,arguments)})},{key:"resumeReceiving",value:(v=l(u().mark((function e(t){var r,n,i,a,s,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertNotClosed(),this.assertRecvDirection(),r=o(t),e.prev=3,r.s();case 5:if((n=r.n()).done){e.next=15;break}if(i=n.value,T.debug("resumeReceiving() [localId:%s]",i),a=this._mapMidTransceiver.get(i)){e.next=11;break}throw new Error("associated RTCRtpTransceiver not found");case 11:a.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(i);case 13:e.next=5;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(3),r.e(e.t0);case 20:return e.prev=20,r.f(),e.finish(20);case 23:return s={type:"offer",sdp:this._remoteSdp.getSdp()},T.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",s),e.next=27,this._pc.setRemoteDescription(s);case 27:return e.next=29,this._pc.createAnswer();case 29:return c=e.sent,T.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",c),e.next=33,this._pc.setLocalDescription(c);case 33:case"end":return e.stop()}}),e,this,[[3,17,20,23]])}))),function(e){return v.apply(this,arguments)})},{key:"getReceiverStats",value:(f=l(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertRecvDirection(),r=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return e.abrupt("return",r.receiver.getStats());case 6:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"receiveDataChannel",value:(p=l(u().mark((function e(t){var r,n,o,i,a,s,c,p,l,d,f,h,m;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.sctpStreamParameters,n=t.label,o=t.protocol,this.assertNotClosed(),this.assertRecvDirection(),i=r.streamId,a=r.ordered,s=r.maxPacketLifeTime,c=r.maxRetransmits,p={negotiated:!0,id:i,ordered:a,maxPacketLifeTime:s,maxRetransmits:c,protocol:o},T.debug("receiveDataChannel() [options:%o]",p),l=this._pc.createDataChannel(n,p),this._hasDataChannelMediaSection){e.next=24;break}return this._remoteSdp.receiveSctpAssociation(),d={type:"offer",sdp:this._remoteSdp.getSdp()},T.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),e.next=13,this._pc.setRemoteDescription(d);case 13:return e.next=15,this._pc.createAnswer();case 15:if(f=e.sent,this._transportReady){e.next=20;break}return m=b.parse(f.sdp),e.next=20,this.setupTransport({localDtlsRole:null!==(h=this._forcedLocalDtlsRole)&&void 0!==h?h:"client",localSdpObject:m});case 20:return T.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),e.next=23,this._pc.setLocalDescription(f);case 23:this._hasDataChannelMediaSection=!0;case 24:return e.abrupt("return",{dataChannel:l});case 25:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"setupTransport",value:(s=l(u().mark((function e(t){var r,n,o,i=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.localDtlsRole,(n=t.localSdpObject)||(n=b.parse(this._pc.localDescription.sdp)),(o=k.extractDtlsParameters({sdpObject:n})).role=r,this._remoteSdp.updateDtlsRole("client"===r?"server":"client"),e.next=7,new Promise((function(e,t){i.safeEmit("@connect",{dtlsParameters:o},e,t)}));case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"assertNotClosed",value:function(){if(this._closed)throw new P.InvalidStateError("method called in a closed handler")}},{key:"assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],i=[{key:"createFactory",value:function(){return function(){return new Y}}}],r&&d(t.prototype,r),i&&d(t,i),Object.defineProperty(t,"prototype",{writable:!1}),Y}(C.HandlerInterface);t.ReactNativeUnifiedPlan=D},6893:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a.apply(this,arguments)}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){var n,o,i;n=e,o=t,i=r[t],(o=f(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(){u=function(){return t};var e,t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",p=a.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof b?t:b,a=Object.create(o.prototype),s=new D(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var h="suspendedStart",m="suspendedYield",v="executing",y="completed",g={};function b(){}function w(){}function _(){}var S={};l(S,s,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(L([])));x&&x!==r&&o.call(x,s)&&(S=x);var R=_.prototype=b.prototype=Object.create(S);function P(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(i,a,s,c){var u=f(e[i],e,a);if("throw"!==u.type){var p=u.arg,l=p.value;return l&&"object"==n(l)&&o.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):t.resolve(l).then((function(e){p.value=e,s(p)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var a;i(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function O(t,r,n){var o=h;return function(i,a){if(o===v)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=E(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?y:m,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function E(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,E(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[s];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function r(){for(;++i<t.length;)if(o.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(n(t)+" is not iterable")}return w.prototype=_,i(R,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:w,configurable:!0}),w.displayName=l(_,p,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,l(e,p,"GeneratorFunction")),e.prototype=Object.create(R),e},t.awrap=function(e){return{__await:e}},P(C.prototype),l(C.prototype,c,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new C(d(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},P(R),l(R,p,"Generator"),l(R,s,(function(){return this})),l(R,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function p(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){p(i,n,o,a,s,"next",e)}function s(e){p(i,n,o,a,s,"throw",e)}a(void 0)}))}}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function f(e){var t=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===n(t)?t:String(t)}function h(e,t){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},h(e,t)}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}var v=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),y=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),g=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&v(t,e,r);return y(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Safari11=void 0;var b=g(r(9652)),w=r(1916),_=g(r(5234)),S=g(r(6059)),k=g(r(5388)),x=g(r(5156)),R=r(1144),P=r(9196),C=new w.Logger("Safari11"),O={OS:1024,MIS:1024},E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(W,e);var t,r,i,s,p,f,v,y,g,w,R,E,T,j,D,L,I,M,A,N,F,B,G,V,U,q,z=(U=W,q=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=m(U);if(q){var r=m(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function W(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,W),(e=z.call(this))._sendStream=new MediaStream,e._mapSendLocalIdRtpSender=new Map,e._nextSendLocalId=0,e._mapRecvLocalIdInfo=new Map,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return t=W,r=[{key:"name",get:function(){return"Safari11"}},{key:"close",value:function(){if(C.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}},{key:"getNativeRtpCapabilities",value:(V=l(u().mark((function e(){var t,r,n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"}),e.prev=2,e.next=5,t.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});case 5:r=e.sent;try{t.close()}catch(e){}return n=b.parse(r.sdp),o=k.extractRtpCapabilities({sdpObject:n}),e.abrupt("return",o);case 12:e.prev=12,e.t0=e.catch(2);try{t.close()}catch(e){}throw e.t0;case 16:case"end":return e.stop()}}),e,null,[[2,12]])}))),function(){return V.apply(this,arguments)})},{key:"getNativeSctpCapabilities",value:(G=l(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:O});case 2:case"end":return e.stop()}}),e)}))),function(){return G.apply(this,arguments)})},{key:"run",value:function(e){var t=this,r=e.direction,n=e.iceParameters,o=e.iceCandidates,i=e.dtlsParameters,a=e.sctpParameters,s=e.iceServers,u=e.iceTransportPolicy,p=e.additionalSettings,l=e.proprietaryConstraints,d=e.extendedRtpCapabilities;C.debug("run()"),this._direction=r,this._remoteSdp=new P.RemoteSdp({iceParameters:n,iceCandidates:o,dtlsParameters:i,sctpParameters:a,planB:!0}),this._sendingRtpParametersByKind={audio:S.getSendingRtpParameters("audio",d),video:S.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:S.getSendingRemoteRtpParameters("audio",d),video:S.getSendingRemoteRtpParameters("video",d)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection(c({iceServers:s||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},p),l),this._pc.addEventListener("icegatheringstatechange",(function(){t.emit("@icegatheringstatechange",t._pc.iceGatheringState)})),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(function(){t.emit("@connectionstatechange",t._pc.connectionState)})):this._pc.addEventListener("iceconnectionstatechange",(function(){switch(C.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:(B=l(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C.debug("updateIceServers()"),(r=this._pc.getConfiguration()).iceServers=t,this._pc.setConfiguration(r);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return B.apply(this,arguments)})},{key:"restartIce",value:(F=l(u().mark((function e(t){var r,n,o,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(C.debug("restartIce()"),this._remoteSdp.updateIceParameters(t),this._transportReady){e.next=4;break}return e.abrupt("return");case 4:if("send"!==this._direction){e.next=17;break}return e.next=7,this._pc.createOffer({iceRestart:!0});case 7:return r=e.sent,C.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),e.next=11,this._pc.setLocalDescription(r);case 11:return n={type:"answer",sdp:this._remoteSdp.getSdp()},C.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),e.next=15,this._pc.setRemoteDescription(n);case 15:e.next=27;break;case 17:return o={type:"offer",sdp:this._remoteSdp.getSdp()},C.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=21,this._pc.setRemoteDescription(o);case 21:return e.next=23,this._pc.createAnswer();case 23:return i=e.sent,C.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",i),e.next=27,this._pc.setLocalDescription(i);case 27:case"end":return e.stop()}}),e,this)}))),function(e){return F.apply(this,arguments)})},{key:"getTransportStats",value:(N=l(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)}))),function(){return N.apply(this,arguments)})},{key:"send",value:(A=l(u().mark((function e(t){var r,n,i,s,c,p,l,d,f,h,m,v,y,g,w,R;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.track,n=t.encodings,i=t.codecOptions,s=t.codec,this.assertSendDirection(),C.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),s&&C.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(r),this._pc.addTrack(r,this._sendStream),e.next=8,this._pc.createOffer();case 8:if(c=e.sent,p=b.parse(c.sdp),(d=_.clone(this._sendingRtpParametersByKind[r.kind])).codecs=S.reduceCodecs(d.codecs),(f=_.clone(this._sendingRemoteRtpParametersByKind[r.kind])).codecs=S.reduceCodecs(f.codecs),this._transportReady){e.next=17;break}return e.next=17,this.setupTransport({localDtlsRole:null!==(h=this._forcedLocalDtlsRole)&&void 0!==h?h:"client",localSdpObject:p});case 17:return"video"===r.kind&&n&&n.length>1&&(C.debug("send() | enabling simulcast"),p=b.parse(c.sdp),l=p.media.find((function(e){return"video"===e.type})),x.addLegacySimulcast({offerMediaObject:l,track:r,numStreams:n.length}),c={type:"offer",sdp:b.write(p)}),C.debug("send() | calling pc.setLocalDescription() [offer:%o]",c),e.next=21,this._pc.setLocalDescription(c);case 21:if(p=b.parse(this._pc.localDescription.sdp),l=p.media.find((function(e){return e.type===r.kind})),d.rtcp.cname=k.getCname({offerMediaObject:l}),d.encodings=x.getRtpEncodings({offerMediaObject:l,track:r}),n)for(m=0;m<d.encodings.length;++m)n[m]&&a(d.encodings[m],n[m]);if(d.encodings.length>1&&"video/vp8"===d.codecs[0].mimeType.toLowerCase()){v=o(d.encodings);try{for(v.s();!(y=v.n()).done;)y.value.scalabilityMode="L1T3"}catch(e){v.e(e)}finally{v.f()}}return this._remoteSdp.send({offerMediaObject:l,offerRtpParameters:d,answerRtpParameters:f,codecOptions:i}),g={type:"answer",sdp:this._remoteSdp.getSdp()},C.debug("send() | calling pc.setRemoteDescription() [answer:%o]",g),e.next=32,this._pc.setRemoteDescription(g);case 32:return w=String(this._nextSendLocalId),this._nextSendLocalId++,R=this._pc.getSenders().find((function(e){return e.track===r})),this._mapSendLocalIdRtpSender.set(w,R),e.abrupt("return",{localId:w,rtpParameters:d,rtpSender:R});case 37:case"end":return e.stop()}}),e,this)}))),function(e){return A.apply(this,arguments)})},{key:"stopSending",value:(M=l(u().mark((function e(t){var r,n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),r=this._mapSendLocalIdRtpSender.get(t)){e.next=4;break}throw new Error("associated RTCRtpSender not found");case 4:return r.track&&this._sendStream.removeTrack(r.track),this._mapSendLocalIdRtpSender.delete(t),e.next=8,this._pc.createOffer();case 8:return n=e.sent,C.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),e.prev=10,e.next=13,this._pc.setLocalDescription(n);case 13:e.next=21;break;case 15:if(e.prev=15,e.t0=e.catch(10),0!==this._sendStream.getTracks().length){e.next=20;break}return C.warn("stopSending() | ignoring expected error due no sending tracks: %s",e.t0.toString()),e.abrupt("return");case 20:throw e.t0;case 21:if("stable"!==this._pc.signalingState){e.next=23;break}return e.abrupt("return");case 23:return o={type:"answer",sdp:this._remoteSdp.getSdp()},C.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=27,this._pc.setRemoteDescription(o);case 27:case"end":return e.stop()}}),e,this,[[10,15]])}))),function(e){return M.apply(this,arguments)})},{key:"pauseSending",value:(I=l(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return I.apply(this,arguments)})},{key:"resumeSending",value:(L=l(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return L.apply(this,arguments)})},{key:"replaceTrack",value:(D=l(u().mark((function e(t,r){var n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),r?C.debug("replaceTrack() [localId:%s, track.id:%s]",t,r.id):C.debug("replaceTrack() [localId:%s, no track]",t),n=this._mapSendLocalIdRtpSender.get(t)){e.next=5;break}throw new Error("associated RTCRtpSender not found");case 5:return o=n.track,e.next=8,n.replaceTrack(r);case 8:o&&this._sendStream.removeTrack(o),r&&this._sendStream.addTrack(r);case 10:case"end":return e.stop()}}),e,this)}))),function(e,t){return D.apply(this,arguments)})},{key:"setMaxSpatialLayer",value:(j=l(u().mark((function e(t,r){var n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),C.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,r),n=this._mapSendLocalIdRtpSender.get(t)){e.next=5;break}throw new Error("associated RTCRtpSender not found");case 5:return(o=n.getParameters()).encodings.forEach((function(e,t){e.active=t<=r})),e.next=9,n.setParameters(o);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return j.apply(this,arguments)})},{key:"setRtpEncodingParameters",value:(T=l(u().mark((function e(t,r){var n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),C.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,r),n=this._mapSendLocalIdRtpSender.get(t)){e.next=5;break}throw new Error("associated RTCRtpSender not found");case 5:return(o=n.getParameters()).encodings.forEach((function(e,t){o.encodings[t]=c(c({},e),r)})),e.next=9,n.setParameters(o);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return T.apply(this,arguments)})},{key:"getSenderStats",value:(E=l(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),r=this._mapSendLocalIdRtpSender.get(t)){e.next=4;break}throw new Error("associated RTCRtpSender not found");case 4:return e.abrupt("return",r.getStats());case 5:case"end":return e.stop()}}),e,this)}))),function(e){return E.apply(this,arguments)})},{key:"sendDataChannel",value:(R=l(u().mark((function e(t){var r,n,o,i,a,s,c,p,l,d,f,h,m;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.ordered,n=t.maxPacketLifeTime,o=t.maxRetransmits,i=t.label,a=t.protocol,this.assertSendDirection(),s={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmits:o,protocol:a},C.debug("sendDataChannel() [options:%o]",s),c=this._pc.createDataChannel(i,s),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%O.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=9,this._pc.createOffer();case 9:if(p=e.sent,l=b.parse(p.sdp),d=l.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=15;break}return e.next=15,this.setupTransport({localDtlsRole:null!==(f=this._forcedLocalDtlsRole)&&void 0!==f?f:"client",localSdpObject:l});case 15:return C.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",p),e.next=18,this._pc.setLocalDescription(p);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:d}),h={type:"answer",sdp:this._remoteSdp.getSdp()},C.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",h),e.next=23,this._pc.setRemoteDescription(h);case 23:this._hasDataChannelMediaSection=!0;case 24:return m={streamId:s.id,ordered:s.ordered,maxPacketLifeTime:s.maxPacketLifeTime,maxRetransmits:s.maxRetransmits},e.abrupt("return",{dataChannel:c,sctpStreamParameters:m});case 26:case"end":return e.stop()}}),e,this)}))),function(e){return R.apply(this,arguments)})},{key:"receive",value:(w=l(u().mark((function e(t){var r,n,i,a,s,c,p,l,d,f,h,m,v,y,g,w,_,S,x,R=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=[],n=o(t);try{for(n.s();!(i=n.n()).done;)a=i.value,s=a.trackId,c=a.kind,p=a.rtpParameters,l=a.streamId,C.debug("receive() [trackId:%s, kind:%s]",s,c),d=c,this._remoteSdp.receive({mid:d,kind:c,offerRtpParameters:p,streamId:l||p.rtcp.cname,trackId:s})}catch(e){n.e(e)}finally{n.f()}return f={type:"offer",sdp:this._remoteSdp.getSdp()},C.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",f),e.next=8,this._pc.setRemoteDescription(f);case 8:return e.next=10,this._pc.createAnswer();case 10:h=e.sent,m=b.parse(h.sdp),v=o(t),e.prev=13,g=u().mark((function e(){var t,r,n,o,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=y.value,r=t.kind,n=t.rtpParameters,o=r,i=m.media.find((function(e){return String(e.mid)===o})),k.applyCodecParameters({offerRtpParameters:n,answerMediaObject:i});case 5:case"end":return e.stop()}}),e)})),v.s();case 16:if((y=v.n()).done){e.next=20;break}return e.delegateYield(g(),"t0",18);case 18:e.next=16;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(13),v.e(e.t1);case 25:return e.prev=25,v.f(),e.finish(25);case 28:if(h={type:"answer",sdp:b.write(m)},this._transportReady){e.next=32;break}return e.next=32,this.setupTransport({localDtlsRole:null!==(w=this._forcedLocalDtlsRole)&&void 0!==w?w:"client",localSdpObject:m});case 32:return C.debug("receive() | calling pc.setLocalDescription() [answer:%o]",h),e.next=35,this._pc.setLocalDescription(h);case 35:_=o(t),e.prev=36,x=u().mark((function e(){var t,n,o,i,a,s,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=S.value,n=t.kind,o=t.trackId,i=t.rtpParameters,a=n,s=o,c=R._pc.getReceivers().find((function(e){return e.track&&e.track.id===s}))){e.next=7;break}throw new Error("new RTCRtpReceiver not");case 7:R._mapRecvLocalIdInfo.set(s,{mid:a,rtpParameters:i,rtpReceiver:c}),r.push({localId:s,track:c.track,rtpReceiver:c});case 9:case"end":return e.stop()}}),e)})),_.s();case 39:if((S=_.n()).done){e.next=43;break}return e.delegateYield(x(),"t2",41);case 41:e.next=39;break;case 43:e.next=48;break;case 45:e.prev=45,e.t3=e.catch(36),_.e(e.t3);case 48:return e.prev=48,_.f(),e.finish(48);case 51:return e.abrupt("return",r);case 52:case"end":return e.stop()}}),e,this,[[13,22,25,28],[36,45,48,51]])}))),function(e){return w.apply(this,arguments)})},{key:"stopReceiving",value:(g=l(u().mark((function e(t){var r,n,i,a,s,c,p,l;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=o(t);try{for(r.s();!(n=r.n()).done;)i=n.value,C.debug("stopReceiving() [localId:%s]",i),a=this._mapRecvLocalIdInfo.get(i)||{},s=a.mid,c=a.rtpParameters,this._mapRecvLocalIdInfo.delete(i),this._remoteSdp.planBStopReceiving({mid:s,offerRtpParameters:c})}catch(e){r.e(e)}finally{r.f()}return p={type:"offer",sdp:this._remoteSdp.getSdp()},C.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",p),e.next=7,this._pc.setRemoteDescription(p);case 7:return e.next=9,this._pc.createAnswer();case 9:return l=e.sent,C.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",l),e.next=13,this._pc.setLocalDescription(l);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"getReceiverStats",value:(y=l(u().mark((function e(t){var r,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertRecvDirection(),r=this._mapRecvLocalIdInfo.get(t)||{},n=r.rtpReceiver){e.next=4;break}throw new Error("associated RTCRtpReceiver not found");case 4:return e.abrupt("return",n.getStats());case 5:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"pauseReceiving",value:(v=l(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return v.apply(this,arguments)})},{key:"resumeReceiving",value:(f=l(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return f.apply(this,arguments)})},{key:"receiveDataChannel",value:(p=l(u().mark((function e(t){var r,n,o,i,a,s,c,p,l,d,f,h,m;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.sctpStreamParameters,n=t.label,o=t.protocol,this.assertRecvDirection(),i=r.streamId,a=r.ordered,s=r.maxPacketLifeTime,c=r.maxRetransmits,p={negotiated:!0,id:i,ordered:a,maxPacketLifeTime:s,maxRetransmits:c,protocol:o},C.debug("receiveDataChannel() [options:%o]",p),l=this._pc.createDataChannel(n,p),this._hasDataChannelMediaSection){e.next=23;break}return this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0}),d={type:"offer",sdp:this._remoteSdp.getSdp()},C.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),e.next=12,this._pc.setRemoteDescription(d);case 12:return e.next=14,this._pc.createAnswer();case 14:if(f=e.sent,this._transportReady){e.next=19;break}return m=b.parse(f.sdp),e.next=19,this.setupTransport({localDtlsRole:null!==(h=this._forcedLocalDtlsRole)&&void 0!==h?h:"client",localSdpObject:m});case 19:return C.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),e.next=22,this._pc.setLocalDescription(f);case 22:this._hasDataChannelMediaSection=!0;case 23:return e.abrupt("return",{dataChannel:l});case 24:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"setupTransport",value:(s=l(u().mark((function e(t){var r,n,o,i=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.localDtlsRole,(n=t.localSdpObject)||(n=b.parse(this._pc.localDescription.sdp)),(o=k.extractDtlsParameters({sdpObject:n})).role=r,this._remoteSdp.updateDtlsRole("client"===r?"server":"client"),e.next=7,new Promise((function(e,t){i.safeEmit("@connect",{dtlsParameters:o},e,t)}));case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],i=[{key:"createFactory",value:function(){return function(){return new W}}}],r&&d(t.prototype,r),i&&d(t,i),Object.defineProperty(t,"prototype",{writable:!1}),W}(R.HandlerInterface);t.Safari11=E},3614:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a.apply(this,arguments)}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){var n,o,i;n=e,o=t,i=r[t],(o=f(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(){u=function(){return t};var e,t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",p=a.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof b?t:b,a=Object.create(o.prototype),s=new D(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var h="suspendedStart",m="suspendedYield",v="executing",y="completed",g={};function b(){}function w(){}function _(){}var S={};l(S,s,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(L([])));x&&x!==r&&o.call(x,s)&&(S=x);var R=_.prototype=b.prototype=Object.create(S);function P(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(i,a,s,c){var u=f(e[i],e,a);if("throw"!==u.type){var p=u.arg,l=p.value;return l&&"object"==n(l)&&o.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):t.resolve(l).then((function(e){p.value=e,s(p)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var a;i(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function O(t,r,n){var o=h;return function(i,a){if(o===v)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=E(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?y:m,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function E(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,E(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[s];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function r(){for(;++i<t.length;)if(o.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(n(t)+" is not iterable")}return w.prototype=_,i(R,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:w,configurable:!0}),w.displayName=l(_,p,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,l(e,p,"GeneratorFunction")),e.prototype=Object.create(R),e},t.awrap=function(e){return{__await:e}},P(C.prototype),l(C.prototype,c,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new C(d(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},P(R),l(R,p,"Generator"),l(R,s,(function(){return this})),l(R,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function p(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){p(i,n,o,a,s,"next",e)}function s(e){p(i,n,o,a,s,"throw",e)}a(void 0)}))}}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function f(e){var t=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===n(t)?t:String(t)}function h(e,t){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},h(e,t)}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}var v=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),y=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),g=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&v(t,e,r);return y(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Safari12=void 0;var b=g(r(9652)),w=r(1916),_=g(r(5234)),S=g(r(6059)),k=g(r(5388)),x=g(r(8538)),R=g(r(337)),P=r(6020),C=r(1144),O=r(9196),E=r(9975),T=new w.Logger("Safari12"),j={OS:1024,MIS:1024},D=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(Y,e);var t,r,i,s,p,f,v,y,g,w,C,D,L,I,M,A,N,F,B,G,V,U,q,z,W,K,H=(W=Y,K=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=m(W);if(K){var r=m(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function Y(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Y),(e=H.call(this))._closed=!1,e._mapMidTransceiver=new Map,e._sendStream=new MediaStream,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return t=Y,r=[{key:"name",get:function(){return"Safari12"}},{key:"close",value:function(){if(T.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}}},{key:"getNativeRtpCapabilities",value:(z=l(u().mark((function e(){var t,r,n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"}),e.prev=2,t.addTransceiver("audio"),t.addTransceiver("video"),e.next=7,t.createOffer();case 7:r=e.sent;try{t.close()}catch(e){}return n=b.parse(r.sdp),o=k.extractRtpCapabilities({sdpObject:n}),R.addNackSuppportForOpus(o),e.abrupt("return",o);case 15:e.prev=15,e.t0=e.catch(2);try{t.close()}catch(e){}throw e.t0;case 19:case"end":return e.stop()}}),e,null,[[2,15]])}))),function(){return z.apply(this,arguments)})},{key:"getNativeSctpCapabilities",value:(q=l(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:j});case 2:case"end":return e.stop()}}),e)}))),function(){return q.apply(this,arguments)})},{key:"run",value:function(e){var t=this,r=e.direction,n=e.iceParameters,o=e.iceCandidates,i=e.dtlsParameters,a=e.sctpParameters,s=e.iceServers,u=e.iceTransportPolicy,p=e.additionalSettings,l=e.proprietaryConstraints,d=e.extendedRtpCapabilities;this.assertNotClosed(),T.debug("run()"),this._direction=r,this._remoteSdp=new O.RemoteSdp({iceParameters:n,iceCandidates:o,dtlsParameters:i,sctpParameters:a}),this._sendingRtpParametersByKind={audio:S.getSendingRtpParameters("audio",d),video:S.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:S.getSendingRemoteRtpParameters("audio",d),video:S.getSendingRemoteRtpParameters("video",d)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection(c({iceServers:s||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},p),l),this._pc.addEventListener("icegatheringstatechange",(function(){t.emit("@icegatheringstatechange",t._pc.iceGatheringState)})),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(function(){t.emit("@connectionstatechange",t._pc.connectionState)})):this._pc.addEventListener("iceconnectionstatechange",(function(){switch(T.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:(U=l(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertNotClosed(),T.debug("updateIceServers()"),(r=this._pc.getConfiguration()).iceServers=t,this._pc.setConfiguration(r);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return U.apply(this,arguments)})},{key:"restartIce",value:(V=l(u().mark((function e(t){var r,n,o,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),T.debug("restartIce()"),this._remoteSdp.updateIceParameters(t),this._transportReady){e.next=5;break}return e.abrupt("return");case 5:if("send"!==this._direction){e.next=18;break}return e.next=8,this._pc.createOffer({iceRestart:!0});case 8:return r=e.sent,T.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),e.next=12,this._pc.setLocalDescription(r);case 12:return n={type:"answer",sdp:this._remoteSdp.getSdp()},T.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),e.next=16,this._pc.setRemoteDescription(n);case 16:e.next=28;break;case 18:return o={type:"offer",sdp:this._remoteSdp.getSdp()},T.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=22,this._pc.setRemoteDescription(o);case 22:return e.next=24,this._pc.createAnswer();case 24:return i=e.sent,T.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",i),e.next=28,this._pc.setLocalDescription(i);case 28:case"end":return e.stop()}}),e,this)}))),function(e){return V.apply(this,arguments)})},{key:"getTransportStats",value:(G=l(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.assertNotClosed(),e.abrupt("return",this._pc.getStats());case 2:case"end":return e.stop()}}),e,this)}))),function(){return G.apply(this,arguments)})},{key:"send",value:(B=l(u().mark((function e(t){var r,n,i,s,c,p,l,d,f,h,m,v,y,g,w,R,P,C,O;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.track,n=t.encodings,i=t.codecOptions,s=t.codec,this.assertNotClosed(),this.assertSendDirection(),T.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),(c=_.clone(this._sendingRtpParametersByKind[r.kind])).codecs=S.reduceCodecs(c.codecs,s),(p=_.clone(this._sendingRemoteRtpParametersByKind[r.kind])).codecs=S.reduceCodecs(p.codecs,s),l=this._remoteSdp.getNextMediaSectionIdx(),d=this._pc.addTransceiver(r,{direction:"sendonly",streams:[this._sendStream]}),e.next=12,this._pc.createOffer();case 12:if(f=e.sent,h=b.parse(f.sdp),this._transportReady){e.next=17;break}return e.next=17,this.setupTransport({localDtlsRole:null!==(v=this._forcedLocalDtlsRole)&&void 0!==v?v:"client",localSdpObject:h});case 17:return y=(0,E.parse)((n||[{}])[0].scalabilityMode),n&&n.length>1&&(T.debug("send() | enabling legacy simulcast"),h=b.parse(f.sdp),m=h.media[l.idx],x.addLegacySimulcast({offerMediaObject:m,numStreams:n.length}),f={type:"offer",sdp:b.write(h)}),T.debug("send() | calling pc.setLocalDescription() [offer:%o]",f),e.next=22,this._pc.setLocalDescription(f);case 22:if(g=d.mid,c.mid=g,h=b.parse(this._pc.localDescription.sdp),m=h.media[l.idx],c.rtcp.cname=k.getCname({offerMediaObject:m}),c.encodings=x.getRtpEncodings({offerMediaObject:m}),n)for(w=0;w<c.encodings.length;++w)n[w]&&a(c.encodings[w],n[w]);if(c.encodings.length>1&&("video/vp8"===c.codecs[0].mimeType.toLowerCase()||"video/h264"===c.codecs[0].mimeType.toLowerCase())){R=o(c.encodings);try{for(R.s();!(P=R.n()).done;)(C=P.value).scalabilityMode?C.scalabilityMode="L1T".concat(y.temporalLayers):C.scalabilityMode="L1T3"}catch(e){R.e(e)}finally{R.f()}}return this._remoteSdp.send({offerMediaObject:m,reuseMid:l.reuseMid,offerRtpParameters:c,answerRtpParameters:p,codecOptions:i}),O={type:"answer",sdp:this._remoteSdp.getSdp()},T.debug("send() | calling pc.setRemoteDescription() [answer:%o]",O),e.next=35,this._pc.setRemoteDescription(O);case 35:return this._mapMidTransceiver.set(g,d),e.abrupt("return",{localId:g,rtpParameters:c,rtpSender:d.sender});case 37:case"end":return e.stop()}}),e,this)}))),function(e){return B.apply(this,arguments)})},{key:"stopSending",value:(F=l(u().mark((function e(t){var r,n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),!this._closed){e.next=3;break}return e.abrupt("return");case 3:if(T.debug("stopSending() [localId:%s]",t),r=this._mapMidTransceiver.get(t)){e.next=7;break}throw new Error("associated RTCRtpTransceiver not found");case 7:if(r.sender.replaceTrack(null),this._pc.removeTrack(r.sender),this._remoteSdp.closeMediaSection(r.mid))try{r.stop()}catch(e){}return e.next=13,this._pc.createOffer();case 13:return n=e.sent,T.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),e.next=17,this._pc.setLocalDescription(n);case 17:return o={type:"answer",sdp:this._remoteSdp.getSdp()},T.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=21,this._pc.setRemoteDescription(o);case 21:this._mapMidTransceiver.delete(t);case 22:case"end":return e.stop()}}),e,this)}))),function(e){return F.apply(this,arguments)})},{key:"pauseSending",value:(N=l(u().mark((function e(t){var r,n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertSendDirection(),T.debug("pauseSending() [localId:%s]",t),r=this._mapMidTransceiver.get(t)){e.next=6;break}throw new Error("associated RTCRtpTransceiver not found");case 6:return r.direction="inactive",this._remoteSdp.pauseMediaSection(t),e.next=10,this._pc.createOffer();case 10:return n=e.sent,T.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",n),e.next=14,this._pc.setLocalDescription(n);case 14:return o={type:"answer",sdp:this._remoteSdp.getSdp()},T.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=18,this._pc.setRemoteDescription(o);case 18:case"end":return e.stop()}}),e,this)}))),function(e){return N.apply(this,arguments)})},{key:"resumeSending",value:(A=l(u().mark((function e(t){var r,n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertSendDirection(),T.debug("resumeSending() [localId:%s]",t),r=this._mapMidTransceiver.get(t)){e.next=6;break}throw new Error("associated RTCRtpTransceiver not found");case 6:return r.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(t),e.next=10,this._pc.createOffer();case 10:return n=e.sent,T.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",n),e.next=14,this._pc.setLocalDescription(n);case 14:return o={type:"answer",sdp:this._remoteSdp.getSdp()},T.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=18,this._pc.setRemoteDescription(o);case 18:case"end":return e.stop()}}),e,this)}))),function(e){return A.apply(this,arguments)})},{key:"replaceTrack",value:(M=l(u().mark((function e(t,r){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertSendDirection(),r?T.debug("replaceTrack() [localId:%s, track.id:%s]",t,r.id):T.debug("replaceTrack() [localId:%s, no track]",t),n=this._mapMidTransceiver.get(t)){e.next=6;break}throw new Error("associated RTCRtpTransceiver not found");case 6:return e.next=8,n.sender.replaceTrack(r);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return M.apply(this,arguments)})},{key:"setMaxSpatialLayer",value:(I=l(u().mark((function e(t,r){var n,o,i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertSendDirection(),T.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,r),n=this._mapMidTransceiver.get(t)){e.next=6;break}throw new Error("associated RTCRtpTransceiver not found");case 6:return(o=n.sender.getParameters()).encodings.forEach((function(e,t){e.active=t<=r})),e.next=10,n.sender.setParameters(o);case 10:return this._remoteSdp.muxMediaSectionSimulcast(t,o.encodings),e.next=13,this._pc.createOffer();case 13:return i=e.sent,T.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",i),e.next=17,this._pc.setLocalDescription(i);case 17:return a={type:"answer",sdp:this._remoteSdp.getSdp()},T.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=21,this._pc.setRemoteDescription(a);case 21:case"end":return e.stop()}}),e,this)}))),function(e,t){return I.apply(this,arguments)})},{key:"setRtpEncodingParameters",value:(L=l(u().mark((function e(t,r){var n,o,i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertSendDirection(),T.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,r),n=this._mapMidTransceiver.get(t)){e.next=6;break}throw new Error("associated RTCRtpTransceiver not found");case 6:return(o=n.sender.getParameters()).encodings.forEach((function(e,t){o.encodings[t]=c(c({},e),r)})),e.next=10,n.sender.setParameters(o);case 10:return this._remoteSdp.muxMediaSectionSimulcast(t,o.encodings),e.next=13,this._pc.createOffer();case 13:return i=e.sent,T.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",i),e.next=17,this._pc.setLocalDescription(i);case 17:return a={type:"answer",sdp:this._remoteSdp.getSdp()},T.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=21,this._pc.setRemoteDescription(a);case 21:case"end":return e.stop()}}),e,this)}))),function(e,t){return L.apply(this,arguments)})},{key:"getSenderStats",value:(D=l(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertSendDirection(),r=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return e.abrupt("return",r.sender.getStats());case 6:case"end":return e.stop()}}),e,this)}))),function(e){return D.apply(this,arguments)})},{key:"sendDataChannel",value:(C=l(u().mark((function e(t){var r,n,o,i,a,s,c,p,l,d,f,h,m;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.ordered,n=t.maxPacketLifeTime,o=t.maxRetransmits,i=t.label,a=t.protocol,this.assertNotClosed(),this.assertSendDirection(),s={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmits:o,protocol:a},T.debug("sendDataChannel() [options:%o]",s),c=this._pc.createDataChannel(i,s),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%j.MIS,this._hasDataChannelMediaSection){e.next=25;break}return e.next=10,this._pc.createOffer();case 10:if(p=e.sent,l=b.parse(p.sdp),d=l.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=16;break}return e.next=16,this.setupTransport({localDtlsRole:null!==(f=this._forcedLocalDtlsRole)&&void 0!==f?f:"client",localSdpObject:l});case 16:return T.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",p),e.next=19,this._pc.setLocalDescription(p);case 19:return this._remoteSdp.sendSctpAssociation({offerMediaObject:d}),h={type:"answer",sdp:this._remoteSdp.getSdp()},T.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",h),e.next=24,this._pc.setRemoteDescription(h);case 24:this._hasDataChannelMediaSection=!0;case 25:return m={streamId:s.id,ordered:s.ordered,maxPacketLifeTime:s.maxPacketLifeTime,maxRetransmits:s.maxRetransmits},e.abrupt("return",{dataChannel:c,sctpStreamParameters:m});case 27:case"end":return e.stop()}}),e,this)}))),function(e){return C.apply(this,arguments)})},{key:"receive",value:(w=l(u().mark((function e(t){var r,n,i,a,s,c,p,l,d,f,h,m,v,y,g,w,_,S,x,R,P=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertNotClosed(),this.assertRecvDirection(),r=[],n=new Map,i=o(t);try{for(i.s();!(a=i.n()).done;)s=a.value,c=s.trackId,p=s.kind,l=s.rtpParameters,d=s.streamId,T.debug("receive() [trackId:%s, kind:%s]",c,p),f=l.mid||String(this._mapMidTransceiver.size),n.set(c,f),this._remoteSdp.receive({mid:f,kind:p,offerRtpParameters:l,streamId:d||l.rtcp.cname,trackId:c})}catch(e){i.e(e)}finally{i.f()}return h={type:"offer",sdp:this._remoteSdp.getSdp()},T.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",h),e.next=10,this._pc.setRemoteDescription(h);case 10:return e.next=12,this._pc.createAnswer();case 12:m=e.sent,v=b.parse(m.sdp),y=o(t),e.prev=15,w=u().mark((function e(){var t,r,o,i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=g.value,r=t.trackId,o=t.rtpParameters,i=n.get(r),a=v.media.find((function(e){return String(e.mid)===i})),k.applyCodecParameters({offerRtpParameters:o,answerMediaObject:a});case 5:case"end":return e.stop()}}),e)})),y.s();case 18:if((g=y.n()).done){e.next=22;break}return e.delegateYield(w(),"t0",20);case 20:e.next=18;break;case 22:e.next=27;break;case 24:e.prev=24,e.t1=e.catch(15),y.e(e.t1);case 27:return e.prev=27,y.f(),e.finish(27);case 30:if(m={type:"answer",sdp:b.write(v)},this._transportReady){e.next=34;break}return e.next=34,this.setupTransport({localDtlsRole:null!==(_=this._forcedLocalDtlsRole)&&void 0!==_?_:"client",localSdpObject:v});case 34:return T.debug("receive() | calling pc.setLocalDescription() [answer:%o]",m),e.next=37,this._pc.setLocalDescription(m);case 37:S=o(t),e.prev=38,R=u().mark((function e(){var t,o,i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=x.value,o=t.trackId,i=n.get(o),a=P._pc.getTransceivers().find((function(e){return e.mid===i}))){e.next=6;break}throw new Error("new RTCRtpTransceiver not found");case 6:P._mapMidTransceiver.set(i,a),r.push({localId:i,track:a.receiver.track,rtpReceiver:a.receiver});case 8:case"end":return e.stop()}}),e)})),S.s();case 41:if((x=S.n()).done){e.next=45;break}return e.delegateYield(R(),"t2",43);case 43:e.next=41;break;case 45:e.next=50;break;case 47:e.prev=47,e.t3=e.catch(38),S.e(e.t3);case 50:return e.prev=50,S.f(),e.finish(50);case 53:return e.abrupt("return",r);case 54:case"end":return e.stop()}}),e,this,[[15,24,27,30],[38,47,50,53]])}))),function(e){return w.apply(this,arguments)})},{key:"stopReceiving",value:(g=l(u().mark((function e(t){var r,n,i,a,s,c,p,l,d;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertRecvDirection(),!this._closed){e.next=3;break}return e.abrupt("return");case 3:r=o(t),e.prev=4,r.s();case 6:if((n=r.n()).done){e.next=15;break}if(i=n.value,T.debug("stopReceiving() [localId:%s]",i),a=this._mapMidTransceiver.get(i)){e.next=12;break}throw new Error("associated RTCRtpTransceiver not found");case 12:this._remoteSdp.closeMediaSection(a.mid);case 13:e.next=6;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(4),r.e(e.t0);case 20:return e.prev=20,r.f(),e.finish(20);case 23:return s={type:"offer",sdp:this._remoteSdp.getSdp()},T.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",s),e.next=27,this._pc.setRemoteDescription(s);case 27:return e.next=29,this._pc.createAnswer();case 29:return c=e.sent,T.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",c),e.next=33,this._pc.setLocalDescription(c);case 33:p=o(t);try{for(p.s();!(l=p.n()).done;)d=l.value,this._mapMidTransceiver.delete(d)}catch(e){p.e(e)}finally{p.f()}case 35:case"end":return e.stop()}}),e,this,[[4,17,20,23]])}))),function(e){return g.apply(this,arguments)})},{key:"pauseReceiving",value:(y=l(u().mark((function e(t){var r,n,i,a,s,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertNotClosed(),this.assertRecvDirection(),r=o(t),e.prev=3,r.s();case 5:if((n=r.n()).done){e.next=15;break}if(i=n.value,T.debug("pauseReceiving() [localId:%s]",i),a=this._mapMidTransceiver.get(i)){e.next=11;break}throw new Error("associated RTCRtpTransceiver not found");case 11:a.direction="inactive",this._remoteSdp.pauseMediaSection(i);case 13:e.next=5;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(3),r.e(e.t0);case 20:return e.prev=20,r.f(),e.finish(20);case 23:return s={type:"offer",sdp:this._remoteSdp.getSdp()},T.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",s),e.next=27,this._pc.setRemoteDescription(s);case 27:return e.next=29,this._pc.createAnswer();case 29:return c=e.sent,T.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",c),e.next=33,this._pc.setLocalDescription(c);case 33:case"end":return e.stop()}}),e,this,[[3,17,20,23]])}))),function(e){return y.apply(this,arguments)})},{key:"resumeReceiving",value:(v=l(u().mark((function e(t){var r,n,i,a,s,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertNotClosed(),this.assertRecvDirection(),r=o(t),e.prev=3,r.s();case 5:if((n=r.n()).done){e.next=15;break}if(i=n.value,T.debug("resumeReceiving() [localId:%s]",i),a=this._mapMidTransceiver.get(i)){e.next=11;break}throw new Error("associated RTCRtpTransceiver not found");case 11:a.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(i);case 13:e.next=5;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(3),r.e(e.t0);case 20:return e.prev=20,r.f(),e.finish(20);case 23:return s={type:"offer",sdp:this._remoteSdp.getSdp()},T.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",s),e.next=27,this._pc.setRemoteDescription(s);case 27:return e.next=29,this._pc.createAnswer();case 29:return c=e.sent,T.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",c),e.next=33,this._pc.setLocalDescription(c);case 33:case"end":return e.stop()}}),e,this,[[3,17,20,23]])}))),function(e){return v.apply(this,arguments)})},{key:"getReceiverStats",value:(f=l(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertNotClosed(),this.assertRecvDirection(),r=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return e.abrupt("return",r.receiver.getStats());case 6:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"receiveDataChannel",value:(p=l(u().mark((function e(t){var r,n,o,i,a,s,c,p,l,d,f,h,m;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.sctpStreamParameters,n=t.label,o=t.protocol,this.assertNotClosed(),this.assertRecvDirection(),i=r.streamId,a=r.ordered,s=r.maxPacketLifeTime,c=r.maxRetransmits,p={negotiated:!0,id:i,ordered:a,maxPacketLifeTime:s,maxRetransmits:c,protocol:o},T.debug("receiveDataChannel() [options:%o]",p),l=this._pc.createDataChannel(n,p),this._hasDataChannelMediaSection){e.next=24;break}return this._remoteSdp.receiveSctpAssociation(),d={type:"offer",sdp:this._remoteSdp.getSdp()},T.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),e.next=13,this._pc.setRemoteDescription(d);case 13:return e.next=15,this._pc.createAnswer();case 15:if(f=e.sent,this._transportReady){e.next=20;break}return m=b.parse(f.sdp),e.next=20,this.setupTransport({localDtlsRole:null!==(h=this._forcedLocalDtlsRole)&&void 0!==h?h:"client",localSdpObject:m});case 20:return T.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),e.next=23,this._pc.setLocalDescription(f);case 23:this._hasDataChannelMediaSection=!0;case 24:return e.abrupt("return",{dataChannel:l});case 25:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"setupTransport",value:(s=l(u().mark((function e(t){var r,n,o,i=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.localDtlsRole,(n=t.localSdpObject)||(n=b.parse(this._pc.localDescription.sdp)),(o=k.extractDtlsParameters({sdpObject:n})).role=r,this._remoteSdp.updateDtlsRole("client"===r?"server":"client"),e.next=7,new Promise((function(e,t){i.safeEmit("@connect",{dtlsParameters:o},e,t)}));case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"assertNotClosed",value:function(){if(this._closed)throw new P.InvalidStateError("method called in a closed handler")}},{key:"assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],i=[{key:"createFactory",value:function(){return function(){return new Y}}}],r&&d(t.prototype,r),i&&d(t,i),Object.defineProperty(t,"prototype",{writable:!1}),Y}(C.HandlerInterface);t.Safari12=D},6819:function(e,t,r){"use strict";function n(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var i=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.mangleRtpParameters=t.getCapabilities=void 0;var c=s(r(5234));t.getCapabilities=function(){var e,t,r=RTCRtpReceiver.getCapabilities(),o=c.clone(r),i=n(null!==(e=o.codecs)&&void 0!==e?e:[]);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(a.channels=a.numChannels,delete a.numChannels,a.mimeType=a.mimeType||"".concat(a.kind,"/").concat(a.name),a.parameters){var s=a.parameters;s.apt&&(s.apt=Number(s.apt)),s["packetization-mode"]&&(s["packetization-mode"]=Number(s["packetization-mode"]))}var u,p=n(a.rtcpFeedback||[]);try{for(p.s();!(u=p.n()).done;){var l=u.value;l.parameter||(l.parameter="")}}catch(e){p.e(e)}finally{p.f()}}}catch(e){i.e(e)}finally{i.f()}return o},t.mangleRtpParameters=function(e){var t=c.clone(e);t.mid&&(t.muxId=t.mid,delete t.mid);var r,o=n(t.codecs);try{for(o.s();!(r=o.n()).done;){var i=r.value;i.channels&&(i.numChannels=i.channels,delete i.channels),i.mimeType&&!i.name&&(i.name=i.mimeType.split("/")[1]),delete i.mimeType}}catch(e){o.e(e)}finally{o.f()}return t}},337:(e,t)=>{"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}Object.defineProperty(t,"__esModule",{value:!0}),t.addNackSuppportForOpus=void 0,t.addNackSuppportForOpus=function(e){var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw a}}}}(e.codecs||[]);try{for(n.s();!(t=n.n()).done;){var o,i=t.value;"audio/opus"!==i.mimeType.toLowerCase()&&"audio/multiopus"!==i.mimeType.toLowerCase()||null!==(o=i.rtcpFeedback)&&void 0!==o&&o.some((function(e){return"nack"===e.type&&!e.parameter}))||(i.rtcpFeedback||(i.rtcpFeedback=[]),i.rtcpFeedback.push({type:"nack"}))}}catch(e){n.e(e)}finally{n.f()}}},560:function(e,t,r){"use strict";function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o(e,t)}function o(e,t){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},o(e,t)}function i(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=a(e);if(t){var o=a(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function a(e){return a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},a(e)}function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function c(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==s(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===s(o)?o:String(o)),n)}var o}function d(e,t,r){return t&&l(e.prototype,t),r&&l(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var f=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),h=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),m=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&f(t,e,r);return h(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.OfferMediaSection=t.AnswerMediaSection=t.MediaSection=void 0;var v=m(r(9652)),y=m(r(5234)),g=function(){function e(t){var r=t.iceParameters,n=t.iceCandidates,o=t.dtlsParameters,i=t.planB,a=void 0!==i&&i;if(p(this,e),this._mediaObject={},this._planB=a,r&&this.setIceParameters(r),n){this._mediaObject.candidates=[];var s,u=c(n);try{for(u.s();!(s=u.n()).done;){var l=s.value,d={component:1};d.foundation=l.foundation,d.ip=l.ip,d.port=l.port,d.priority=l.priority,d.transport=l.protocol,d.type=l.type,l.tcpType&&(d.tcptype=l.tcpType),this._mediaObject.candidates.push(d)}}catch(e){u.e(e)}finally{u.f()}this._mediaObject.endOfCandidates="end-of-candidates",this._mediaObject.iceOptions="renomination"}o&&this.setDtlsRole(o.role)}return d(e,[{key:"mid",get:function(){return String(this._mediaObject.mid)}},{key:"closed",get:function(){return 0===this._mediaObject.port}},{key:"getObject",value:function(){return this._mediaObject}},{key:"setIceParameters",value:function(e){this._mediaObject.iceUfrag=e.usernameFragment,this._mediaObject.icePwd=e.password}},{key:"pause",value:function(){this._mediaObject.direction="inactive"}},{key:"disable",value:function(){this.pause(),delete this._mediaObject.ext,delete this._mediaObject.ssrcs,delete this._mediaObject.ssrcGroups,delete this._mediaObject.simulcast,delete this._mediaObject.simulcast_03,delete this._mediaObject.rids,delete this._mediaObject.extmapAllowMixed}},{key:"close",value:function(){this.disable(),this._mediaObject.port=0}}]),e}();t.MediaSection=g;var b=function(e){n(r,e);var t=i(r);function r(e){var n,o=e.iceParameters,i=e.iceCandidates,a=e.dtlsParameters,s=e.sctpParameters,u=e.plainRtpParameters,l=e.planB,d=void 0!==l&&l,f=e.offerMediaObject,h=e.offerRtpParameters,m=e.answerRtpParameters,v=e.codecOptions,g=e.extmapAllowMixed,b=void 0!==g&&g;switch(p(this,r),(n=t.call(this,{iceParameters:o,iceCandidates:i,dtlsParameters:a,planB:d}))._mediaObject.mid=String(f.mid),n._mediaObject.type=f.type,n._mediaObject.protocol=f.protocol,u?(n._mediaObject.connection={ip:u.ip,version:u.ipVersion},n._mediaObject.port=u.port):(n._mediaObject.connection={ip:"127.0.0.1",version:4},n._mediaObject.port=7),f.type){case"audio":case"video":n._mediaObject.direction="recvonly",n._mediaObject.rtp=[],n._mediaObject.rtcpFb=[],n._mediaObject.fmtp=[];var w,S=c(m.codecs);try{var k=function(){var e,t,r=w.value,o={payload:r.payloadType,codec:_(r),rate:r.clockRate};r.channels>1&&(o.encoding=r.channels),n._mediaObject.rtp.push(o);var i=null!==(e=y.clone(r.parameters))&&void 0!==e?e:{},a=null!==(t=y.clone(r.rtcpFeedback))&&void 0!==t?t:[];if(v){var s=v.opusStereo,u=v.opusFec,p=v.opusDtx,l=v.opusMaxPlaybackRate,d=v.opusMaxAverageBitrate,f=v.opusPtime,m=v.opusNack,g=v.videoGoogleStartBitrate,b=v.videoGoogleMaxBitrate,S=v.videoGoogleMinBitrate,k=h.codecs.find((function(e){return e.payloadType===r.payloadType}));switch(r.mimeType.toLowerCase()){case"audio/opus":case"audio/multiopus":void 0!==s&&(k.parameters["sprop-stereo"]=s?1:0,i.stereo=s?1:0),void 0!==u&&(k.parameters.useinbandfec=u?1:0,i.useinbandfec=u?1:0),void 0!==p&&(k.parameters.usedtx=p?1:0,i.usedtx=p?1:0),void 0!==l&&(i.maxplaybackrate=l),void 0!==d&&(i.maxaveragebitrate=d),void 0!==f&&(k.parameters.ptime=f,i.ptime=f),m||(k.rtcpFeedback=k.rtcpFeedback.filter((function(e){return"nack"!==e.type||e.parameter})),a=a.filter((function(e){return"nack"!==e.type||e.parameter})));break;case"video/vp8":case"video/vp9":case"video/h264":case"video/h265":void 0!==g&&(i["x-google-start-bitrate"]=g),void 0!==b&&(i["x-google-max-bitrate"]=b),void 0!==S&&(i["x-google-min-bitrate"]=S)}}for(var x={payload:r.payloadType,config:""},R=0,P=Object.keys(i);R<P.length;R++){var C=P[R];x.config&&(x.config+=";"),x.config+="".concat(C,"=").concat(i[C])}x.config&&n._mediaObject.fmtp.push(x);var O,E=c(a);try{for(E.s();!(O=E.n()).done;){var T=O.value;n._mediaObject.rtcpFb.push({payload:r.payloadType,type:T.type,subtype:T.parameter})}}catch(e){E.e(e)}finally{E.f()}};for(S.s();!(w=S.n()).done;)k()}catch(e){S.e(e)}finally{S.f()}n._mediaObject.payloads=m.codecs.map((function(e){return e.payloadType})).join(" "),n._mediaObject.ext=[];var x,R=c(m.headerExtensions);try{var P=function(){var e=x.value;if(!(f.ext||[]).some((function(t){return t.uri===e.uri})))return 1;n._mediaObject.ext.push({uri:e.uri,value:e.id})};for(R.s();!(x=R.n()).done;)P()}catch(e){R.e(e)}finally{R.f()}if(b&&"extmap-allow-mixed"===f.extmapAllowMixed&&(n._mediaObject.extmapAllowMixed="extmap-allow-mixed"),f.simulcast){n._mediaObject.simulcast={dir1:"recv",list1:f.simulcast.list1},n._mediaObject.rids=[];var C,O=c(f.rids||[]);try{for(O.s();!(C=O.n()).done;){var E=C.value;"send"===E.direction&&n._mediaObject.rids.push({id:E.id,direction:"recv"})}}catch(e){O.e(e)}finally{O.f()}}else if(f.simulcast_03){n._mediaObject.simulcast_03={value:f.simulcast_03.value.replace(/send/g,"recv")},n._mediaObject.rids=[];var T,j=c(f.rids||[]);try{for(j.s();!(T=j.n()).done;){var D=T.value;"send"===D.direction&&n._mediaObject.rids.push({id:D.id,direction:"recv"})}}catch(e){j.e(e)}finally{j.f()}}n._mediaObject.rtcpMux="rtcp-mux",n._mediaObject.rtcpRsize="rtcp-rsize",n._planB&&"video"===n._mediaObject.type&&(n._mediaObject.xGoogleFlag="conference");break;case"application":"number"==typeof f.sctpPort?(n._mediaObject.payloads="webrtc-datachannel",n._mediaObject.sctpPort=s.port,n._mediaObject.maxMessageSize=s.maxMessageSize):f.sctpmap&&(n._mediaObject.payloads=s.port,n._mediaObject.sctpmap={app:"webrtc-datachannel",sctpmapNumber:s.port,maxMessageSize:s.maxMessageSize})}return n}return d(r,[{key:"setDtlsRole",value:function(e){switch(e){case"client":this._mediaObject.setup="active";break;case"server":this._mediaObject.setup="passive";break;case"auto":this._mediaObject.setup="actpass"}}},{key:"resume",value:function(){this._mediaObject.direction="recvonly"}},{key:"muxSimulcastStreams",value:function(e){if(this._mediaObject.simulcast&&this._mediaObject.simulcast.list1){var t,r={},n=c(e);try{for(n.s();!(t=n.n()).done;){var o=t.value;o.rid&&(r[o.rid]=o)}}catch(e){n.e(e)}finally{n.f()}var i,a=this._mediaObject.simulcast.list1,s=v.parseSimulcastStreamList(a),u=c(s);try{for(u.s();!(i=u.n()).done;){var p,l=c(i.value);try{for(l.s();!(p=l.n()).done;){var d,f=p.value;f.paused=!(null!==(d=r[f.scid])&&void 0!==d&&d.active)}}catch(e){l.e(e)}finally{l.f()}}}catch(e){u.e(e)}finally{u.f()}this._mediaObject.simulcast.list1=s.map((function(e){return e.map((function(e){return"".concat(e.paused?"~":"").concat(e.scid)})).join(",")})).join(";")}}}]),r}(g);t.AnswerMediaSection=b;var w=function(e){n(r,e);var t=i(r);function r(e){var n,o=e.iceParameters,i=e.iceCandidates,a=e.dtlsParameters,s=e.sctpParameters,u=e.plainRtpParameters,l=e.planB,d=void 0!==l&&l,f=e.mid,h=e.kind,m=e.offerRtpParameters,v=e.streamId,y=e.trackId,g=e.oldDataChannelSpec,b=void 0!==g&&g;switch(p(this,r),(n=t.call(this,{iceParameters:o,iceCandidates:i,dtlsParameters:a,planB:d}))._mediaObject.mid=String(f),n._mediaObject.type=h,u?(n._mediaObject.connection={ip:u.ip,version:u.ipVersion},n._mediaObject.protocol="RTP/AVP",n._mediaObject.port=u.port):(n._mediaObject.connection={ip:"127.0.0.1",version:4},n._mediaObject.protocol=s?"UDP/DTLS/SCTP":"UDP/TLS/RTP/SAVPF",n._mediaObject.port=7),h){case"audio":case"video":n._mediaObject.direction="sendonly",n._mediaObject.rtp=[],n._mediaObject.rtcpFb=[],n._mediaObject.fmtp=[],n._planB||(n._mediaObject.msid="".concat(v||"-"," ").concat(y));var w,S=c(m.codecs);try{for(S.s();!(w=S.n()).done;){var k=w.value,x={payload:k.payloadType,codec:_(k),rate:k.clockRate};k.channels>1&&(x.encoding=k.channels),n._mediaObject.rtp.push(x);for(var R={payload:k.payloadType,config:""},P=0,C=Object.keys(k.parameters);P<C.length;P++){var O=C[P];R.config&&(R.config+=";"),R.config+="".concat(O,"=").concat(k.parameters[O])}R.config&&n._mediaObject.fmtp.push(R);var E,T=c(k.rtcpFeedback);try{for(T.s();!(E=T.n()).done;){var j=E.value;n._mediaObject.rtcpFb.push({payload:k.payloadType,type:j.type,subtype:j.parameter})}}catch(e){T.e(e)}finally{T.f()}}}catch(e){S.e(e)}finally{S.f()}n._mediaObject.payloads=m.codecs.map((function(e){return e.payloadType})).join(" "),n._mediaObject.ext=[];var D,L=c(m.headerExtensions);try{for(L.s();!(D=L.n()).done;){var I=D.value;n._mediaObject.ext.push({uri:I.uri,value:I.id})}}catch(e){L.e(e)}finally{L.f()}n._mediaObject.rtcpMux="rtcp-mux",n._mediaObject.rtcpRsize="rtcp-rsize";var M=m.encodings[0],A=M.ssrc,N=M.rtx&&M.rtx.ssrc?M.rtx.ssrc:void 0;n._mediaObject.ssrcs=[],n._mediaObject.ssrcGroups=[],m.rtcp.cname&&n._mediaObject.ssrcs.push({id:A,attribute:"cname",value:m.rtcp.cname}),n._planB&&n._mediaObject.ssrcs.push({id:A,attribute:"msid",value:"".concat(v||"-"," ").concat(y)}),N&&(m.rtcp.cname&&n._mediaObject.ssrcs.push({id:N,attribute:"cname",value:m.rtcp.cname}),n._planB&&n._mediaObject.ssrcs.push({id:N,attribute:"msid",value:"".concat(v||"-"," ").concat(y)}),n._mediaObject.ssrcGroups.push({semantics:"FID",ssrcs:"".concat(A," ").concat(N)}));break;case"application":b?(n._mediaObject.payloads=s.port,n._mediaObject.sctpmap={app:"webrtc-datachannel",sctpmapNumber:s.port,maxMessageSize:s.maxMessageSize}):(n._mediaObject.payloads="webrtc-datachannel",n._mediaObject.sctpPort=s.port,n._mediaObject.maxMessageSize=s.maxMessageSize)}return n}return d(r,[{key:"setDtlsRole",value:function(e){this._mediaObject.setup="actpass"}},{key:"resume",value:function(){this._mediaObject.direction="sendonly"}},{key:"planBReceive",value:function(e){var t,r=this,n=e.offerRtpParameters,o=e.streamId,i=e.trackId,a=n.encodings[0],s=a.ssrc,u=a.rtx&&a.rtx.ssrc?a.rtx.ssrc:void 0,p=this._mediaObject.payloads.split(" "),l=c(n.codecs);try{for(l.s();!(t=l.n()).done;){var d=t.value;if(!p.includes(String(d.payloadType))){var f={payload:d.payloadType,codec:_(d),rate:d.clockRate};d.channels>1&&(f.encoding=d.channels),this._mediaObject.rtp.push(f);for(var h={payload:d.payloadType,config:""},m=0,v=Object.keys(d.parameters);m<v.length;m++){var y=v[m];h.config&&(h.config+=";"),h.config+="".concat(y,"=").concat(d.parameters[y])}h.config&&this._mediaObject.fmtp.push(h);var g,b=c(d.rtcpFeedback);try{for(b.s();!(g=b.n()).done;){var w=g.value;this._mediaObject.rtcpFb.push({payload:d.payloadType,type:w.type,subtype:w.parameter})}}catch(e){b.e(e)}finally{b.f()}}}}catch(e){l.e(e)}finally{l.f()}this._mediaObject.payloads+=" ".concat(n.codecs.filter((function(e){return!r._mediaObject.payloads.includes(e.payloadType)})).map((function(e){return e.payloadType})).join(" ")),this._mediaObject.payloads=this._mediaObject.payloads.trim(),n.rtcp.cname&&this._mediaObject.ssrcs.push({id:s,attribute:"cname",value:n.rtcp.cname}),this._mediaObject.ssrcs.push({id:s,attribute:"msid",value:"".concat(o||"-"," ").concat(i)}),u&&(n.rtcp.cname&&this._mediaObject.ssrcs.push({id:u,attribute:"cname",value:n.rtcp.cname}),this._mediaObject.ssrcs.push({id:u,attribute:"msid",value:"".concat(o||"-"," ").concat(i)}),this._mediaObject.ssrcGroups.push({semantics:"FID",ssrcs:"".concat(s," ").concat(u)}))}},{key:"planBStopReceiving",value:function(e){var t=e.offerRtpParameters.encodings[0],r=t.ssrc,n=t.rtx&&t.rtx.ssrc?t.rtx.ssrc:void 0;this._mediaObject.ssrcs=this._mediaObject.ssrcs.filter((function(e){return e.id!==r&&e.id!==n})),n&&(this._mediaObject.ssrcGroups=this._mediaObject.ssrcGroups.filter((function(e){return e.ssrcs!=="".concat(r," ").concat(n)})))}}]),r}(g);function _(e){var t=new RegExp("^(audio|video)/(.+)","i").exec(e.mimeType);if(!t)throw new TypeError("invalid codec.mimeType");return t[2]}t.OfferMediaSection=w},9196:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===n(i)?i:String(i)),o)}var i}var s=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),c=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&s(t,e,r);return c(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.RemoteSdp=void 0;var p=u(r(9652)),l=r(1916),d=r(560),f=new l.Logger("RemoteSdp"),h=function(){function e(t){var r=t.iceParameters,n=t.iceCandidates,o=t.dtlsParameters,i=t.sctpParameters,a=t.plainRtpParameters,s=t.planB,c=void 0!==s&&s;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._mediaSections=[],this._midToIndex=new Map,this._iceParameters=r,this._iceCandidates=n,this._dtlsParameters=o,this._sctpParameters=i,this._plainRtpParameters=a,this._planB=c,this._sdpObject={version:0,origin:{address:"0.0.0.0",ipVer:4,netType:"IN",sessionId:1e4,sessionVersion:0,username:"mediasoup-client"},name:"-",timing:{start:0,stop:0},media:[]},r&&r.iceLite&&(this._sdpObject.icelite="ice-lite"),o){this._sdpObject.msidSemantic={semantic:"WMS",token:"*"};var u=this._dtlsParameters.fingerprints.length;this._sdpObject.fingerprint={type:o.fingerprints[u-1].algorithm,hash:o.fingerprints[u-1].value},this._sdpObject.groups=[{type:"BUNDLE",mids:""}]}a&&(this._sdpObject.origin.address=a.ip,this._sdpObject.origin.ipVer=a.ipVersion)}var t,r;return t=e,r=[{key:"updateIceParameters",value:function(e){f.debug("updateIceParameters() [iceParameters:%o]",e),this._iceParameters=e,this._sdpObject.icelite=e.iceLite?"ice-lite":void 0;var t,r=o(this._mediaSections);try{for(r.s();!(t=r.n()).done;)t.value.setIceParameters(e)}catch(e){r.e(e)}finally{r.f()}}},{key:"updateDtlsRole",value:function(e){f.debug("updateDtlsRole() [role:%s]",e),this._dtlsParameters.role=e;var t,r=o(this._mediaSections);try{for(r.s();!(t=r.n()).done;)t.value.setDtlsRole(e)}catch(e){r.e(e)}finally{r.f()}}},{key:"getNextMediaSectionIdx",value:function(){for(var e=0;e<this._mediaSections.length;++e){var t=this._mediaSections[e];if(t.closed)return{idx:e,reuseMid:t.mid}}return{idx:this._mediaSections.length}}},{key:"send",value:function(e){var t=e.offerMediaObject,r=e.reuseMid,n=e.offerRtpParameters,o=e.answerRtpParameters,i=e.codecOptions,a=e.extmapAllowMixed,s=void 0!==a&&a,c=new d.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,planB:this._planB,offerMediaObject:t,offerRtpParameters:n,answerRtpParameters:o,codecOptions:i,extmapAllowMixed:s});r?this._replaceMediaSection(c,r):this._midToIndex.has(c.mid)?this._replaceMediaSection(c):this._addMediaSection(c)}},{key:"receive",value:function(e){var t,r=e.mid,n=e.kind,o=e.offerRtpParameters,i=e.streamId,a=e.trackId,s=this._midToIndex.get(r);if(void 0!==s&&(t=this._mediaSections[s]),t)t.planBReceive({offerRtpParameters:o,streamId:i,trackId:a}),this._replaceMediaSection(t);else{t=new d.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,planB:this._planB,mid:r,kind:n,offerRtpParameters:o,streamId:i,trackId:a});var c=this._mediaSections.find((function(e){return e.closed}));c?this._replaceMediaSection(t,c.mid):this._addMediaSection(t)}}},{key:"pauseMediaSection",value:function(e){this._findMediaSection(e).pause()}},{key:"resumeSendingMediaSection",value:function(e){this._findMediaSection(e).resume()}},{key:"resumeReceivingMediaSection",value:function(e){this._findMediaSection(e).resume()}},{key:"disableMediaSection",value:function(e){this._findMediaSection(e).disable()}},{key:"closeMediaSection",value:function(e){var t=this._findMediaSection(e);return e===this._firstMid?(f.debug("closeMediaSection() | cannot close first media section, disabling it instead [mid:%s]",e),this.disableMediaSection(e),!1):(t.close(),this._regenerateBundleMids(),!0)}},{key:"muxMediaSectionSimulcast",value:function(e,t){var r=this._findMediaSection(e);r.muxSimulcastStreams(t),this._replaceMediaSection(r)}},{key:"planBStopReceiving",value:function(e){var t=e.mid,r=e.offerRtpParameters,n=this._findMediaSection(t);n.planBStopReceiving({offerRtpParameters:r}),this._replaceMediaSection(n)}},{key:"sendSctpAssociation",value:function(e){var t=e.offerMediaObject,r=new d.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,offerMediaObject:t});this._addMediaSection(r)}},{key:"receiveSctpAssociation",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).oldDataChannelSpec,t=void 0!==e&&e,r=new d.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,mid:"datachannel",kind:"application",oldDataChannelSpec:t});this._addMediaSection(r)}},{key:"getSdp",value:function(){return this._sdpObject.origin.sessionVersion++,p.write(this._sdpObject)}},{key:"_addMediaSection",value:function(e){this._firstMid||(this._firstMid=e.mid),this._mediaSections.push(e),this._midToIndex.set(e.mid,this._mediaSections.length-1),this._sdpObject.media.push(e.getObject()),this._regenerateBundleMids()}},{key:"_replaceMediaSection",value:function(e,t){if("string"==typeof t){var r=this._midToIndex.get(t);if(void 0===r)throw new Error("no media section found for reuseMid '".concat(t,"'"));var n=this._mediaSections[r];this._mediaSections[r]=e,this._midToIndex.delete(n.mid),this._midToIndex.set(e.mid,r),this._sdpObject.media[r]=e.getObject(),this._regenerateBundleMids()}else{var o=this._midToIndex.get(e.mid);if(void 0===o)throw new Error("no media section found with mid '".concat(e.mid,"'"));this._mediaSections[o]=e,this._sdpObject.media[o]=e.getObject()}}},{key:"_findMediaSection",value:function(e){var t=this._midToIndex.get(e);if(void 0===t)throw new Error("no media section found with mid '".concat(e,"'"));return this._mediaSections[t]}},{key:"_regenerateBundleMids",value:function(){this._dtlsParameters&&(this._sdpObject.groups[0].mids=this._mediaSections.filter((function(e){return!e.closed})).map((function(e){return e.mid})).join(" "))}}],r&&a(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.RemoteSdp=h},5388:function(e,t,r){"use strict";function n(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var i=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.applyCodecParameters=t.getCname=t.extractDtlsParameters=t.extractRtpCapabilities=void 0;var c=s(r(9652));t.extractRtpCapabilities=function(e){var t,r=e.sdpObject,o=new Map,i=[],a=!1,s=!1,u=n(r.media);try{for(u.s();!(t=u.n()).done;){var p=t.value,l=p.type;switch(l){case"audio":if(a)continue;a=!0;break;case"video":if(s)continue;s=!0;break;default:continue}var d,f=n(p.rtp);try{for(f.s();!(d=f.n()).done;){var h=d.value,m={kind:l,mimeType:"".concat(l,"/").concat(h.codec),preferredPayloadType:h.payload,clockRate:h.rate,channels:h.encoding,parameters:{},rtcpFeedback:[]};o.set(m.preferredPayloadType,m)}}catch(e){f.e(e)}finally{f.f()}var v,y=n(p.fmtp||[]);try{for(y.s();!(v=y.n()).done;){var g=v.value,b=c.parseParams(g.config),w=o.get(g.payload);w&&(b&&b.hasOwnProperty("profile-level-id")&&(b["profile-level-id"]=String(b["profile-level-id"])),w.parameters=b)}}catch(e){y.e(e)}finally{y.f()}var _,S=n(p.rtcpFb||[]);try{for(S.s();!(_=S.n()).done;){var k=_.value,x={type:k.type,parameter:k.subtype};if(x.parameter||delete x.parameter,"*"!==k.payload){var R=o.get(k.payload);if(!R)continue;R.rtcpFeedback.push(x)}else{var P,C=n(o.values());try{for(C.s();!(P=C.n()).done;){var O=P.value;O.kind!==l||/.+\/rtx$/i.test(O.mimeType)||O.rtcpFeedback.push(x)}}catch(e){C.e(e)}finally{C.f()}}}}catch(e){S.e(e)}finally{S.f()}var E,T=n(p.ext||[]);try{for(T.s();!(E=T.n()).done;){var j=E.value;if(!j["encrypt-uri"]){var D={kind:l,uri:j.uri,preferredId:j.value};i.push(D)}}}catch(e){T.e(e)}finally{T.f()}}}catch(e){u.e(e)}finally{u.f()}return{codecs:Array.from(o.values()),headerExtensions:i}},t.extractDtlsParameters=function(e){var t,r=e.sdpObject,n=r.setup,o=r.fingerprint;if(!n||!o){var i,a,s=(r.media||[]).find((function(e){return 0!==e.port}));s&&(null!==(i=n)&&void 0!==i||(n=s.setup),null!==(a=o)&&void 0!==a||(o=s.fingerprint))}if(!n)throw new Error("no a=setup found at SDP session or media level");if(!o)throw new Error("no a=fingerprint found at SDP session or media level");switch(n){case"active":t="client";break;case"passive":t="server";break;case"actpass":t="auto"}return{role:t,fingerprints:[{algorithm:o.type,value:o.hash}]}},t.getCname=function(e){var t=(e.offerMediaObject.ssrcs||[]).find((function(e){return"cname"===e.attribute}));return t?t.value:""},t.applyCodecParameters=function(e){var t,r=e.offerRtpParameters,o=e.answerMediaObject,i=n(r.codecs);try{var a=function(){var e=t.value,r=e.mimeType.toLowerCase();if("audio/opus"!==r)return 0;if(!(o.rtp||[]).find((function(t){return t.payload===e.payloadType})))return 0;o.fmtp=o.fmtp||[];var n=o.fmtp.find((function(t){return t.payload===e.payloadType}));n||(n={payload:e.payloadType,config:""},o.fmtp.push(n));var i=c.parseParams(n.config);if("audio/opus"===r){var a=e.parameters["sprop-stereo"];void 0!==a&&(i.stereo=a?1:0)}n.config="";for(var s=0,u=Object.keys(i);s<u.length;s++){var p=u[s];n.config&&(n.config+=";"),n.config+="".concat(p,"=").concat(i[p])}};for(i.s();!(t=i.n()).done;)a()}catch(e){i.e(e)}finally{i.f()}}},5156:(e,t)=>{"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||o(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=o(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}function o(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}Object.defineProperty(t,"__esModule",{value:!0}),t.addLegacySimulcast=t.getRtpEncodings=void 0,t.getRtpEncodings=function(e){var t,o,i=e.offerMediaObject,a=e.track,s=new Set,c=n(i.ssrcs||[]);try{for(c.s();!(o=c.n()).done;){var u=o.value;if("msid"===u.attribute&&u.value.split(" ")[1]===a.id){var p=u.id;s.add(p),t||(t=p)}}}catch(e){c.e(e)}finally{c.f()}if(0===s.size)throw new Error("a=ssrc line with msid information not found [track.id:".concat(a.id,"]"));var l,d=new Map,f=n(i.ssrcGroups||[]);try{for(f.s();!(l=f.n()).done;){var h=l.value;if("FID"===h.semantics){var m=r(h.ssrcs.split(/\s+/),2),v=m[0],y=m[1];v=Number(v),y=Number(y),s.has(v)&&(s.delete(v),s.delete(y),d.set(v,y))}}}catch(e){f.e(e)}finally{f.f()}var g,b=n(s);try{for(b.s();!(g=b.n()).done;){var w=g.value;d.set(w,null)}}catch(e){b.e(e)}finally{b.f()}var _,S=[],k=n(d);try{for(k.s();!(_=k.n()).done;){var x=r(_.value,2),R=x[0],P=x[1],C={ssrc:R};P&&(C.rtx={ssrc:P}),S.push(C)}}catch(e){k.e(e)}finally{k.f()}return S},t.addLegacySimulcast=function(e){var t,r,n,o=e.offerMediaObject,i=e.track,a=e.numStreams;if(a<=1)throw new TypeError("numStreams must be greater than 1");if(!(o.ssrcs||[]).find((function(e){return"msid"===e.attribute&&e.value.split(" ")[1]===i.id&&(t=e.id,n=e.value.split(" ")[0],!0)})))throw new Error("a=ssrc line with msid information not found [track.id:".concat(i.id,"]"));(o.ssrcGroups||[]).some((function(e){if("FID"!==e.semantics)return!1;var n=e.ssrcs.split(/\s+/);return Number(n[0])===t&&(r=Number(n[1]),!0)}));var s=o.ssrcs.find((function(e){return"cname"===e.attribute&&e.id===t}));if(!s)throw new Error("a=ssrc line with cname information not found [track.id:".concat(i.id,"]"));for(var c=s.value,u=[],p=[],l=0;l<a;++l)u.push(t+l),r&&p.push(r+l);o.ssrcGroups=o.ssrcGroups||[],o.ssrcs=o.ssrcs||[],o.ssrcGroups.push({semantics:"SIM",ssrcs:u.join(" ")});for(var d=0;d<u.length;++d){var f=u[d];o.ssrcs.push({id:f,attribute:"cname",value:c}),o.ssrcs.push({id:f,attribute:"msid",value:"".concat(n," ").concat(i.id)})}for(var h=0;h<p.length;++h){var m=u[h],v=p[h];o.ssrcs.push({id:v,attribute:"cname",value:c}),o.ssrcs.push({id:v,attribute:"msid",value:"".concat(n," ").concat(i.id)}),o.ssrcGroups.push({semantics:"FID",ssrcs:"".concat(m," ").concat(v)})}}},8538:(e,t)=>{"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||o(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=o(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}function o(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}Object.defineProperty(t,"__esModule",{value:!0}),t.addLegacySimulcast=t.getRtpEncodings=void 0,t.getRtpEncodings=function(e){var t,o=e.offerMediaObject,i=new Set,a=n(o.ssrcs||[]);try{for(a.s();!(t=a.n()).done;){var s=t.value.id;i.add(s)}}catch(e){a.e(e)}finally{a.f()}if(0===i.size)throw new Error("no a=ssrc lines found");var c,u=new Map,p=n(o.ssrcGroups||[]);try{for(p.s();!(c=p.n()).done;){var l=c.value;if("FID"===l.semantics){var d=r(l.ssrcs.split(/\s+/),2),f=d[0],h=d[1];f=Number(f),h=Number(h),i.has(f)&&(i.delete(f),i.delete(h),u.set(f,h))}}}catch(e){p.e(e)}finally{p.f()}var m,v=n(i);try{for(v.s();!(m=v.n()).done;){var y=m.value;u.set(y,null)}}catch(e){v.e(e)}finally{v.f()}var g,b=[],w=n(u);try{for(w.s();!(g=w.n()).done;){var _=r(g.value,2),S=_[0],k=_[1],x={ssrc:S};k&&(x.rtx={ssrc:k}),b.push(x)}}catch(e){w.e(e)}finally{w.f()}return b},t.addLegacySimulcast=function(e){var t=e.offerMediaObject,n=e.numStreams;if(n<=1)throw new TypeError("numStreams must be greater than 1");var o=(t.ssrcs||[]).find((function(e){return"msid"===e.attribute}));if(!o)throw new Error("a=ssrc line with msid information not found");var i,a=r(o.value.split(" "),2),s=a[0],c=a[1],u=o.id;(t.ssrcGroups||[]).some((function(e){if("FID"!==e.semantics)return!1;var t=e.ssrcs.split(/\s+/);return Number(t[0])===u&&(i=Number(t[1]),!0)}));var p=t.ssrcs.find((function(e){return"cname"===e.attribute}));if(!p)throw new Error("a=ssrc line with cname information not found");for(var l=p.value,d=[],f=[],h=0;h<n;++h)d.push(u+h),i&&f.push(i+h);t.ssrcGroups=[],t.ssrcs=[],t.ssrcGroups.push({semantics:"SIM",ssrcs:d.join(" ")});for(var m=0;m<d.length;++m){var v=d[m];t.ssrcs.push({id:v,attribute:"cname",value:l}),t.ssrcs.push({id:v,attribute:"msid",value:"".concat(s," ").concat(c)})}for(var y=0;y<f.length;++y){var g=d[y],b=f[y];t.ssrcs.push({id:b,attribute:"cname",value:l}),t.ssrcs.push({id:b,attribute:"msid",value:"".concat(s," ").concat(c)}),t.ssrcGroups.push({semantics:"FID",ssrcs:"".concat(g," ").concat(b)})}}},1733:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.debug=t.parseScalabilityMode=t.detectDevice=t.Device=t.version=t.types=void 0;var s=a(r(1373));t.debug=s.default;var c=r(8630);Object.defineProperty(t,"Device",{enumerable:!0,get:function(){return c.Device}}),Object.defineProperty(t,"detectDevice",{enumerable:!0,get:function(){return c.detectDevice}});var u=i(r(6087));t.types=u,t.version="3.7.0";var p=r(9975);Object.defineProperty(t,"parseScalabilityMode",{enumerable:!0,get:function(){return p.parse}})},6059:function(e,t,r){"use strict";function n(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}var a=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&a(t,e,r);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.canReceive=t.canSend=t.generateProbatorRtpParameters=t.reduceCodecs=t.getSendingRemoteRtpParameters=t.getSendingRtpParameters=t.getRecvRtpCapabilities=t.getExtendedRtpCapabilities=t.validateSctpStreamParameters=t.validateSctpParameters=t.validateNumSctpStreams=t.validateSctpCapabilities=t.validateRtcpParameters=t.validateRtpEncodingParameters=t.validateRtpHeaderExtensionParameters=t.validateRtpCodecParameters=t.validateRtpParameters=t.validateRtpHeaderExtension=t.validateRtcpFeedback=t.validateRtpCodecCapability=t.validateRtpCapabilities=void 0;var u=c(r(8205)),p=c(r(5234));function l(e){var t=new RegExp("^(audio|video)/(.+)","i");if("object"!==i(e))throw new TypeError("codec is not an object");if(!e.mimeType||"string"!=typeof e.mimeType)throw new TypeError("missing codec.mimeType");var r=t.exec(e.mimeType);if(!r)throw new TypeError("invalid codec.mimeType");if(e.kind=r[1].toLowerCase(),e.preferredPayloadType&&"number"!=typeof e.preferredPayloadType)throw new TypeError("invalid codec.preferredPayloadType");if("number"!=typeof e.clockRate)throw new TypeError("missing codec.clockRate");"audio"===e.kind?"number"!=typeof e.channels&&(e.channels=1):delete e.channels,e.parameters&&"object"===i(e.parameters)||(e.parameters={});for(var o=0,a=Object.keys(e.parameters);o<a.length;o++){var s=a[o],c=e.parameters[s];if(void 0===c&&(e.parameters[s]="",c=""),"string"!=typeof c&&"number"!=typeof c)throw new TypeError("invalid codec parameter [key:".concat(s,"s, value:").concat(c,"]"));if("apt"===s&&"number"!=typeof c)throw new TypeError("invalid codec apt parameter")}e.rtcpFeedback&&Array.isArray(e.rtcpFeedback)||(e.rtcpFeedback=[]);var u,p=n(e.rtcpFeedback);try{for(p.s();!(u=p.n()).done;)d(u.value)}catch(e){p.e(e)}finally{p.f()}}function d(e){if("object"!==i(e))throw new TypeError("fb is not an object");if(!e.type||"string"!=typeof e.type)throw new TypeError("missing fb.type");e.parameter&&"string"==typeof e.parameter||(e.parameter="")}function f(e){if("object"!==i(e))throw new TypeError("ext is not an object");if("audio"!==e.kind&&"video"!==e.kind)throw new TypeError("invalid ext.kind");if(!e.uri||"string"!=typeof e.uri)throw new TypeError("missing ext.uri");if("number"!=typeof e.preferredId)throw new TypeError("missing ext.preferredId");if(e.preferredEncrypt&&"boolean"!=typeof e.preferredEncrypt)throw new TypeError("invalid ext.preferredEncrypt");if(e.preferredEncrypt||(e.preferredEncrypt=!1),e.direction&&"string"!=typeof e.direction)throw new TypeError("invalid ext.direction");e.direction||(e.direction="sendrecv")}function h(e){if("object"!==i(e))throw new TypeError("params is not an object");if(e.mid&&"string"!=typeof e.mid)throw new TypeError("params.mid is not a string");if(!Array.isArray(e.codecs))throw new TypeError("missing params.codecs");var t,r=n(e.codecs);try{for(r.s();!(t=r.n()).done;)m(t.value)}catch(e){r.e(e)}finally{r.f()}if(e.headerExtensions&&!Array.isArray(e.headerExtensions))throw new TypeError("params.headerExtensions is not an array");e.headerExtensions||(e.headerExtensions=[]);var o,a=n(e.headerExtensions);try{for(a.s();!(o=a.n()).done;)v(o.value)}catch(e){a.e(e)}finally{a.f()}if(e.encodings&&!Array.isArray(e.encodings))throw new TypeError("params.encodings is not an array");e.encodings||(e.encodings=[]);var s,c=n(e.encodings);try{for(c.s();!(s=c.n()).done;)y(s.value)}catch(e){c.e(e)}finally{c.f()}if(e.rtcp&&"object"!==i(e.rtcp))throw new TypeError("params.rtcp is not an object");e.rtcp||(e.rtcp={}),g(e.rtcp)}function m(e){var t=new RegExp("^(audio|video)/(.+)","i");if("object"!==i(e))throw new TypeError("codec is not an object");if(!e.mimeType||"string"!=typeof e.mimeType)throw new TypeError("missing codec.mimeType");var r=t.exec(e.mimeType);if(!r)throw new TypeError("invalid codec.mimeType");if("number"!=typeof e.payloadType)throw new TypeError("missing codec.payloadType");if("number"!=typeof e.clockRate)throw new TypeError("missing codec.clockRate");"audio"===r[1].toLowerCase()?"number"!=typeof e.channels&&(e.channels=1):delete e.channels,e.parameters&&"object"===i(e.parameters)||(e.parameters={});for(var o=0,a=Object.keys(e.parameters);o<a.length;o++){var s=a[o],c=e.parameters[s];if(void 0===c&&(e.parameters[s]="",c=""),"string"!=typeof c&&"number"!=typeof c)throw new TypeError("invalid codec parameter [key:".concat(s,"s, value:").concat(c,"]"));if("apt"===s&&"number"!=typeof c)throw new TypeError("invalid codec apt parameter")}e.rtcpFeedback&&Array.isArray(e.rtcpFeedback)||(e.rtcpFeedback=[]);var u,p=n(e.rtcpFeedback);try{for(p.s();!(u=p.n()).done;)d(u.value)}catch(e){p.e(e)}finally{p.f()}}function v(e){if("object"!==i(e))throw new TypeError("ext is not an object");if(!e.uri||"string"!=typeof e.uri)throw new TypeError("missing ext.uri");if("number"!=typeof e.id)throw new TypeError("missing ext.id");if(e.encrypt&&"boolean"!=typeof e.encrypt)throw new TypeError("invalid ext.encrypt");e.encrypt||(e.encrypt=!1),e.parameters&&"object"===i(e.parameters)||(e.parameters={});for(var t=0,r=Object.keys(e.parameters);t<r.length;t++){var n=r[t],o=e.parameters[n];if(void 0===o&&(e.parameters[n]="",o=""),"string"!=typeof o&&"number"!=typeof o)throw new TypeError("invalid header extension parameter")}}function y(e){if("object"!==i(e))throw new TypeError("encoding is not an object");if(e.ssrc&&"number"!=typeof e.ssrc)throw new TypeError("invalid encoding.ssrc");if(e.rid&&"string"!=typeof e.rid)throw new TypeError("invalid encoding.rid");if(e.rtx&&"object"!==i(e.rtx))throw new TypeError("invalid encoding.rtx");if(e.rtx&&"number"!=typeof e.rtx.ssrc)throw new TypeError("missing encoding.rtx.ssrc");if(e.dtx&&"boolean"==typeof e.dtx||(e.dtx=!1),e.scalabilityMode&&"string"!=typeof e.scalabilityMode)throw new TypeError("invalid encoding.scalabilityMode")}function g(e){if("object"!==i(e))throw new TypeError("rtcp is not an object");if(e.cname&&"string"!=typeof e.cname)throw new TypeError("invalid rtcp.cname");e.reducedSize&&"boolean"==typeof e.reducedSize||(e.reducedSize=!0)}function b(e){if("object"!==i(e))throw new TypeError("numStreams is not an object");if("number"!=typeof e.OS)throw new TypeError("missing numStreams.OS");if("number"!=typeof e.MIS)throw new TypeError("missing numStreams.MIS")}function w(e){return!!e&&/.+\/rtx$/i.test(e.mimeType)}function _(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.strict,o=void 0!==n&&n,i=r.modify,a=void 0!==i&&i,s=e.mimeType.toLowerCase();if(s!==t.mimeType.toLowerCase())return!1;if(e.clockRate!==t.clockRate)return!1;if(e.channels!==t.channels)return!1;switch(s){case"video/h264":if(o){var c;if((e.parameters["packetization-mode"]||0)!==(t.parameters["packetization-mode"]||0))return!1;if(!u.isSameProfile(e.parameters,t.parameters))return!1;try{c=u.generateProfileLevelIdForAnswer(e.parameters,t.parameters)}catch(e){return!1}a&&(c?(e.parameters["profile-level-id"]=c,t.parameters["profile-level-id"]=c):(delete e.parameters["profile-level-id"],delete t.parameters["profile-level-id"]))}break;case"video/vp9":if(o&&(e.parameters["profile-id"]||0)!==(t.parameters["profile-id"]||0))return!1}return!0}function S(e,t){var r,o=[],i=n(e.rtcpFeedback||[]);try{var a=function(){var e=r.value,n=(t.rtcpFeedback||[]).find((function(t){return t.type===e.type&&(t.parameter===e.parameter||!t.parameter&&!e.parameter)}));n&&o.push(n)};for(i.s();!(r=i.n()).done;)a()}catch(e){i.e(e)}finally{i.f()}return o}t.validateRtpCapabilities=function(e){if("object"!==i(e))throw new TypeError("caps is not an object");if(e.codecs&&!Array.isArray(e.codecs))throw new TypeError("caps.codecs is not an array");e.codecs||(e.codecs=[]);var t,r=n(e.codecs);try{for(r.s();!(t=r.n()).done;)l(t.value)}catch(e){r.e(e)}finally{r.f()}if(e.headerExtensions&&!Array.isArray(e.headerExtensions))throw new TypeError("caps.headerExtensions is not an array");e.headerExtensions||(e.headerExtensions=[]);var o,a=n(e.headerExtensions);try{for(a.s();!(o=a.n()).done;)f(o.value)}catch(e){a.e(e)}finally{a.f()}},t.validateRtpCodecCapability=l,t.validateRtcpFeedback=d,t.validateRtpHeaderExtension=f,t.validateRtpParameters=h,t.validateRtpCodecParameters=m,t.validateRtpHeaderExtensionParameters=v,t.validateRtpEncodingParameters=y,t.validateRtcpParameters=g,t.validateSctpCapabilities=function(e){if("object"!==i(e))throw new TypeError("caps is not an object");if(!e.numStreams||"object"!==i(e.numStreams))throw new TypeError("missing caps.numStreams");b(e.numStreams)},t.validateNumSctpStreams=b,t.validateSctpParameters=function(e){if("object"!==i(e))throw new TypeError("params is not an object");if("number"!=typeof e.port)throw new TypeError("missing params.port");if("number"!=typeof e.OS)throw new TypeError("missing params.OS");if("number"!=typeof e.MIS)throw new TypeError("missing params.MIS");if("number"!=typeof e.maxMessageSize)throw new TypeError("missing params.maxMessageSize")},t.validateSctpStreamParameters=function(e){if("object"!==i(e))throw new TypeError("params is not an object");if("number"!=typeof e.streamId)throw new TypeError("missing params.streamId");var t=!1;if("boolean"==typeof e.ordered?t=!0:e.ordered=!0,e.maxPacketLifeTime&&"number"!=typeof e.maxPacketLifeTime)throw new TypeError("invalid params.maxPacketLifeTime");if(e.maxRetransmits&&"number"!=typeof e.maxRetransmits)throw new TypeError("invalid params.maxRetransmits");if(e.maxPacketLifeTime&&e.maxRetransmits)throw new TypeError("cannot provide both maxPacketLifeTime and maxRetransmits");if(t&&e.ordered&&(e.maxPacketLifeTime||e.maxRetransmits))throw new TypeError("cannot be ordered with maxPacketLifeTime or maxRetransmits");if(t||!e.maxPacketLifeTime&&!e.maxRetransmits||(e.ordered=!1),e.label&&"string"!=typeof e.label)throw new TypeError("invalid params.label");if(e.protocol&&"string"!=typeof e.protocol)throw new TypeError("invalid params.protocol")},t.getExtendedRtpCapabilities=function(e,t){var r,o={codecs:[],headerExtensions:[]},i=n(t.codecs||[]);try{var a=function(){var t=r.value;if(w(t))return 0;var n=(e.codecs||[]).find((function(e){return _(e,t,{strict:!0,modify:!0})}));if(!n)return 0;var i={mimeType:n.mimeType,kind:n.kind,clockRate:n.clockRate,channels:n.channels,localPayloadType:n.preferredPayloadType,localRtxPayloadType:void 0,remotePayloadType:t.preferredPayloadType,remoteRtxPayloadType:void 0,localParameters:n.parameters,remoteParameters:t.parameters,rtcpFeedback:S(n,t)};o.codecs.push(i)};for(i.s();!(r=i.n()).done;)a()}catch(e){i.e(e)}finally{i.f()}var s,c=n(o.codecs);try{var u=function(){var r=s.value,n=e.codecs.find((function(e){return w(e)&&e.parameters.apt===r.localPayloadType})),o=t.codecs.find((function(e){return w(e)&&e.parameters.apt===r.remotePayloadType}));n&&o&&(r.localRtxPayloadType=n.preferredPayloadType,r.remoteRtxPayloadType=o.preferredPayloadType)};for(c.s();!(s=c.n()).done;)u()}catch(e){c.e(e)}finally{c.f()}var p,l=n(t.headerExtensions);try{var d=function(){var t=p.value,r=e.headerExtensions.find((function(e){return n=t,!((r=e).kind&&n.kind&&r.kind!==n.kind||r.uri!==n.uri);var r,n}));if(!r)return 1;var n={kind:t.kind,uri:t.uri,sendId:r.preferredId,recvId:t.preferredId,encrypt:r.preferredEncrypt,direction:"sendrecv"};switch(t.direction){case"sendrecv":n.direction="sendrecv";break;case"recvonly":n.direction="sendonly";break;case"sendonly":n.direction="recvonly";break;case"inactive":n.direction="inactive"}o.headerExtensions.push(n)};for(l.s();!(p=l.n()).done;)d()}catch(e){l.e(e)}finally{l.f()}return o},t.getRecvRtpCapabilities=function(e){var t,r={codecs:[],headerExtensions:[]},o=n(e.codecs);try{for(o.s();!(t=o.n()).done;){var i=t.value,a={mimeType:i.mimeType,kind:i.kind,preferredPayloadType:i.remotePayloadType,clockRate:i.clockRate,channels:i.channels,parameters:i.localParameters,rtcpFeedback:i.rtcpFeedback};if(r.codecs.push(a),i.remoteRtxPayloadType){var s={mimeType:"".concat(i.kind,"/rtx"),kind:i.kind,preferredPayloadType:i.remoteRtxPayloadType,clockRate:i.clockRate,parameters:{apt:i.remotePayloadType},rtcpFeedback:[]};r.codecs.push(s)}}}catch(e){o.e(e)}finally{o.f()}var c,u=n(e.headerExtensions);try{for(u.s();!(c=u.n()).done;){var p=c.value;if("sendrecv"===p.direction||"recvonly"===p.direction){var l={kind:p.kind,uri:p.uri,preferredId:p.recvId,preferredEncrypt:p.encrypt,direction:p.direction};r.headerExtensions.push(l)}}}catch(e){u.e(e)}finally{u.f()}return r},t.getSendingRtpParameters=function(e,t){var r,o={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}},i=n(t.codecs);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a.kind===e){var s={mimeType:a.mimeType,payloadType:a.localPayloadType,clockRate:a.clockRate,channels:a.channels,parameters:a.localParameters,rtcpFeedback:a.rtcpFeedback};if(o.codecs.push(s),a.localRtxPayloadType){var c={mimeType:"".concat(a.kind,"/rtx"),payloadType:a.localRtxPayloadType,clockRate:a.clockRate,parameters:{apt:a.localPayloadType},rtcpFeedback:[]};o.codecs.push(c)}}}}catch(e){i.e(e)}finally{i.f()}var u,p=n(t.headerExtensions);try{for(p.s();!(u=p.n()).done;){var l=u.value;if(!(l.kind&&l.kind!==e||"sendrecv"!==l.direction&&"sendonly"!==l.direction)){var d={uri:l.uri,id:l.sendId,encrypt:l.encrypt,parameters:{}};o.headerExtensions.push(d)}}}catch(e){p.e(e)}finally{p.f()}return o},t.getSendingRemoteRtpParameters=function(e,t){var r,o={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}},i=n(t.codecs);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a.kind===e){var s={mimeType:a.mimeType,payloadType:a.localPayloadType,clockRate:a.clockRate,channels:a.channels,parameters:a.remoteParameters,rtcpFeedback:a.rtcpFeedback};if(o.codecs.push(s),a.localRtxPayloadType){var c={mimeType:"".concat(a.kind,"/rtx"),payloadType:a.localRtxPayloadType,clockRate:a.clockRate,parameters:{apt:a.localPayloadType},rtcpFeedback:[]};o.codecs.push(c)}}}}catch(e){i.e(e)}finally{i.f()}var u,p=n(t.headerExtensions);try{for(p.s();!(u=p.n()).done;){var l=u.value;if(!(l.kind&&l.kind!==e||"sendrecv"!==l.direction&&"sendonly"!==l.direction)){var d={uri:l.uri,id:l.sendId,encrypt:l.encrypt,parameters:{}};o.headerExtensions.push(d)}}}catch(e){p.e(e)}finally{p.f()}if(o.headerExtensions.some((function(e){return"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===e.uri}))){var f,h=n(o.codecs);try{for(h.s();!(f=h.n()).done;){var m=f.value;m.rtcpFeedback=(m.rtcpFeedback||[]).filter((function(e){return"goog-remb"!==e.type}))}}catch(e){h.e(e)}finally{h.f()}}else if(o.headerExtensions.some((function(e){return"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"===e.uri}))){var v,y=n(o.codecs);try{for(y.s();!(v=y.n()).done;){var g=v.value;g.rtcpFeedback=(g.rtcpFeedback||[]).filter((function(e){return"transport-cc"!==e.type}))}}catch(e){y.e(e)}finally{y.f()}}else{var b,w=n(o.codecs);try{for(w.s();!(b=w.n()).done;){var _=b.value;_.rtcpFeedback=(_.rtcpFeedback||[]).filter((function(e){return"transport-cc"!==e.type&&"goog-remb"!==e.type}))}}catch(e){w.e(e)}finally{w.f()}}return o},t.reduceCodecs=function(e,t){var r=[];if(t){for(var n=0;n<e.length;++n)if(_(e[n],t)){r.push(e[n]),w(e[n+1])&&r.push(e[n+1]);break}if(0===r.length)throw new TypeError("no matching codec found")}else r.push(e[0]),w(e[1])&&r.push(e[1]);return r},t.generateProbatorRtpParameters=function(e){h(e=p.clone(e));var t={mid:"probator",codecs:[],headerExtensions:[],encodings:[{ssrc:1234}],rtcp:{cname:"probator"}};return t.codecs.push(e.codecs[0]),t.codecs[0].payloadType=127,t.headerExtensions=e.headerExtensions,t},t.canSend=function(e,t){return t.codecs.some((function(t){return t.kind===e}))},t.canReceive=function(e,t){if(h(e),0===e.codecs.length)return!1;var r=e.codecs[0];return t.codecs.some((function(e){return e.remotePayloadType===r.payloadType}))}},9975:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parse=void 0;var r=new RegExp("^[LS]([1-9]\\d{0,1})T([1-9]\\d{0,1})");t.parse=function(e){var t=r.exec(e||"");return t?{spatialLayers:Number(t[1]),temporalLayers:Number(t[2])}:{spatialLayers:1,temporalLayers:1}}},6087:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(8630),t),o(r(2683),t),o(r(4791),t),o(r(9113),t),o(r(6487),t),o(r(6503),t),o(r(7562),t),o(r(5987),t),o(r(1144),t),o(r(6020),t)},5234:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateRandomNumber=t.clone=void 0,t.clone=function(e){return void 0===e?void 0:Number.isNaN(e)?NaN:"function"==typeof structuredClone?structuredClone(e):JSON.parse(JSON.stringify(e))},t.generateRandomNumber=function(){return Math.round(1e7*Math.random())}},9622:e=>{function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}var r=1e3,n=60*r,o=60*n,i=24*o;function a(e,t,r,n){var o=t>=1.5*r;return Math.round(e/r)+" "+n+(o?"s":"")}e.exports=function(e,s){s=s||{};var c,u,p=t(e);if("string"===p&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var a=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"weeks":case"week":case"w":return 6048e5*a;case"days":case"day":case"d":return a*i;case"hours":case"hour":case"hrs":case"hr":case"h":return a*o;case"minutes":case"minute":case"mins":case"min":case"m":return a*n;case"seconds":case"second":case"secs":case"sec":case"s":return a*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}(e);if("number"===p&&isFinite(e))return s.long?(c=e,(u=Math.abs(c))>=i?a(c,u,i,"day"):u>=o?a(c,u,o,"hour"):u>=n?a(c,u,n,"minute"):u>=r?a(c,u,r,"second"):c+" ms"):function(e){var t=Math.abs(e);return t>=i?Math.round(e/i)+"d":t>=o?Math.round(e/o)+"h":t>=n?Math.round(e/n)+"m":t>=r?Math.round(e/r)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},4641:(e,t)=>{t.encode=function(e){var t="";for(var r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t},t.decode=function(e){for(var t={},r=e.split("&"),n=0,o=r.length;n<o;n++){var i=r[n].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}},5276:e=>{var t=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var n,o,i=e,a=e.indexOf("["),s=e.indexOf("]");-1!=a&&-1!=s&&(e=e.substring(0,a)+e.substring(a,s).replace(/:/g,";")+e.substring(s,e.length));for(var c,u,p=t.exec(e||""),l={},d=14;d--;)l[r[d]]=p[d]||"";return-1!=a&&-1!=s&&(l.source=i,l.host=l.host.substring(1,l.host.length-1).replace(/;/g,":"),l.authority=l.authority.replace("[","").replace("]","").replace(/;/g,":"),l.ipv6uri=!0),l.pathNames=(n=l.path,o=n.replace(/\/{2,9}/g,"/").split("/"),"/"!=n.substr(0,1)&&0!==n.length||o.splice(0,1),"/"==n.substr(n.length-1,1)&&o.splice(o.length-1,1),o),l.queryKey=(c=l.query,u={},c.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,r){t&&(u[t]=r)})),u),l}},5110:(e,t,r)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(){"use strict";o=function(){return t};var e,t={},r=Object.prototype,i=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",p=s.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof b?t:b,i=Object.create(o.prototype),s=new D(n||[]);return a(i,"_invoke",{value:O(e,r,s)}),i}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var h="suspendedStart",m="suspendedYield",v="executing",y="completed",g={};function b(){}function w(){}function _(){}var S={};l(S,c,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(L([])));x&&x!==r&&i.call(x,c)&&(S=x);var R=_.prototype=b.prototype=Object.create(S);function P(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(o,a,s,c){var u=f(e[o],e,a);if("throw"!==u.type){var p=u.arg,l=p.value;return l&&"object"==n(l)&&i.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):t.resolve(l).then((function(e){p.value=e,s(p)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var o;a(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var o=h;return function(i,a){if(o===v)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=E(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?y:m,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function E(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,E(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(i.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(n(t)+" is not iterable")}return w.prototype=_,a(R,"constructor",{value:_,configurable:!0}),a(_,"constructor",{value:w,configurable:!0}),w.displayName=l(_,p,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,l(e,p,"GeneratorFunction")),e.prototype=Object.create(R),e},t.awrap=function(e){return{__await:e}},P(C.prototype),l(C.prototype,u,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new C(d(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},P(R),l(R,p,"Generator"),l(R,c,(function(){return this})),l(R,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function i(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function a(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===n(i)?i:String(i)),o)}var i}function s(e,t){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},s(e,t)}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}var u=r(5090).EventEmitter,p=r(862),l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(m,e);var t,r,u,l,d,f,h=(d=m,f=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=c(d);if(f){var r=c(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function m(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m),(t=h.call(this)).setMaxListeners(1/0),t._logger=e||new p("EnhancedEventEmitter"),t}return t=m,r=[{key:"safeEmit",value:function(e){try{for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];this.emit.apply(this,[e].concat(r))}catch(t){this._logger.error("safeEmit() | event listener threw an error [event:%s]:%o",e,t)}}},{key:"safeEmitAsPromise",value:(u=o().mark((function e(t){var r,n,i,a=this,s=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=s.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=s[i];return e.abrupt("return",new Promise((function(e,r){a.safeEmit.apply(a,[t].concat(n,[e,r]))})));case 2:case"end":return e.stop()}}),e)})),l=function(){var e=this,t=arguments;return new Promise((function(r,n){var o=u.apply(e,t);function a(e){i(o,r,n,a,s,"next",e)}function s(e){i(o,r,n,a,s,"throw",e)}a(void 0)}))},function(e){return l.apply(this,arguments)})}],r&&a(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),m}(u);e.exports=l},862:(e,t,r)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===n(i)?i:String(i)),o)}var i}var i=r(1373),a="protoo-client",s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t?(this._debug=i("".concat(a,":").concat(t)),this._warn=i("".concat(a,":WARN:").concat(t)),this._error=i("".concat(a,":ERROR:").concat(t))):(this._debug=i(a),this._warn=i("".concat(a,":WARN")),this._error=i("".concat(a,":ERROR"))),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}var t,r;return t=e,(r=[{key:"debug",get:function(){return this._debug}},{key:"warn",get:function(){return this._warn}},{key:"error",get:function(){return this._error}}])&&o(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();e.exports=s},4715:(e,t,r)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===n(i)?i:String(i)),o)}var i}var i=r(862),a=r(477).generateRandomNumber,s=new i("Message"),c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r;return t=e,r=[{key:"parse",value:function(e){var t,r={};try{t=JSON.parse(e)}catch(e){return void s.error("parse() | invalid JSON: %s",e)}if("object"===n(t)&&!Array.isArray(t)){if(t.request){if(r.request=!0,"string"!=typeof t.method)return void s.error("parse() | missing/invalid method field");if("number"!=typeof t.id)return void s.error("parse() | missing/invalid id field");r.id=t.id,r.method=t.method,r.data=t.data||{}}else if(t.response){if(r.response=!0,"number"!=typeof t.id)return void s.error("parse() | missing/invalid id field");r.id=t.id,t.ok?(r.ok=!0,r.data=t.data||{}):(r.ok=!1,r.errorCode=t.errorCode,r.errorReason=t.errorReason)}else{if(!t.notification)return void s.error("parse() | missing request/response field");if(r.notification=!0,"string"!=typeof t.method)return void s.error("parse() | missing/invalid method field");r.method=t.method,r.data=t.data||{}}return r}s.error("parse() | not an object")}},{key:"createRequest",value:function(e,t){return{request:!0,id:a(),method:e,data:t||{}}}},{key:"createSuccessResponse",value:function(e,t){return{response:!0,id:e.id,ok:!0,data:t||{}}}},{key:"createErrorResponse",value:function(e,t,r){return{response:!0,id:e.id,ok:!1,errorCode:t,errorReason:r}}},{key:"createNotification",value:function(e,t){return{notification:!0,method:e,data:t||{}}}}],null&&o(t.prototype,null),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();e.exports=c},1123:(e,t,r)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(){"use strict";o=function(){return t};var e,t={},r=Object.prototype,i=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",p=s.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof b?t:b,i=Object.create(o.prototype),s=new D(n||[]);return a(i,"_invoke",{value:O(e,r,s)}),i}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var h="suspendedStart",m="suspendedYield",v="executing",y="completed",g={};function b(){}function w(){}function _(){}var S={};l(S,c,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(L([])));x&&x!==r&&i.call(x,c)&&(S=x);var R=_.prototype=b.prototype=Object.create(S);function P(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(o,a,s,c){var u=f(e[o],e,a);if("throw"!==u.type){var p=u.arg,l=p.value;return l&&"object"==n(l)&&i.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):t.resolve(l).then((function(e){p.value=e,s(p)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var o;a(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var o=h;return function(i,a){if(o===v)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=E(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?y:m,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function E(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,E(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(i.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(n(t)+" is not iterable")}return w.prototype=_,a(R,"constructor",{value:_,configurable:!0}),a(_,"constructor",{value:w,configurable:!0}),w.displayName=l(_,p,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,l(e,p,"GeneratorFunction")),e.prototype=Object.create(R),e},t.awrap=function(e){return{__await:e}},P(C.prototype),l(C.prototype,u,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new C(d(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},P(R),l(R,p,"Generator"),l(R,c,(function(){return this})),l(R,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function i(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function a(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function s(e){i(a,n,o,s,c,"next",e)}function c(e){i(a,n,o,s,c,"throw",e)}s(void 0)}))}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===n(i)?i:String(i)),o)}var i}function u(e,t){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},u(e,t)}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}var l=r(862),d=r(5110),f=r(4715),h=new l("Peer"),m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(y,e);var t,r,i,l,d,m,v=(d=y,m=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=p(d);if(m){var r=p(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function y(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y),t=v.call(this,h),h.debug("constructor()"),t._closed=!1,t._transport=e,t._connected=!1,t._data={},t._sents=new Map,t._handleTransport(),t}return t=y,r=[{key:"closed",get:function(){return this._closed}},{key:"connected",get:function(){return this._connected}},{key:"data",get:function(){return this._data},set:function(e){throw new Error("cannot override data object")}},{key:"close",value:function(){if(!this._closed){h.debug("close()"),this._closed=!0,this._connected=!1,this._transport.close();var e,t=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw i}}}}(this._sents.values());try{for(t.s();!(e=t.n()).done;)e.value.close()}catch(e){t.e(e)}finally{t.f()}this.safeEmit("close")}}},{key:"request",value:(l=a(o().mark((function e(t){var r,n,i=this,a=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>1&&void 0!==a[1]?a[1]:void 0,n=f.createRequest(t,r),this._logger.debug("request() [method:%s, id:%s]",t,n.id),e.next=5,this._transport.send(n);case 5:return e.abrupt("return",new Promise((function(e,t){var r=1500*(15+.1*i._sents.size),o={id:n.id,method:n.method,resolve:function(t){i._sents.delete(n.id)&&(clearTimeout(o.timer),e(t))},reject:function(e){i._sents.delete(n.id)&&(clearTimeout(o.timer),t(e))},timer:setTimeout((function(){i._sents.delete(n.id)&&t(new Error("request timeout"))}),r),close:function(){clearTimeout(o.timer),t(new Error("peer closed"))}};i._sents.set(n.id,o)})));case 6:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"notify",value:(i=a(o().mark((function e(t){var r,n,i=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:void 0,n=f.createNotification(t,r),this._logger.debug("notify() [method:%s]",t),e.next=5,this._transport.send(n);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"_handleTransport",value:function(){var e=this;if(this._transport.closed)return this._closed=!0,void setTimeout((function(){e._closed||(e._connected=!1,e.safeEmit("close"))}));this._transport.on("open",(function(){e._closed||(h.debug('emit "open"'),e._connected=!0,e.safeEmit("open"))})),this._transport.on("disconnected",(function(){e._closed||(h.debug('emit "disconnected"'),e._connected=!1,e.safeEmit("disconnected"))})),this._transport.on("failed",(function(t){e._closed||(h.debug('emit "failed" [currentAttempt:%s]',t),e._connected=!1,e.safeEmit("failed",t))})),this._transport.on("close",(function(){e._closed||(e._closed=!0,h.debug('emit "close"'),e._connected=!1,e.safeEmit("close"))})),this._transport.on("message",(function(t){t.request?e._handleRequest(t):t.response?e._handleResponse(t):t.notification&&e._handleNotification(t)}))}},{key:"_handleRequest",value:function(e){var t=this;try{this.emit("request",e,(function(r){var n=f.createSuccessResponse(e,r);t._transport.send(n).catch((function(){}))}),(function(r,n){r instanceof Error?(n=r.message,r=500):"number"==typeof r&&n instanceof Error&&(n=n.message);var o=f.createErrorResponse(e,r,n);t._transport.send(o).catch((function(){}))}))}catch(t){var r=f.createErrorResponse(e,500,String(t));this._transport.send(r).catch((function(){}))}}},{key:"_handleResponse",value:function(e){var t=this._sents.get(e.id);if(t)if(e.ok)t.resolve(e.data);else{var r=new Error(e.errorReason);r.code=e.errorCode,t.reject(r)}else h.error("received response does not match any sent request [id:%s]",e.id)}},{key:"_handleNotification",value:function(e){this.safeEmit("notification",e)}}],r&&c(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),y}(d);e.exports=m},5522:(e,t,r)=>{r(7002).version;var n=r(1123),o=r(4801);t._z=n,t.qo=o},4801:(e,t,r)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(){"use strict";o=function(){return t};var e,t={},r=Object.prototype,i=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",p=s.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof b?t:b,i=Object.create(o.prototype),s=new D(n||[]);return a(i,"_invoke",{value:O(e,r,s)}),i}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var h="suspendedStart",m="suspendedYield",v="executing",y="completed",g={};function b(){}function w(){}function _(){}var S={};l(S,c,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(L([])));x&&x!==r&&i.call(x,c)&&(S=x);var R=_.prototype=b.prototype=Object.create(S);function P(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(o,a,s,c){var u=f(e[o],e,a);if("throw"!==u.type){var p=u.arg,l=p.value;return l&&"object"==n(l)&&i.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):t.resolve(l).then((function(e){p.value=e,s(p)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var o;a(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var o=h;return function(i,a){if(o===v)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=E(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?y:m,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function E(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,E(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(i.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(n(t)+" is not iterable")}return w.prototype=_,a(R,"constructor",{value:_,configurable:!0}),a(_,"constructor",{value:w,configurable:!0}),w.displayName=l(_,p,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,l(e,p,"GeneratorFunction")),e.prototype=Object.create(R),e},t.awrap=function(e){return{__await:e}},P(C.prototype),l(C.prototype,u,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new C(d(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},P(R),l(R,p,"Generator"),l(R,c,(function(){return this})),l(R,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function i(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function a(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===n(i)?i:String(i)),o)}var i}function s(e,t){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},s(e,t)}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}var u=r(7444).w3cwebsocket,p=r(2643),l=r(862),d=r(5110),f=r(4715),h={retries:10,factor:2,minTimeout:1e3,maxTimeout:8e3},m=new l("WebSocketTransport"),v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(b,e);var t,r,l,d,v,y,g=(v=b,y=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=c(v);if(y){var r=c(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function b(e,t){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,b),r=g.call(this,m),m.debug("constructor() [url:%s, options:%o]",e,t),r._closed=!1,r._url=e,r._options=t||{},r._ws=null,r._runWebSocket(),r}return t=b,r=[{key:"closed",get:function(){return this._closed}},{key:"close",value:function(){if(!this._closed){m.debug("close()"),this._closed=!0,this.safeEmit("close");try{this._ws.onopen=null,this._ws.onclose=null,this._ws.onerror=null,this._ws.onmessage=null,this._ws.close()}catch(e){m.error("close() | error closing the WebSocket: %o",e)}}}},{key:"send",value:(l=o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._closed){e.next=2;break}throw new Error("transport closed");case 2:e.prev=2,this._ws.send(JSON.stringify(t)),e.next=10;break;case 6:throw e.prev=6,e.t0=e.catch(2),m.warn("send() failed:%o",e.t0),e.t0;case 10:case"end":return e.stop()}}),e,this,[[2,6]])})),d=function(){var e=this,t=arguments;return new Promise((function(r,n){var o=l.apply(e,t);function a(e){i(o,r,n,a,s,"next",e)}function s(e){i(o,r,n,a,s,"throw",e)}a(void 0)}))},function(e){return d.apply(this,arguments)})},{key:"_runWebSocket",value:function(){var e=this,t=p.operation(this._options.retry||h),r=!1;t.attempt((function(n){e._closed?t.stop():(m.debug("_runWebSocket() [currentAttempt:%s]",n),e._ws=new u(e._url,"protoo",e._options.origin,e._options.headers,e._options.requestOptions,e._options.clientConfig),e._ws.onopen=function(){e._closed||(r=!0,e.safeEmit("open"))},e._ws.onclose=function(o){if(!e._closed){if(m.warn('WebSocket "close" event [wasClean:%s, code:%s, reason:"%s"]',o.wasClean,o.code,o.reason),4e3!==o.code){if(r){if(t.stop(),e.safeEmit("disconnected"),e._closed)return;return void e._runWebSocket()}if(e.safeEmit("failed",n),e._closed)return;if(t.retry(!0))return}e._closed=!0,e.safeEmit("close")}},e._ws.onerror=function(){e._closed||m.error('WebSocket "error" event')},e._ws.onmessage=function(t){if(!e._closed){var r=f.parse(t.data);r&&(0!==e.listenerCount("message")?e.safeEmit("message",r):m.error('no listeners for WebSocket "message" event, ignoring received message'))}})}))}}],r&&a(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),b}(d);e.exports=v},477:(e,t)=>{t.generateRandomNumber=function(){return Math.round(1e7*Math.random())}},2643:(e,t,r)=>{e.exports=r(6828)},6828:(e,t,r)=>{var n=r(7389);t.operation=function(e){var r=t.timeouts(e);return new n(r,{forever:e&&e.forever,unref:e&&e.unref,maxRetryTime:e&&e.maxRetryTime})},t.timeouts=function(e){if(e instanceof Array)return[].concat(e);var t={retries:10,factor:2,minTimeout:1e3,maxTimeout:1/0,randomize:!1};for(var r in e)t[r]=e[r];if(t.minTimeout>t.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var n=[],o=0;o<t.retries;o++)n.push(this.createTimeout(o,t));return e&&e.forever&&!n.length&&n.push(this.createTimeout(o,t)),n.sort((function(e,t){return e-t})),n},t.createTimeout=function(e,t){var r=t.randomize?Math.random()+1:1,n=Math.round(r*t.minTimeout*Math.pow(t.factor,e));return Math.min(n,t.maxTimeout)},t.wrap=function(e,r,n){if(r instanceof Array&&(n=r,r=null),!n)for(var o in n=[],e)"function"==typeof e[o]&&n.push(o);for(var i=0;i<n.length;i++){var a=n[i],s=e[a];e[a]=function(n){var o=t.operation(r),i=Array.prototype.slice.call(arguments,1),a=i.pop();i.push((function(e){o.retry(e)||(e&&(arguments[0]=o.mainError()),a.apply(this,arguments))})),o.attempt((function(){n.apply(e,i)}))}.bind(e,s),e[a].options=r}}},7389:e=>{function t(e,t){"boolean"==typeof t&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}e.exports=t,t.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts},t.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timeouts=[],this._cachedTimeouts=null},t.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=(new Date).getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var r=this._timeouts.shift();if(void 0===r){if(!this._cachedTimeouts)return!1;this._errors.splice(this._errors.length-1,this._errors.length),this._timeouts=this._cachedTimeouts.slice(0),r=this._timeouts.shift()}var n=this,o=setTimeout((function(){n._attempts++,n._operationTimeoutCb&&(n._timeout=setTimeout((function(){n._operationTimeoutCb(n._attempts)}),n._operationTimeout),n._options.unref&&n._timeout.unref()),n._fn(n._attempts)}),r);return this._options.unref&&o.unref(),!0},t.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout((function(){r._operationTimeoutCb()}),r._operationTimeout)),this._operationStart=(new Date).getTime(),this._fn(this._attempts)},t.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},t.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},t.prototype.start=t.prototype.try,t.prototype.errors=function(){return this._errors},t.prototype.attempts=function(){return this._attempts},t.prototype.mainError=function(){if(0===this._errors.length)return null;for(var e={},t=null,r=0,n=0;n<this._errors.length;n++){var o=this._errors[n],i=o.message,a=(e[i]||0)+1;e[i]=a,a>=r&&(t=o,r=a)}return t}},6497:(e,t,r)=>{var n;e.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:r.g):function(e){return(n||(n=Promise.resolve())).then(e).catch((function(e){return setTimeout((function(){throw e}),0)}))}},7513:(e,t,r)=>{"use strict";function n(){return n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},n.apply(this,arguments)}var o=r(3074);function i(e,t,r,n,i){var a=o.writeRtpDescription(e.kind,t);if(a+=o.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=o.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":i||"active"),a+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?a+="a=sendrecv\r\n":e.rtpSender?a+="a=sendonly\r\n":e.rtpReceiver?a+="a=recvonly\r\n":a+="a=inactive\r\n",e.rtpSender){var s=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=s;var c="msid:"+(n?n.id:"-")+" "+s+"\r\n";a+="a="+c,a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+c,e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+c,a+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+o.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+o.localCName+"\r\n"),a}function a(e,t){var r={codecs:[],headerExtensions:[],fecMechanisms:[]},n=function(e,t){e=parseInt(e,10);for(var r=0;r<t.length;r++)if(t[r].payloadType===e||t[r].preferredPayloadType===e)return t[r]},o=function(e,t,r,o){var i=n(e.parameters.apt,r),a=n(t.parameters.apt,o);return i&&a&&i.name.toLowerCase()===a.name.toLowerCase()};return e.codecs.forEach((function(n){for(var i=0;i<t.codecs.length;i++){var a=t.codecs[i];if(n.name.toLowerCase()===a.name.toLowerCase()&&n.clockRate===a.clockRate){if("rtx"===n.name.toLowerCase()&&n.parameters&&a.parameters.apt&&!o(n,a,e.codecs,t.codecs))continue;(a=JSON.parse(JSON.stringify(a))).numChannels=Math.min(n.numChannels,a.numChannels),r.codecs.push(a),a.rtcpFeedback=a.rtcpFeedback.filter((function(e){for(var t=0;t<n.rtcpFeedback.length;t++)if(n.rtcpFeedback[t].type===e.type&&n.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var n=0;n<t.headerExtensions.length;n++){var o=t.headerExtensions[n];if(e.uri===o.uri){r.headerExtensions.push(o);break}}})),r}function s(e,t,r){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(r)}function c(e,t){var r=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return r||e.addRemoteCandidate(t),!r}function u(e,t){var r=new Error(t);return r.name=e,r.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],r}e.exports=function(e,t){function r(t,r){r.addTrack(t),r.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function p(t,r,n,o){var i=new Event("track");i.track=r,i.receiver=n,i.transceiver={receiver:n},i.streams=o,e.setTimeout((function(){t._dispatchEvent("track",i)}))}var l=function(r){var n=this,i=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){n[e]=i[e].bind(i)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",r=JSON.parse(JSON.stringify(r||{})),this.usingBundle="max-bundle"===r.bundlePolicy,"negotiate"===r.rtcpMuxPolicy)throw u("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(r.rtcpMuxPolicy||(r.rtcpMuxPolicy="require"),r.iceTransportPolicy){case"all":case"relay":break;default:r.iceTransportPolicy="all"}switch(r.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:r.bundlePolicy="balanced"}if(r.iceServers=function(e,t){var r=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var n=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var o="string"==typeof n;return o&&(n=[n]),n=n.filter((function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||r?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(r=!0,!0)})),delete e.url,e.urls=o?n[0]:n,!!n.length}}))}(r.iceServers||[],t),this._iceGatherers=[],r.iceCandidatePoolSize)for(var a=r.iceCandidatePoolSize;a>0;a--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:r.iceServers,gatherPolicy:r.iceTransportPolicy}));else r.iceCandidatePoolSize=0;this._config=r,this.transceivers=[],this._sdpSessionId=o.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(l.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(l.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),l.prototype.onicecandidate=null,l.prototype.onaddstream=null,l.prototype.ontrack=null,l.prototype.onremovestream=null,l.prototype.onsignalingstatechange=null,l.prototype.oniceconnectionstatechange=null,l.prototype.onconnectionstatechange=null,l.prototype.onicegatheringstatechange=null,l.prototype.onnegotiationneeded=null,l.prototype.ondatachannel=null,l.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},l.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},l.prototype.getConfiguration=function(){return this._config},l.prototype.getLocalStreams=function(){return this.localStreams},l.prototype.getRemoteStreams=function(){return this.remoteStreams},l.prototype._createTransceiver=function(e,t){var r=this.transceivers.length>0,n={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&r)n.iceTransport=this.transceivers[0].iceTransport,n.dtlsTransport=this.transceivers[0].dtlsTransport;else{var o=this._createIceAndDtlsTransports();n.iceTransport=o.iceTransport,n.dtlsTransport=o.dtlsTransport}return t||this.transceivers.push(n),n},l.prototype.addTrack=function(t,r){if(this._isClosed)throw u("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var n;if(this.transceivers.find((function(e){return e.track===t})))throw u("InvalidAccessError","Track already exists.");for(var o=0;o<this.transceivers.length;o++)this.transceivers[o].track||this.transceivers[o].kind!==t.kind||(n=this.transceivers[o]);return n||(n=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(r)&&this.localStreams.push(r),n.track=t,n.stream=r,n.rtpSender=new e.RTCRtpSender(t,n.dtlsTransport),n.rtpSender},l.prototype.addStream=function(e){var r=this;if(t>=15025)e.getTracks().forEach((function(t){r.addTrack(t,e)}));else{var n=e.clone();e.getTracks().forEach((function(e,t){var r=n.getTracks()[t];e.addEventListener("enabled",(function(e){r.enabled=e.enabled}))})),n.getTracks().forEach((function(e){r.addTrack(e,n)}))}},l.prototype.removeTrack=function(t){if(this._isClosed)throw u("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var r=this.transceivers.find((function(e){return e.rtpSender===t}));if(!r)throw u("InvalidAccessError","Sender was not created by this connection.");var n=r.stream;r.rtpSender.stop(),r.rtpSender=null,r.track=null,r.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(n)&&this.localStreams.indexOf(n)>-1&&this.localStreams.splice(this.localStreams.indexOf(n),1),this._maybeFireNegotiationNeeded()},l.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var r=t.getSenders().find((function(t){return t.track===e}));r&&t.removeTrack(r)}))},l.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},l.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},l.prototype._createIceGatherer=function(t,r){var n=this;if(r&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var o=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(o,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var r=!e.candidate||0===Object.keys(e.candidate).length;o.state=r?"completed":"gathering",null!==n.transceivers[t].bufferedCandidateEvents&&n.transceivers[t].bufferedCandidateEvents.push(e)},o.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),o},l.prototype._gather=function(t,r){var i=this,a=this.transceivers[r].iceGatherer;if(!a.onlocalcandidate){var s=this.transceivers[r].bufferedCandidateEvents;this.transceivers[r].bufferedCandidateEvents=null,a.removeEventListener("localcandidate",this.transceivers[r].bufferCandidates),a.onlocalcandidate=function(e){if(!(i.usingBundle&&r>0)){var s=new Event("icecandidate");s.candidate={sdpMid:t,sdpMLineIndex:r};var c=e.candidate,u=!c||0===Object.keys(c).length;if(u)"new"!==a.state&&"gathering"!==a.state||(a.state="completed");else{"new"===a.state&&(a.state="gathering"),c.component=1,c.ufrag=a.getLocalParameters().usernameFragment;var p=o.writeCandidate(c);s.candidate=n(s.candidate,o.parseCandidate(p)),s.candidate.candidate=p,s.candidate.toJSON=function(){return{candidate:s.candidate.candidate,sdpMid:s.candidate.sdpMid,sdpMLineIndex:s.candidate.sdpMLineIndex,usernameFragment:s.candidate.usernameFragment}}}var l=o.getMediaSections(i._localDescription.sdp);l[s.candidate.sdpMLineIndex]+=u?"a=end-of-candidates\r\n":"a="+s.candidate.candidate+"\r\n",i._localDescription.sdp=o.getDescription(i._localDescription.sdp)+l.join("");var d=i.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==i.iceGatheringState&&(i.iceGatheringState="gathering",i._emitGatheringStateChange()),u||i._dispatchEvent("icecandidate",s),d&&(i._dispatchEvent("icecandidate",new Event("icecandidate")),i.iceGatheringState="complete",i._emitGatheringStateChange())}},e.setTimeout((function(){s.forEach((function(e){a.onlocalcandidate(e)}))}),0)}},l.prototype._createIceAndDtlsTransports=function(){var t=this,r=new e.RTCIceTransport(null);r.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var n=new e.RTCDtlsTransport(r);return n.ondtlsstatechange=function(){t._updateConnectionState()},n.onerror=function(){Object.defineProperty(n,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:r,dtlsTransport:n}},l.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var r=this.transceivers[e].iceTransport;r&&(delete r.onicestatechange,delete this.transceivers[e].iceTransport);var n=this.transceivers[e].dtlsTransport;n&&(delete n.ondtlsstatechange,delete n.onerror,delete this.transceivers[e].dtlsTransport)},l.prototype._transceive=function(e,r,n){var i=a(e.localCapabilities,e.remoteCapabilities);r&&e.rtpSender&&(i.encodings=e.sendEncodingParameters,i.rtcp={cname:o.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(i.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(i)),n&&e.rtpReceiver&&i.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?i.encodings=e.recvEncodingParameters:i.encodings=[{}],i.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(i.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(i.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(i))},l.prototype.setLocalDescription=function(e){var t,r,n=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(u("TypeError",'Unsupported type "'+e.type+'"'));if(!s("setLocalDescription",e.type,n.signalingState)||n._isClosed)return Promise.reject(u("InvalidStateError","Can not set local "+e.type+" in state "+n.signalingState));if("offer"===e.type)t=o.splitSections(e.sdp),r=t.shift(),t.forEach((function(e,t){var r=o.parseRtpParameters(e);n.transceivers[t].localCapabilities=r})),n.transceivers.forEach((function(e,t){n._gather(e.mid,t)}));else if("answer"===e.type){t=o.splitSections(n._remoteDescription.sdp),r=t.shift();var i=o.matchPrefix(r,"a=ice-lite").length>0;t.forEach((function(e,t){var s=n.transceivers[t],c=s.iceGatherer,u=s.iceTransport,p=s.dtlsTransport,l=s.localCapabilities,d=s.remoteCapabilities;if(!(o.isRejected(e)&&0===o.matchPrefix(e,"a=bundle-only").length||s.rejected)){var f=o.getIceParameters(e,r),h=o.getDtlsParameters(e,r);i&&(h.role="server"),n.usingBundle&&0!==t||(n._gather(s.mid,t),"new"===u.state&&u.start(c,f,i?"controlling":"controlled"),"new"===p.state&&p.start(h));var m=a(l,d);n._transceive(s,m.codecs.length>0,!1)}}))}return n._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?n._updateSignalingState("have-local-offer"):n._updateSignalingState("stable"),Promise.resolve()},l.prototype.setRemoteDescription=function(n){var i=this;if(-1===["offer","answer"].indexOf(n.type))return Promise.reject(u("TypeError",'Unsupported type "'+n.type+'"'));if(!s("setRemoteDescription",n.type,i.signalingState)||i._isClosed)return Promise.reject(u("InvalidStateError","Can not set remote "+n.type+" in state "+i.signalingState));var l={};i.remoteStreams.forEach((function(e){l[e.id]=e}));var d=[],f=o.splitSections(n.sdp),h=f.shift(),m=o.matchPrefix(h,"a=ice-lite").length>0,v=o.matchPrefix(h,"a=group:BUNDLE ").length>0;i.usingBundle=v;var y=o.matchPrefix(h,"a=ice-options:")[0];return i.canTrickleIceCandidates=!!y&&y.substr(14).split(" ").indexOf("trickle")>=0,f.forEach((function(s,u){var p=o.splitLines(s),f=o.getKind(s),y=o.isRejected(s)&&0===o.matchPrefix(s,"a=bundle-only").length,g=p[0].substr(2).split(" ")[2],b=o.getDirection(s,h),w=o.parseMsid(s),_=o.getMid(s)||o.generateIdentifier();if(y||"application"===f&&("DTLS/SCTP"===g||"UDP/DTLS/SCTP"===g))i.transceivers[u]={mid:_,kind:f,protocol:g,rejected:!0};else{var S,k,x,R,P,C,O,E,T;!y&&i.transceivers[u]&&i.transceivers[u].rejected&&(i.transceivers[u]=i._createTransceiver(f,!0));var j,D,L=o.parseRtpParameters(s);y||(j=o.getIceParameters(s,h),(D=o.getDtlsParameters(s,h)).role="client"),O=o.parseRtpEncodingParameters(s);var I=o.parseRtcpParameters(s),M=o.matchPrefix(s,"a=end-of-candidates",h).length>0,A=o.matchPrefix(s,"a=candidate:").map((function(e){return o.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===n.type||"answer"===n.type)&&!y&&v&&u>0&&i.transceivers[u]&&(i._disposeIceAndDtlsTransports(u),i.transceivers[u].iceGatherer=i.transceivers[0].iceGatherer,i.transceivers[u].iceTransport=i.transceivers[0].iceTransport,i.transceivers[u].dtlsTransport=i.transceivers[0].dtlsTransport,i.transceivers[u].rtpSender&&i.transceivers[u].rtpSender.setTransport(i.transceivers[0].dtlsTransport),i.transceivers[u].rtpReceiver&&i.transceivers[u].rtpReceiver.setTransport(i.transceivers[0].dtlsTransport)),"offer"!==n.type||y)"answer"!==n.type||y||(k=(S=i.transceivers[u]).iceGatherer,x=S.iceTransport,R=S.dtlsTransport,P=S.rtpReceiver,C=S.sendEncodingParameters,E=S.localCapabilities,i.transceivers[u].recvEncodingParameters=O,i.transceivers[u].remoteCapabilities=L,i.transceivers[u].rtcpParameters=I,A.length&&"new"===x.state&&(!m&&!M||v&&0!==u?A.forEach((function(e){c(S.iceTransport,e)})):x.setRemoteCandidates(A)),v&&0!==u||("new"===x.state&&x.start(k,j,"controlling"),"new"===R.state&&R.start(D)),!a(S.localCapabilities,S.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&S.sendEncodingParameters[0].rtx&&delete S.sendEncodingParameters[0].rtx,i._transceive(S,"sendrecv"===b||"recvonly"===b,"sendrecv"===b||"sendonly"===b),!P||"sendrecv"!==b&&"sendonly"!==b?delete S.rtpReceiver:(T=P.track,w?(l[w.stream]||(l[w.stream]=new e.MediaStream),r(T,l[w.stream]),d.push([T,P,l[w.stream]])):(l.default||(l.default=new e.MediaStream),r(T,l.default),d.push([T,P,l.default]))));else{(S=i.transceivers[u]||i._createTransceiver(f)).mid=_,S.iceGatherer||(S.iceGatherer=i._createIceGatherer(u,v)),A.length&&"new"===S.iceTransport.state&&(!M||v&&0!==u?A.forEach((function(e){c(S.iceTransport,e)})):S.iceTransport.setRemoteCandidates(A)),E=e.RTCRtpReceiver.getCapabilities(f),t<15019&&(E.codecs=E.codecs.filter((function(e){return"rtx"!==e.name}))),C=S.sendEncodingParameters||[{ssrc:1001*(2*u+2)}];var N,F=!1;"sendrecv"===b||"sendonly"===b?(F=!S.rtpReceiver,P=S.rtpReceiver||new e.RTCRtpReceiver(S.dtlsTransport,f),F&&(T=P.track,w&&"-"===w.stream||(w?(l[w.stream]||(l[w.stream]=new e.MediaStream,Object.defineProperty(l[w.stream],"id",{get:function(){return w.stream}})),Object.defineProperty(T,"id",{get:function(){return w.track}}),N=l[w.stream]):(l.default||(l.default=new e.MediaStream),N=l.default)),N&&(r(T,N),S.associatedRemoteMediaStreams.push(N)),d.push([T,P,N]))):S.rtpReceiver&&S.rtpReceiver.track&&(S.associatedRemoteMediaStreams.forEach((function(t){var r=t.getTracks().find((function(e){return e.id===S.rtpReceiver.track.id}));r&&function(t,r){r.removeTrack(t),r.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:t}))}(r,t)})),S.associatedRemoteMediaStreams=[]),S.localCapabilities=E,S.remoteCapabilities=L,S.rtpReceiver=P,S.rtcpParameters=I,S.sendEncodingParameters=C,S.recvEncodingParameters=O,i._transceive(i.transceivers[u],!1,F)}}})),void 0===i._dtlsRole&&(i._dtlsRole="offer"===n.type?"active":"passive"),i._remoteDescription={type:n.type,sdp:n.sdp},"offer"===n.type?i._updateSignalingState("have-remote-offer"):i._updateSignalingState("stable"),Object.keys(l).forEach((function(t){var r=l[t];if(r.getTracks().length){if(-1===i.remoteStreams.indexOf(r)){i.remoteStreams.push(r);var n=new Event("addstream");n.stream=r,e.setTimeout((function(){i._dispatchEvent("addstream",n)}))}d.forEach((function(e){var t=e[0],n=e[1];r.id===e[2].id&&p(i,t,n,[r])}))}})),d.forEach((function(e){e[2]||p(i,e[0],e[1],[])})),e.setTimeout((function(){i&&i.transceivers&&i.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},l.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},l.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},l.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},l.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var r=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",r)}},l.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var r=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",r)}},l.prototype.createOffer=function(){var r=this;if(r._isClosed)return Promise.reject(u("InvalidStateError","Can not call createOffer after close"));var n=r.transceivers.filter((function(e){return"audio"===e.kind})).length,a=r.transceivers.filter((function(e){return"video"===e.kind})).length,s=arguments[0];if(s){if(s.mandatory||s.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==s.offerToReceiveAudio&&(n=!0===s.offerToReceiveAudio?1:!1===s.offerToReceiveAudio?0:s.offerToReceiveAudio),void 0!==s.offerToReceiveVideo&&(a=!0===s.offerToReceiveVideo?1:!1===s.offerToReceiveVideo?0:s.offerToReceiveVideo)}for(r.transceivers.forEach((function(e){"audio"===e.kind?--n<0&&(e.wantReceive=!1):"video"===e.kind&&--a<0&&(e.wantReceive=!1)}));n>0||a>0;)n>0&&(r._createTransceiver("audio"),n--),a>0&&(r._createTransceiver("video"),a--);var c=o.writeSessionBoilerplate(r._sdpSessionId,r._sdpSessionVersion++);r.transceivers.forEach((function(n,i){var a=n.track,s=n.kind,c=n.mid||o.generateIdentifier();n.mid=c,n.iceGatherer||(n.iceGatherer=r._createIceGatherer(i,r.usingBundle));var u=e.RTCRtpSender.getCapabilities(s);t<15019&&(u.codecs=u.codecs.filter((function(e){return"rtx"!==e.name}))),u.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),n.remoteCapabilities&&n.remoteCapabilities.codecs&&n.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),u.headerExtensions.forEach((function(e){(n.remoteCapabilities&&n.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var p=n.sendEncodingParameters||[{ssrc:1001*(2*i+1)}];a&&t>=15019&&"video"===s&&!p[0].rtx&&(p[0].rtx={ssrc:p[0].ssrc+1}),n.wantReceive&&(n.rtpReceiver=new e.RTCRtpReceiver(n.dtlsTransport,s)),n.localCapabilities=u,n.sendEncodingParameters=p})),"max-compat"!==r._config.bundlePolicy&&(c+="a=group:BUNDLE "+r.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),c+="a=ice-options:trickle\r\n",r.transceivers.forEach((function(e,t){c+=i(e,e.localCapabilities,"offer",e.stream,r._dtlsRole),c+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===r.iceGatheringState||0!==t&&r.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,c+="a="+o.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(c+="a=end-of-candidates\r\n"))}));var p=new e.RTCSessionDescription({type:"offer",sdp:c});return Promise.resolve(p)},l.prototype.createAnswer=function(){var r=this;if(r._isClosed)return Promise.reject(u("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==r.signalingState&&"have-local-pranswer"!==r.signalingState)return Promise.reject(u("InvalidStateError","Can not call createAnswer in signalingState "+r.signalingState));var n=o.writeSessionBoilerplate(r._sdpSessionId,r._sdpSessionVersion++);r.usingBundle&&(n+="a=group:BUNDLE "+r.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),n+="a=ice-options:trickle\r\n";var s=o.getMediaSections(r._remoteDescription.sdp).length;r.transceivers.forEach((function(e,o){if(!(o+1>s)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?n+="m=application 0 DTLS/SCTP 5000\r\n":n+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?n+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(n+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(n+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var c;e.stream&&("audio"===e.kind?c=e.stream.getAudioTracks()[0]:"video"===e.kind&&(c=e.stream.getVideoTracks()[0]),c&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}));var u=a(e.localCapabilities,e.remoteCapabilities);!u.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,n+=i(e,u,"answer",e.stream,r._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(n+="a=rtcp-rsize\r\n")}}));var c=new e.RTCSessionDescription({type:"answer",sdp:n});return Promise.resolve(c)},l.prototype.addIceCandidate=function(e){var t,r=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(n,i){if(!r._remoteDescription)return i(u("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var a=e.sdpMLineIndex;if(e.sdpMid)for(var s=0;s<r.transceivers.length;s++)if(r.transceivers[s].mid===e.sdpMid){a=s;break}var p=r.transceivers[a];if(!p)return i(u("OperationError","Can not add ICE candidate"));if(p.rejected)return n();var l=Object.keys(e.candidate).length>0?o.parseCandidate(e.candidate):{};if("tcp"===l.protocol&&(0===l.port||9===l.port))return n();if(l.component&&1!==l.component)return n();if((0===a||a>0&&p.iceTransport!==r.transceivers[0].iceTransport)&&!c(p.iceTransport,l))return i(u("OperationError","Can not add ICE candidate"));var d=e.candidate.trim();0===d.indexOf("a=")&&(d=d.substr(2)),(t=o.getMediaSections(r._remoteDescription.sdp))[a]+="a="+(l.type?d:"end-of-candidates")+"\r\n",r._remoteDescription.sdp=o.getDescription(r._remoteDescription.sdp)+t.join("")}else for(var f=0;f<r.transceivers.length&&(r.transceivers[f].rejected||(r.transceivers[f].iceTransport.addRemoteCandidate({}),(t=o.getMediaSections(r._remoteDescription.sdp))[f]+="a=end-of-candidates\r\n",r._remoteDescription.sdp=o.getDescription(r._remoteDescription.sdp)+t.join(""),!r.usingBundle));f++);n()}))},l.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var r=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?r=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(r=e.rtpReceiver)})),!r)throw u("InvalidAccessError","Invalid selector.");return r.getStats()}var n=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&n.push(e[t].getStats())}))})),Promise.all(n).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){var r=e[t];if(r&&r.prototype&&r.prototype.getStats){var n=r.prototype.getStats;r.prototype.getStats=function(){return n.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(r){var n;e[r].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(n=e[r]).type]||n.type,t.set(r,e[r])})),t}))}}}));var d=["createOffer","createAnswer"];return d.forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"==typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"==typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(d=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)}),(function(t){"function"==typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),l}},1723:e=>{var t=e.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),(t+=null!=e["network-id"]?" network-id %d":"%v")+(null!=e["network-cost"]?" network-cost %d":"%v")}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(null!=e.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=null!=e.id?"id=%s %s":"%v%s",t+=null!=e.mediaClockValue?"=%s":"",(t+=null!=e.rateNumerator?" rate=%s":"")+(null!=e.rateDenominator?"/%s":"")}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(t).forEach((function(e){t[e].forEach((function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")}))}))},9652:(e,t,r)=>{var n=r(2973),o=r(9721);t.write=o,t.parse=n.parse,t.parseParams=n.parseParams,t.parseFmtpConfig=n.parseFmtpConfig,t.parsePayloads=n.parsePayloads,t.parseRemoteCandidates=n.parseRemoteCandidates,t.parseImageAttributes=n.parseImageAttributes,t.parseSimulcastStreamList=n.parseSimulcastStreamList},2973:(e,t,r)=>{var n=function(e){return String(Number(e))===e?Number(e):e},o=function(e,t,r){var o=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:o&&!t[e.name]&&(t[e.name]={});var i=e.push?{}:o?t[e.name]:t;!function(e,t,r,o){if(o&&!r)t[o]=n(e[1]);else for(var i=0;i<r.length;i+=1)null!=e[i+1]&&(t[r[i]]=n(e[i+1]))}(r.match(e.reg),i,e.names,e.name),e.push&&t[e.push].push(i)},i=r(1723),a=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(e){var t={},r=[],n=t;return e.split(/(\r\n|\r|\n)/).filter(a).forEach((function(e){var t=e[0],a=e.slice(2);"m"===t&&(r.push({rtp:[],fmtp:[]}),n=r[r.length-1]);for(var s=0;s<(i[t]||[]).length;s+=1){var c=i[t][s];if(c.reg.test(a))return o(c,n,a)}})),t.media=r,t};var s=function(e,t){var r=t.split(/=(.+)/,2);return 2===r.length?e[r[0]]=n(r[1]):1===r.length&&t.length>1&&(e[r[0]]=void 0),e};t.parseParams=function(e){return e.split(/;\s?/).reduce(s,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(e){return e.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(e){for(var t=[],r=e.split(" ").map(n),o=0;o<r.length;o+=3)t.push({component:r[o],ip:r[o+1],port:r[o+2]});return t},t.parseImageAttributes=function(e){return e.split(" ").map((function(e){return e.substring(1,e.length-1).split(",").reduce(s,{})}))},t.parseSimulcastStreamList=function(e){return e.split(";").map((function(e){return e.split(",").map((function(e){var t,r=!1;return"~"!==e[0]?t=n(e):(t=n(e.substring(1,e.length)),r=!0),{scid:t,paused:r}}))}))}},9721:(e,t,r)=>{var n=r(1723),o=/%[sdv%]/g,i=function(e){var t=1,r=arguments,n=r.length;return e.replace(o,(function(e){if(t>=n)return e;var o=r[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(o);case"%d":return Number(o);case"%v":return""}}))},a=function(e,t,r){var n=[e+"="+(t.format instanceof Function?t.format(t.push?r:r[t.name]):t.format)];if(t.names)for(var o=0;o<t.names.length;o+=1){var a=t.names[o];t.name?n.push(r[t.name][a]):n.push(r[t.names[o]])}else n.push(r[t.name]);return i.apply(null,n)},s=["v","o","s","i","u","e","p","c","b","t","r","z","a"],c=["i","c","b","a"];e.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach((function(e){null==e.payloads&&(e.payloads="")}));var r=t.outerOrder||s,o=t.innerOrder||c,i=[];return r.forEach((function(t){n[t].forEach((function(r){r.name in e&&null!=e[r.name]?i.push(a(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach((function(e){i.push(a(t,r,e))}))}))})),e.media.forEach((function(e){i.push(a("m",n.m[0],e)),o.forEach((function(t){n[t].forEach((function(r){r.name in e&&null!=e[r.name]?i.push(a(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach((function(e){i.push(a(t,r,e))}))}))}))})),i.join("\r\n")+"\r\n"}},3074:(e,t,r)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}e=r.nmd(e);var o={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};o.localCName=o.generateIdentifier(),o.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},o.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},o.getDescription=function(e){var t=o.splitSections(e);return t&&t[0]},o.getMediaSections=function(e){var t=o.splitSections(e);return t.shift(),t},o.matchPrefix=function(e,t){return o.splitLines(e).filter((function(e){return 0===e.indexOf(t)}))},o.parseCandidate=function(e){for(var t,r={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},n=8;n<t.length;n+=2)switch(t[n]){case"raddr":r.relatedAddress=t[n+1];break;case"rport":r.relatedPort=parseInt(t[n+1],10);break;case"tcptype":r.tcpType=t[n+1];break;case"ufrag":r.ufrag=t[n+1],r.usernameFragment=t[n+1];break;default:r[t[n]]=t[n+1]}return r},o.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var r=e.type;return t.push("typ"),t.push(r),"host"!==r&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},o.parseIceOptions=function(e){return e.substr(14).split(" ")},o.parseRtpMap=function(e){var t=e.substr(9).split(" "),r={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),r.name=t[0],r.clockRate=parseInt(t[1],10),r.channels=3===t.length?parseInt(t[2],10):1,r.numChannels=r.channels,r},o.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var r=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==r?"/"+r:"")+"\r\n"},o.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},o.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},o.parseFmtp=function(e){for(var t,r={},n=e.substr(e.indexOf(" ")+1).split(";"),o=0;o<n.length;o++)r[(t=n[o].trim().split("="))[0].trim()]=t[1];return r},o.writeFmtp=function(e){var t="",r=e.payloadType;if(void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var n=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?n.push(t+"="+e.parameters[t]):n.push(t)})),t+="a=fmtp:"+r+" "+n.join(";")+"\r\n"}return t},o.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},o.writeRtcpFb=function(e){var t="",r=e.payloadType;return void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+r+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},o.parseSsrcMedia=function(e){var t=e.indexOf(" "),r={ssrc:parseInt(e.substr(7,t-7),10)},n=e.indexOf(":",t);return n>-1?(r.attribute=e.substr(t+1,n-t-1),r.value=e.substr(n+1)):r.attribute=e.substr(t+1),r},o.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},o.getMid=function(e){var t=o.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},o.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},o.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:o.matchPrefix(e+t,"a=fingerprint:").map(o.parseFingerprint)}},o.writeDtlsParameters=function(e,t){var r="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){r+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),r},o.parseCryptoLine=function(e){var t=e.substr(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},o.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"===n(e.keyParams)?o.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},o.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;var t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},o.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},o.getCryptoParameters=function(e,t){return o.matchPrefix(e+t,"a=crypto:").map(o.parseCryptoLine)},o.getIceParameters=function(e,t){var r=o.matchPrefix(e+t,"a=ice-ufrag:")[0],n=o.matchPrefix(e+t,"a=ice-pwd:")[0];return r&&n?{usernameFragment:r.substr(12),password:n.substr(10)}:null},o.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},o.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=o.splitLines(e)[0].split(" "),n=3;n<r.length;n++){var i=r[n],a=o.matchPrefix(e,"a=rtpmap:"+i+" ")[0];if(a){var s=o.parseRtpMap(a),c=o.matchPrefix(e,"a=fmtp:"+i+" ");switch(s.parameters=c.length?o.parseFmtp(c[0]):{},s.rtcpFeedback=o.matchPrefix(e,"a=rtcp-fb:"+i+" ").map(o.parseRtcpFb),t.codecs.push(s),s.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(s.name.toUpperCase())}}}return o.matchPrefix(e,"a=extmap:").forEach((function(e){t.headerExtensions.push(o.parseExtmap(e))})),t},o.writeRtpDescription=function(e,t){var r="";r+="m="+e+" ",r+=t.codecs.length>0?"9":"0",r+=" UDP/TLS/RTP/SAVPF ",r+=t.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach((function(e){r+=o.writeRtpMap(e),r+=o.writeFmtp(e),r+=o.writeRtcpFb(e)}));var n=0;return t.codecs.forEach((function(e){e.maxptime>n&&(n=e.maxptime)})),n>0&&(r+="a=maxptime:"+n+"\r\n"),r+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach((function(e){r+=o.writeExtmap(e)})),r},o.parseRtpEncodingParameters=function(e){var t,r=[],n=o.parseRtpParameters(e),i=-1!==n.fecMechanisms.indexOf("RED"),a=-1!==n.fecMechanisms.indexOf("ULPFEC"),s=o.matchPrefix(e,"a=ssrc:").map((function(e){return o.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),c=s.length>0&&s[0].ssrc,u=o.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));u.length>0&&u[0].length>1&&u[0][0]===c&&(t=u[0][1]),n.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var n={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&t&&(n.rtx={ssrc:t}),r.push(n),i&&((n=JSON.parse(JSON.stringify(n))).fec={ssrc:c,mechanism:a?"red+ulpfec":"red"},r.push(n))}})),0===r.length&&c&&r.push({ssrc:c});var p=o.matchPrefix(e,"b=");return p.length&&(p=0===p[0].indexOf("b=TIAS:")?parseInt(p[0].substr(7),10):0===p[0].indexOf("b=AS:")?1e3*parseInt(p[0].substr(5),10)*.95-16e3:void 0,r.forEach((function(e){e.maxBitrate=p}))),r},o.parseRtcpParameters=function(e){var t={},r=o.matchPrefix(e,"a=ssrc:").map((function(e){return o.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];r&&(t.cname=r.value,t.ssrc=r.ssrc);var n=o.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=n.length>0,t.compound=0===n.length;var i=o.matchPrefix(e,"a=rtcp-mux");return t.mux=i.length>0,t},o.parseMsid=function(e){var t,r=o.matchPrefix(e,"a=msid:");if(1===r.length)return{stream:(t=r[0].substr(7).split(" "))[0],track:t[1]};var n=o.matchPrefix(e,"a=ssrc:").map((function(e){return o.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return n.length>0?{stream:(t=n[0].value.split(" "))[0],track:t[1]}:void 0},o.parseSctpDescription=function(e){var t,r=o.parseMLine(e),n=o.matchPrefix(e,"a=max-message-size:");n.length>0&&(t=parseInt(n[0].substr(19),10)),isNaN(t)&&(t=65536);var i=o.matchPrefix(e,"a=sctp-port:");if(i.length>0)return{port:parseInt(i[0].substr(12),10),protocol:r.fmt,maxMessageSize:t};if(o.matchPrefix(e,"a=sctpmap:").length>0){var a=o.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(a[0],10),protocol:a[1],maxMessageSize:t}}},o.writeSctpDescription=function(e,t){var r=[];return r="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&r.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),r.join("")},o.generateSessionId=function(){return Math.random().toString().substr(2,21)},o.writeSessionBoilerplate=function(e,t,r){var n=void 0!==t?t:2;return"v=0\r\no="+(r||"thisisadapterortc")+" "+(e||o.generateSessionId())+" "+n+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},o.writeMediaSection=function(e,t,r,n){var i=o.writeRtpDescription(e.kind,t);if(i+=o.writeIceParameters(e.iceGatherer.getLocalParameters()),i+=o.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":"active"),i+="a=mid:"+e.mid+"\r\n",e.direction?i+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?i+="a=sendrecv\r\n":e.rtpSender?i+="a=sendonly\r\n":e.rtpReceiver?i+="a=recvonly\r\n":i+="a=inactive\r\n",e.rtpSender){var a="msid:"+n.id+" "+e.rtpSender.track.id+"\r\n";i+="a="+a,i+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a,e.sendEncodingParameters[0].rtx&&(i+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+a,i+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return i+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+o.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(i+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+o.localCName+"\r\n"),i},o.getDirection=function(e,t){for(var r=o.splitLines(e),n=0;n<r.length;n++)switch(r[n]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[n].substr(2)}return t?o.getDirection(t):"sendrecv"},o.getKind=function(e){return o.splitLines(e)[0].split(" ")[0].substr(2)},o.isRejected=function(e){return"0"===e.split(" ",2)[1]},o.parseMLine=function(e){var t=o.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},o.parseOLine=function(e){var t=o.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},o.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=o.splitLines(e),r=0;r<t.length;r++)if(t[r].length<2||"="!==t[r].charAt(1))return!1;return!0},"object"===n(e)&&(e.exports=o)},7510:(e,t,r)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}var o=r(2625),i=r(9466),a=r(3972),s=r(8820)("socket.io-client");e.exports=t=u;var c=t.managers={};function u(e,t){"object"===n(e)&&(t=e,e=void 0),t=t||{};var r,i=o(e),u=i.source,p=i.id,l=i.path,d=c[p]&&l in c[p].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||d?(s("ignoring socket cache for %s",u),r=a(u,t)):(c[p]||(s("new io instance for %s",u),c[p]=a(u,t)),r=c[p]),i.query&&!t.query&&(t.query=i.query),r.socket(i.path,t)}t.protocol=i.protocol,t.connect=u,t.Manager=r(3972),t.Socket=r(9754)},3972:(e,t,r)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}var o=r(2829),i=r(9754),a=r(9932),s=r(9466),c=r(7905),u=r(3018),p=r(8820)("socket.io-client:manager"),l=r(3896),d=r(1433),f=Object.prototype.hasOwnProperty;function h(e,t){if(!(this instanceof h))return new h(e,t);e&&"object"===n(e)&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new d({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var r=t.parser||s;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}e.exports=h,h.prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)f.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},h.prototype.updateSocketIds=function(){for(var e in this.nsps)f.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},h.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},a(h.prototype),h.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},h.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},h.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},h.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},h.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},h.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},h.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},h.prototype.open=h.prototype.connect=function(e,t){if(p("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;p("opening %s",this.uri),this.engine=o(this.uri,this.opts);var r=this.engine,n=this;this.readyState="opening",this.skipReconnect=!1;var i=c(r,"open",(function(){n.onopen(),e&&e()})),a=c(r,"error",(function(t){if(p("connect_error"),n.cleanup(),n.readyState="closed",n.emitAll("connect_error",t),e){var r=new Error("Connection error");r.data=t,e(r)}else n.maybeReconnectOnOpen()}));if(!1!==this._timeout){var s=this._timeout;p("connect attempt will timeout after %d",s),0===s&&i.destroy();var u=setTimeout((function(){p("connect attempt timed out after %d",s),i.destroy(),r.close(),r.emit("error","timeout"),n.emitAll("connect_timeout",s)}),s);this.subs.push({destroy:function(){clearTimeout(u)}})}return this.subs.push(i),this.subs.push(a),this},h.prototype.onopen=function(){p("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(c(e,"data",u(this,"ondata"))),this.subs.push(c(e,"ping",u(this,"onping"))),this.subs.push(c(e,"pong",u(this,"onpong"))),this.subs.push(c(e,"error",u(this,"onerror"))),this.subs.push(c(e,"close",u(this,"onclose"))),this.subs.push(c(this.decoder,"decoded",u(this,"ondecoded")))},h.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},h.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},h.prototype.ondata=function(e){this.decoder.add(e)},h.prototype.ondecoded=function(e){this.emit("packet",e)},h.prototype.onerror=function(e){p("error",e),this.emitAll("error",e)},h.prototype.socket=function(e,t){var r=this.nsps[e];if(!r){r=new i(this,e,t),this.nsps[e]=r;var n=this;r.on("connecting",o),r.on("connect",(function(){r.id=n.generateId(e)})),this.autoConnect&&o()}function o(){~l(n.connecting,r)||n.connecting.push(r)}return r},h.prototype.destroy=function(e){var t=l(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},h.prototype.packet=function(e){p("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,(function(r){for(var n=0;n<r.length;n++)t.engine.write(r[n],e.options);t.encoding=!1,t.processPacketQueue()})))},h.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},h.prototype.cleanup=function(){p("cleanup");for(var e=this.subs.length,t=0;t<e;t++)this.subs.shift().destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},h.prototype.close=h.prototype.disconnect=function(){p("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},h.prototype.onclose=function(e){p("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},h.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)p("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();p("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var r=setTimeout((function(){e.skipReconnect||(p("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open((function(t){t?(p("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(p("reconnect success"),e.onreconnect())})))}),t);this.subs.push({destroy:function(){clearTimeout(r)}})}},h.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},7905:e=>{e.exports=function(e,t,r){return e.on(t,r),{destroy:function(){e.removeListener(t,r)}}}},9754:(e,t,r)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}var o=r(9466),i=r(9932),a=r(8625),s=r(7905),c=r(3018),u=r(8820)("socket.io-client:socket"),p=r(4641),l=r(9398);e.exports=h;var d={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},f=i.prototype.emit;function h(e,t,r){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},r&&r.query&&(this.query=r.query),this.io.autoConnect&&this.open()}i(h.prototype),h.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[s(e,"open",c(this,"onopen")),s(e,"packet",c(this,"onpacket")),s(e,"close",c(this,"onclose"))]}},h.prototype.open=h.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.reconnecting||this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting")),this},h.prototype.send=function(){var e=a(arguments);return e.unshift("message"),this.emit.apply(this,e),this},h.prototype.emit=function(e){if(d.hasOwnProperty(e))return f.apply(this,arguments),this;var t=a(arguments),r={type:(void 0!==this.flags.binary?this.flags.binary:l(t))?o.BINARY_EVENT:o.EVENT,data:t,options:{}};return r.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(u("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),r.id=this.ids++),this.connected?this.packet(r):this.sendBuffer.push(r),this.flags={},this},h.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},h.prototype.onopen=function(){if(u("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"===n(this.query)?p.encode(this.query):this.query;u("sending connect packet with query %s",e),this.packet({type:o.CONNECT,query:e})}else this.packet({type:o.CONNECT})},h.prototype.onclose=function(e){u("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},h.prototype.onpacket=function(e){var t=e.nsp===this.nsp,r=e.type===o.ERROR&&"/"===e.nsp;if(t||r)switch(e.type){case o.CONNECT:this.onconnect();break;case o.EVENT:case o.BINARY_EVENT:this.onevent(e);break;case o.ACK:case o.BINARY_ACK:this.onack(e);break;case o.DISCONNECT:this.ondisconnect();break;case o.ERROR:this.emit("error",e.data)}},h.prototype.onevent=function(e){var t=e.data||[];u("emitting event %j",t),null!=e.id&&(u("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?f.apply(this,t):this.receiveBuffer.push(t)},h.prototype.ack=function(e){var t=this,r=!1;return function(){if(!r){r=!0;var n=a(arguments);u("sending ack %j",n),t.packet({type:l(n)?o.BINARY_ACK:o.ACK,id:e,data:n})}}},h.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(u("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):u("bad ack %s",e.id)},h.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emitBuffered(),this.emit("connect")},h.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)f.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},h.prototype.ondisconnect=function(){u("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},h.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},h.prototype.close=h.prototype.disconnect=function(){return this.connected&&(u("performing disconnect (%s)",this.nsp),this.packet({type:o.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},h.prototype.compress=function(e){return this.flags.compress=e,this},h.prototype.binary=function(e){return this.flags.binary=e,this}},2625:(e,t,r)=>{var n=r(5276),o=r(8820)("socket.io-client:url");e.exports=function(e,t){var r=e;t=t||"undefined"!=typeof location&&location,null==e&&(e=t.protocol+"//"+t.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(o("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),o("parse %s",e),r=n(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";var i=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+i+":"+r.port,r.href=r.protocol+"://"+i+(t&&t.port===r.port?"":":"+r.port),r}},8820:(e,t,r)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(){var e;try{e=t.storage.debug}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e}(t=e.exports=r(766)).log=function(){return"object"===("undefined"==typeof console?"undefined":n(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var r=this.useColors;if(e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+t.humanize(this.diff),r){var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var o=0,i=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))})),e.splice(i,0,n)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=o,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(o())},766:(e,t,r)=>{function n(e){var r;function n(){if(n.enabled){var e=n,o=+new Date,i=o-(r||o);e.diff=i,e.prev=r,e.curr=o,r=o;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var c=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,(function(r,n){if("%%"===r)return r;c++;var o=t.formatters[n];if("function"==typeof o){var i=a[c];r=o.call(e,i),a.splice(c,1),c--}return r})),t.formatArgs.call(e,a),(n.log||t.log||console.log.bind(console)).apply(e,a)}}return n.namespace=e,n.enabled=t.enabled(e),n.useColors=t.useColors(),n.color=function(e){var r,n=0;for(r in e)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]}(e),n.destroy=o,"function"==typeof t.init&&t.init(n),t.instances.push(n),n}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=n.debug=n.default=n).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var r;t.save(e),t.names=[],t.skips=[];var n=("string"==typeof e?e:"").split(/[\s,]+/),o=n.length;for(r=0;r<o;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(r=0;r<t.instances.length;r++){var i=t.instances[r];i.enabled=t.enabled(i.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(9873),t.instances=[],t.names=[],t.skips=[],t.formatters={}},9873:e=>{function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}var r=1e3,n=60*r,o=60*n,i=24*o;function a(e,t,r){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}e.exports=function(e,s){s=s||{};var c,u=t(e);if("string"===u&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var a=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"days":case"day":case"d":return a*i;case"hours":case"hour":case"hrs":case"hr":case"h":return a*o;case"minutes":case"minute":case"mins":case"min":case"m":return a*n;case"seconds":case"second":case"secs":case"sec":case"s":return a*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}(e);if("number"===u&&!1===isNaN(e))return s.long?a(c=e,i,"day")||a(c,o,"hour")||a(c,n,"minute")||a(c,r,"second")||c+" ms":function(e){return e>=i?Math.round(e/i)+"d":e>=o?Math.round(e/o)+"h":e>=n?Math.round(e/n)+"m":e>=r?Math.round(e/r)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},1125:(e,t,r)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}var o=r(1108),i=r(467),a=Object.prototype.toString,s="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===a.call(Blob),c="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===a.call(File);function u(e,t){if(!e)return e;if(i(e)){var r={_placeholder:!0,num:t.length};return t.push(e),r}if(o(e)){for(var a=new Array(e.length),s=0;s<e.length;s++)a[s]=u(e[s],t);return a}if("object"===n(e)&&!(e instanceof Date)){for(var c in a={},e)a[c]=u(e[c],t);return a}return e}function p(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"==typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(o(e))for(var r=0;r<e.length;r++)e[r]=p(e[r],t);else if("object"===n(e))for(var i in e)e[i]=p(e[i],t);return e}t.deconstructPacket=function(e){var t=[],r=e.data,n=e;return n.data=u(r,t),n.attachments=t.length,{packet:n,buffers:t}},t.reconstructPacket=function(e,t){return e.data=p(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,t){var r=0,a=e;!function e(u,p,l){if(!u)return u;if(s&&u instanceof Blob||c&&u instanceof File){r++;var d=new FileReader;d.onload=function(){l?l[p]=this.result:a=this.result,--r||t(a)},d.readAsArrayBuffer(u)}else if(o(u))for(var f=0;f<u.length;f++)e(u[f],f,u);else if("object"===n(u)&&!i(u))for(var h in u)e(u[h],h,u)}(a),r||t(a)}},9466:(e,t,r)=>{var n=r(1380)("socket.io-parser"),o=r(9932),i=r(1125),a=r(1108),s=r(467);function c(){}t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=c,t.Decoder=l;var u=t.ERROR+'"encode error"';function p(e){var r=""+e.type;if(t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(r+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(r+=e.nsp+","),null!=e.id&&(r+=e.id),null!=e.data){var o=function(e){try{return JSON.stringify(e)}catch(e){return!1}}(e.data);if(!1===o)return u;r+=o}return n("encoded %j as %s",e,r),r}function l(){this.reconstructor=null}function d(e){this.reconPack=e,this.buffers=[]}function f(e){return{type:t.ERROR,data:"parser error: "+e}}c.prototype.encode=function(e,r){n("encoding packet %j",e),t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type?function(e,t){i.removeBlobs(e,(function(e){var r=i.deconstructPacket(e),n=p(r.packet),o=r.buffers;o.unshift(n),t(o)}))}(e,r):r([p(e)])},o(l.prototype),l.prototype.add=function(e){var r;if("string"==typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");r=function(e){var r=0,o={type:Number(e.charAt(0))};if(null==t.types[o.type])return f("unknown packet type "+o.type);if(t.BINARY_EVENT===o.type||t.BINARY_ACK===o.type){for(var i=r+1;"-"!==e.charAt(++r)&&r!=e.length;);var s=e.substring(i,r);if(s!=Number(s)||"-"!==e.charAt(r))throw new Error("Illegal attachments");o.attachments=Number(s)}if("/"===e.charAt(r+1)){for(i=r+1;++r&&","!==(u=e.charAt(r))&&r!==e.length;);o.nsp=e.substring(i,r)}else o.nsp="/";var c=e.charAt(r+1);if(""!==c&&Number(c)==c){for(i=r+1;++r;){var u;if(null==(u=e.charAt(r))||Number(u)!=u){--r;break}if(r===e.length)break}o.id=Number(e.substring(i,r+1))}if(e.charAt(++r)){var p=function(e){try{return JSON.parse(e)}catch(e){return!1}}(e.substr(r));if(!1===p||o.type!==t.ERROR&&!a(p))return f("invalid payload");o.data=p}return n("decoded %s as %j",e,o),o}(e),t.BINARY_EVENT===r.type||t.BINARY_ACK===r.type?(this.reconstructor=new d(r),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",r)):this.emit("decoded",r)}else{if(!s(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(r=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",r))}},l.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},d.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=i.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},d.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},467:e=>{e.exports=function(e){return t&&Buffer.isBuffer(e)||r&&(e instanceof ArrayBuffer||n(e))};var t="function"==typeof Buffer&&"function"==typeof Buffer.isBuffer,r="function"==typeof ArrayBuffer,n=function(e){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer}},1380:(e,t,r)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(){var e;try{e=t.storage.debug}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e}(t=e.exports=r(7898)).log=function(){return"object"===("undefined"==typeof console?"undefined":n(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var r=this.useColors;if(e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+t.humanize(this.diff),r){var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var o=0,i=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))})),e.splice(i,0,n)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=o,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(o())},7898:(e,t,r)=>{function n(e){var r;function n(){if(n.enabled){var e=n,o=+new Date,i=o-(r||o);e.diff=i,e.prev=r,e.curr=o,r=o;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var c=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,(function(r,n){if("%%"===r)return r;c++;var o=t.formatters[n];if("function"==typeof o){var i=a[c];r=o.call(e,i),a.splice(c,1),c--}return r})),t.formatArgs.call(e,a),(n.log||t.log||console.log.bind(console)).apply(e,a)}}return n.namespace=e,n.enabled=t.enabled(e),n.useColors=t.useColors(),n.color=function(e){var r,n=0;for(r in e)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]}(e),n.destroy=o,"function"==typeof t.init&&t.init(n),t.instances.push(n),n}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=n.debug=n.default=n).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var r;t.save(e),t.names=[],t.skips=[];var n=("string"==typeof e?e:"").split(/[\s,]+/),o=n.length;for(r=0;r<o;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(r=0;r<t.instances.length;r++){var i=t.instances[r];i.enabled=t.enabled(i.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(3180),t.instances=[],t.names=[],t.skips=[],t.formatters={}},1108:e=>{var t={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==t.call(e)}},3180:e=>{function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}var r=1e3,n=60*r,o=60*n,i=24*o;function a(e,t,r){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}e.exports=function(e,s){s=s||{};var c,u=t(e);if("string"===u&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var a=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"days":case"day":case"d":return a*i;case"hours":case"hour":case"hrs":case"hr":case"h":return a*o;case"minutes":case"minute":case"mins":case"min":case"m":return a*n;case"seconds":case"second":case"secs":case"sec":case"s":return a*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}(e);if("number"===u&&!1===isNaN(e))return s.long?a(c=e,i,"day")||a(c,o,"hour")||a(c,n,"minute")||a(c,r,"second")||c+" ms":function(e){return e>=i?Math.round(e/i)+"d":e>=o?Math.round(e/o)+"h":e>=n?Math.round(e/n)+"m":e>=r?Math.round(e/r)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},8625:e=>{e.exports=function(e,t){for(var r=[],n=(t=t||0)||0;n<e.length;n++)r[n-t]=e[n];return r}},7492:function(e,t,r){var n;function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}e=r.nmd(e),function(i,a){"use strict";var s="function",c="undefined",u="object",p="string",l="major",d="model",f="name",h="type",m="vendor",v="version",y="architecture",g="console",b="mobile",w="tablet",_="smarttv",S="wearable",k="embedded",x="Amazon",R="Apple",P="ASUS",C="BlackBerry",O="Browser",E="Chrome",T="Firefox",j="Google",D="Huawei",L="LG",I="Microsoft",M="Motorola",A="Opera",N="Samsung",F="Sharp",B="Sony",G="Xiaomi",V="Zebra",U="Facebook",q="Chromium OS",z="Mac OS",W=function(e){for(var t={},r=0;r<e.length;r++)t[e[r].toUpperCase()]=e[r];return t},K=function(e,t){return o(e)===p&&-1!==H(t).indexOf(H(e))},H=function(e){return e.toLowerCase()},Y=function(e,t){if(o(e)===p)return e=e.replace(/^\s\s*/,""),o(t)===c?e:e.substring(0,500)},$=function(e,t){for(var r,n,i,c,p,l,d=0;d<t.length&&!p;){var f=t[d],h=t[d+1];for(r=n=0;r<f.length&&!p&&f[r];)if(p=f[r++].exec(e))for(i=0;i<h.length;i++)l=p[++n],o(c=h[i])===u&&c.length>0?2===c.length?o(c[1])==s?this[c[0]]=c[1].call(this,l):this[c[0]]=c[1]:3===c.length?o(c[1])!==s||c[1].exec&&c[1].test?this[c[0]]=l?l.replace(c[1],c[2]):a:this[c[0]]=l?c[1].call(this,l,c[2]):a:4===c.length&&(this[c[0]]=l?c[3].call(this,l.replace(c[1],c[2])):a):this[c]=l||a;d+=2}},J=function(e,t){for(var r in t)if(o(t[r])===u&&t[r].length>0){for(var n=0;n<t[r].length;n++)if(K(t[r][n],e))return"?"===r?a:r}else if(K(t[r],e))return"?"===r?a:r;return e},X={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Q={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[v,[f,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[v,[f,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[f,v],[/opios[\/ ]+([\w\.]+)/i],[v,[f,A+" Mini"]],[/\bopr\/([\w\.]+)/i],[v,[f,A]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[v,[f,"Baidu"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim)\s?(?:browser)?[\/ ]?([\w\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[f,v],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[v,[f,"UC"+O]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[v,[f,"WeChat"]],[/konqueror\/([\w\.]+)/i],[v,[f,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[v,[f,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[v,[f,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[v,[f,"Smart Lenovo "+O]],[/(avast|avg)\/([\w\.]+)/i],[[f,/(.+)/,"$1 Secure "+O],v],[/\bfocus\/([\w\.]+)/i],[v,[f,T+" Focus"]],[/\bopt\/([\w\.]+)/i],[v,[f,A+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[v,[f,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[v,[f,"Dolphin"]],[/coast\/([\w\.]+)/i],[v,[f,A+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[v,[f,"MIUI "+O]],[/fxios\/([-\w\.]+)/i],[v,[f,T]],[/\bqihu|(qi?ho?o?|360)browser/i],[[f,"360 "+O]],[/(oculus|sailfish|huawei|vivo)browser\/([\w\.]+)/i],[[f,/(.+)/,"$1 "+O],v],[/samsungbrowser\/([\w\.]+)/i],[v,[f,N+" Internet"]],[/(comodo_dragon)\/([\w\.]+)/i],[[f,/_/g," "],v],[/metasr[\/ ]?([\d\.]+)/i],[v,[f,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[f,"Sogou Mobile"],v],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345Explorer)[\/ ]?([\w\.]+)/i],[f,v],[/(lbbrowser)/i,/\[(linkedin)app\]/i],[f],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[f,U],v],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[f,v],[/\bgsa\/([\w\.]+) .*safari\//i],[v,[f,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[v,[f,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[v,[f,E+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[f,E+" WebView"],v],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[v,[f,"Android "+O]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[f,v],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[v,[f,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[v,f],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[f,[v,J,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[f,v],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[f,"Netscape"],v],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[v,[f,T+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[f,v],[/(cobalt)\/([\w\.]+)/i],[f,[v,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[y,"amd64"]],[/(ia32(?=;))/i],[[y,H]],[/((?:i[346]|x)86)[;\)]/i],[[y,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[y,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[y,"armhf"]],[/windows (ce|mobile); ppc;/i],[[y,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[y,/ower/,"",H]],[/(sun4\w)[;\)]/i],[[y,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[y,H]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[d,[m,N],[h,w]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[d,[m,N],[h,b]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[d,[m,R],[h,b]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[d,[m,R],[h,w]],[/(macintosh);/i],[d,[m,R]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[d,[m,F],[h,b]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[d,[m,D],[h,w]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[d,[m,D],[h,b]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[d,/_/g," "],[m,G],[h,b]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[d,/_/g," "],[m,G],[h,w]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[d,[m,"OPPO"],[h,b]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[d,[m,"Vivo"],[h,b]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[d,[m,"Realme"],[h,b]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[d,[m,M],[h,b]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[d,[m,M],[h,w]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[d,[m,L],[h,w]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[d,[m,L],[h,b]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[d,[m,"Lenovo"],[h,w]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[d,/_/g," "],[m,"Nokia"],[h,b]],[/(pixel c)\b/i],[d,[m,j],[h,w]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[d,[m,j],[h,b]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[d,[m,B],[h,b]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[d,"Xperia Tablet"],[m,B],[h,w]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[d,[m,"OnePlus"],[h,b]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[d,[m,x],[h,w]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[d,/(.+)/g,"Fire Phone $1"],[m,x],[h,b]],[/(playbook);[-\w\),; ]+(rim)/i],[d,m,[h,w]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[d,[m,C],[h,b]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[d,[m,P],[h,w]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[d,[m,P],[h,b]],[/(nexus 9)/i],[d,[m,"HTC"],[h,w]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[m,[d,/_/g," "],[h,b]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[d,[m,"Acer"],[h,w]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[d,[m,"Meizu"],[h,b]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[d,[m,"Ulefone"],[h,b]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[m,d,[h,b]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[m,d,[h,w]],[/(surface duo)/i],[d,[m,I],[h,w]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[d,[m,"Fairphone"],[h,b]],[/(u304aa)/i],[d,[m,"AT&T"],[h,b]],[/\bsie-(\w*)/i],[d,[m,"Siemens"],[h,b]],[/\b(rct\w+) b/i],[d,[m,"RCA"],[h,w]],[/\b(venue[\d ]{2,7}) b/i],[d,[m,"Dell"],[h,w]],[/\b(q(?:mv|ta)\w+) b/i],[d,[m,"Verizon"],[h,w]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[d,[m,"Barnes & Noble"],[h,w]],[/\b(tm\d{3}\w+) b/i],[d,[m,"NuVision"],[h,w]],[/\b(k88) b/i],[d,[m,"ZTE"],[h,w]],[/\b(nx\d{3}j) b/i],[d,[m,"ZTE"],[h,b]],[/\b(gen\d{3}) b.+49h/i],[d,[m,"Swiss"],[h,b]],[/\b(zur\d{3}) b/i],[d,[m,"Swiss"],[h,w]],[/\b((zeki)?tb.*\b) b/i],[d,[m,"Zeki"],[h,w]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[m,"Dragon Touch"],d,[h,w]],[/\b(ns-?\w{0,9}) b/i],[d,[m,"Insignia"],[h,w]],[/\b((nxa|next)-?\w{0,9}) b/i],[d,[m,"NextBook"],[h,w]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[m,"Voice"],d,[h,b]],[/\b(lvtel\-)?(v1[12]) b/i],[[m,"LvTel"],d,[h,b]],[/\b(ph-1) /i],[d,[m,"Essential"],[h,b]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[d,[m,"Envizen"],[h,w]],[/\b(trio[-\w\. ]+) b/i],[d,[m,"MachSpeed"],[h,w]],[/\btu_(1491) b/i],[d,[m,"Rotor"],[h,w]],[/(shield[\w ]+) b/i],[d,[m,"Nvidia"],[h,w]],[/(sprint) (\w+)/i],[m,d,[h,b]],[/(kin\.[onetw]{3})/i],[[d,/\./g," "],[m,I],[h,b]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[d,[m,V],[h,w]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[d,[m,V],[h,b]],[/smart-tv.+(samsung)/i],[m,[h,_]],[/hbbtv.+maple;(\d+)/i],[[d,/^/,"SmartTV"],[m,N],[h,_]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[m,L],[h,_]],[/(apple) ?tv/i],[m,[d,R+" TV"],[h,_]],[/crkey/i],[[d,E+"cast"],[m,j],[h,_]],[/droid.+aft(\w+)( bui|\))/i],[d,[m,x],[h,_]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[d,[m,F],[h,_]],[/(bravia[\w ]+)( bui|\))/i],[d,[m,B],[h,_]],[/(mitv-\w{5}) bui/i],[d,[m,G],[h,_]],[/Hbbtv.*(technisat) (.*);/i],[m,d,[h,_]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[m,Y],[d,Y],[h,_]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[h,_]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[m,d,[h,g]],[/droid.+; (shield) bui/i],[d,[m,"Nvidia"],[h,g]],[/(playstation [345portablevi]+)/i],[d,[m,B],[h,g]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[d,[m,I],[h,g]],[/((pebble))app/i],[m,d,[h,S]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[d,[m,R],[h,S]],[/droid.+; (glass) \d/i],[d,[m,j],[h,S]],[/droid.+; (wt63?0{2,3})\)/i],[d,[m,V],[h,S]],[/(quest( 2| pro)?)/i],[d,[m,U],[h,S]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[m,[h,k]],[/(aeobc)\b/i],[d,[m,x],[h,k]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[d,[h,b]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[d,[h,w]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[h,w]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[h,b]],[/(android[-\w\. ]{0,9});.+buil/i],[d,[m,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[v,[f,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[v,[f,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[f,v],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[v,f]],os:[[/microsoft (windows) (vista|xp)/i],[f,v],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[f,[v,J,X]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[v,J,X],[f,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[v,/_/g,"."],[f,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[f,z],[v,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[v,f],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[f,v],[/\(bb(10);/i],[v,[f,C]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[v,[f,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[v,[f,T+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[v,[f,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[v,[f,"watchOS"]],[/crkey\/([\d\.]+)/i],[v,[f,E+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[f,q],v],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[f,v],[/(sunos) ?([\w\.\d]*)/i],[[f,"Solaris"],v],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[f,v]]},Z=function e(t,r){if(o(t)===u&&(r=t,t=a),!(this instanceof e))return new e(t,r).getResult();var n=o(i)!==c&&i.navigator?i.navigator:a,g=t||(n&&n.userAgent?n.userAgent:""),_=n&&n.userAgentData?n.userAgentData:a,S=r?function(e,t){var r={};for(var n in e)t[n]&&t[n].length%2==0?r[n]=t[n].concat(e[n]):r[n]=e[n];return r}(Q,r):Q,k=n&&n.userAgent==g;return this.getBrowser=function(){var e,t={};return t[f]=a,t[v]=a,$.call(t,g,S.browser),t[l]=o(e=t[v])===p?e.replace(/[^\d\.]/g,"").split(".")[0]:a,k&&n&&n.brave&&o(n.brave.isBrave)==s&&(t[f]="Brave"),t},this.getCPU=function(){var e={};return e[y]=a,$.call(e,g,S.cpu),e},this.getDevice=function(){var e={};return e[m]=a,e[d]=a,e[h]=a,$.call(e,g,S.device),k&&!e[h]&&_&&_.mobile&&(e[h]=b),k&&"Macintosh"==e[d]&&n&&o(n.standalone)!==c&&n.maxTouchPoints&&n.maxTouchPoints>2&&(e[d]="iPad",e[h]=w),e},this.getEngine=function(){var e={};return e[f]=a,e[v]=a,$.call(e,g,S.engine),e},this.getOS=function(){var e={};return e[f]=a,e[v]=a,$.call(e,g,S.os),k&&!e[f]&&_&&"Unknown"!=_.platform&&(e[f]=_.platform.replace(/chrome os/i,q).replace(/macos/i,z)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return g},this.setUA=function(e){return g=o(e)===p&&e.length>500?Y(e,500):e,this},this.setUA(g),this};Z.VERSION="1.0.37",Z.BROWSER=W([f,v,l]),Z.CPU=W([y]),Z.DEVICE=W([d,m,h,g,b,_,w,S,k]),Z.ENGINE=Z.OS=W([f,v]),o(t)!==c?(o(e)!==c&&e.exports&&(t=e.exports=Z),t.UAParser=Z):o(r.amdD)===s&&r.amdO?(n=function(){return Z}.call(t,r,t,e))===a||(e.exports=n):o(i)!==c&&(i.UAParser=Z);var ee=o(i)!==c&&(i.jQuery||i.Zepto);if(ee&&!ee.ua){var te=new Z;ee.ua=te.getResult(),ee.ua.get=function(){return te.getUA()},ee.ua.set=function(e){te.setUA(e);var t=te.getResult();for(var r in t)ee.ua[r]=t[r]}}}("object"===("undefined"==typeof window?"undefined":o(window))?window:this)},7444:(e,t,r)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}var o;if("object"===("undefined"==typeof globalThis?"undefined":n(globalThis)))o=globalThis;else try{o=r(9257)}catch(e){}finally{if(o||"undefined"==typeof window||(o=window),!o)throw new Error("Could not determine global this")}var i=o.WebSocket||o.MozWebSocket,a=r(6710);function s(e,t){return t?new i(e,t):new i(e)}i&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach((function(e){Object.defineProperty(s,e,{get:function(){return i[e]}})})),e.exports={w3cwebsocket:i?s:null,version:a}},6710:(e,t,r)=>{e.exports=r(9794).version},1012:e=>{"use strict";var t,r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),n=64,o={},i=0,a=0;function s(e){var t="";do{t=r[e%n]+t,e=Math.floor(e/n)}while(e>0);return t}function c(){var e=s(+new Date);return e!==t?(i=0,t=e):e+"."+s(i++)}for(;a<n;a++)o[r[a]]=a;c.encode=s,c.decode=function(e){var t=0;for(a=0;a<e.length;a++)t=t*n+o[e.charAt(a)];return t},e.exports=c},7020:()=>{},7002:e=>{"use strict";e.exports=JSON.parse('{"name":"protoo-client","version":"4.0.6","description":"protoo JavaScript client module","author":"Iaki Baz Castillo <ibc@aliax.net>","homepage":"https://protoo.versatica.com","license":"MIT","repository":{"type":"git","url":"https://github.com/ibc/protoo.git"},"main":"lib/index.js","keywords":["nodejs","browser","websocket"],"engines":{"node":">=8.0.0"},"scripts":{"lint":"eslint -c .eslintrc.js lib"},"dependencies":{"debug":"^4.3.1","events":"^3.2.0","retry":"^0.12.0"},"devDependencies":{"eslint":"^5.16.0"},"optionalDependencies":{"websocket":"^1.0.33"}}')},9794:e=>{"use strict";e.exports={version:"1.0.34"}}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}r.amdD=function(){throw new Error("define cannot be used indirect")},r.amdO={},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var n={};return(()=>{"use strict";r.r(n),r.d(n,{EventManager:()=>tt,default:()=>Cr,logger:()=>pt});var e={};r.r(e),r.d(e,{fixNegotiationNeeded:()=>B,shimAddTrackRemoveTrack:()=>N,shimAddTrackRemoveTrackWithNative:()=>A,shimGetDisplayMedia:()=>O,shimGetSendersWithDtmf:()=>L,shimGetStats:()=>I,shimGetUserMedia:()=>C,shimMediaStream:()=>j,shimOnTrack:()=>D,shimPeerConnection:()=>F,shimSenderReceiverGetStats:()=>M});var t={};r.r(t),r.d(t,{shimGetDisplayMedia:()=>q,shimGetUserMedia:()=>U,shimPeerConnection:()=>z,shimReplaceTrack:()=>W});var o={};r.r(o),r.d(o,{shimAddTransceiver:()=>ne,shimCreateAnswer:()=>ie,shimCreateOffer:()=>oe,shimGetDisplayMedia:()=>Y,shimGetUserMedia:()=>H,shimOnTrack:()=>X,shimPeerConnection:()=>Q,shimRTCDataChannel:()=>re,shimReceiverGetStats:()=>ee,shimRemoveStream:()=>te,shimSenderGetStats:()=>Z});var i={};r.r(i),r.d(i,{shimCallbacksAPI:()=>pe,shimConstraints:()=>de,shimCreateOfferLegacy:()=>me,shimGetUserMedia:()=>le,shimLocalStreamsAPI:()=>ce,shimRTCIceServerUrls:()=>fe,shimRemoteStreamsAPI:()=>ue,shimTrackEventTransceiver:()=>he});var a={};r.r(a),r.d(a,{removeAllowExtmapMixed:()=>xe,shimConnectionState:()=>ke,shimMaxMessageSize:()=>_e,shimRTCIceCandidate:()=>we,shimSendThrowTypeError:()=>Se});var s={};r.r(s),r.d(s,{CHANNEL_CLOSE:()=>Me,CHANNEL_ERROR:()=>Ne,CHANNEL_MESSAGE:()=>Ae,CHANNEL_OPEN:()=>Le,CHANNEL_REOPEN:()=>Ie,CHANNEL_RETRY:()=>Fe,LOGGED_ON_CONSOLE:()=>De,ON_INCOMING_SCREEN_STREAM:()=>Ee,ON_INCOMING_STREAM:()=>Oe,STREAM_ENDED:()=>Te,STREAM_MUTED:()=>je});var c=r(7510),u=r.n(c);function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},p.apply(this,arguments)}function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}var d=!0,f=!0;function h(e,t,r){var n=e.match(t);return n&&n.length>=r&&parseInt(n[r],10)}function m(e,t,r){if(e.RTCPeerConnection){var n=e.RTCPeerConnection.prototype,o=n.addEventListener;n.addEventListener=function(e,n){if(e!==t)return o.apply(this,arguments);var i=function(e){var t=r(e);t&&n(t)};return this._eventMap=this._eventMap||{},this._eventMap[n]=i,o.apply(this,[e,i])};var i=n.removeEventListener;n.removeEventListener=function(e,r){if(e!==t||!this._eventMap||!this._eventMap[r])return i.apply(this,arguments);var n=this._eventMap[r];return delete this._eventMap[r],i.apply(this,[e,n])},Object.defineProperty(n,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}}function v(e){return"boolean"!=typeof e?new Error("Argument type: "+l(e)+". Please use a boolean."):(d=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function y(e){return"boolean"!=typeof e?new Error("Argument type: "+l(e)+". Please use a boolean."):(f=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function g(){if("object"===("undefined"==typeof window?"undefined":l(window))){if(d)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function b(e,t){f&&console.warn(e+" is deprecated, please use "+t+" instead.")}function w(e){var t=e.navigator,r={browser:null,version:null};if(void 0===e||!e.navigator)return r.browser="Not a browser.",r;if(t.mozGetUserMedia)r.browser="firefox",r.version=h(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)r.browser="chrome",r.version=h(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))r.browser="edge",r.version=h(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return r.browser="Not a supported browser.",r;r.browser="safari",r.version=h(t.userAgent,/AppleWebKit\/(\d+)\./,1),r.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return r}function _(e){return"[object Object]"===Object.prototype.toString.call(e)}function S(e){return _(e)?Object.keys(e).reduce((function(t,r){var n=_(e[r]),o=n?S(e[r]):e[r],i=n&&!Object.keys(o).length;return void 0===o||i?t:p(t,function(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==l(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===l(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},r,o))}),{}):e}function k(e,t,r){t&&!r.has(t.id)&&(r.set(t.id,t),Object.keys(t).forEach((function(n){n.endsWith("Id")?k(e,e.get(t[n]),r):n.endsWith("Ids")&&t[n].forEach((function(t){k(e,e.get(t),r)}))})))}function x(e,t,r){var n=r?"outbound-rtp":"inbound-rtp",o=new Map;if(null===t)return o;var i=[];return e.forEach((function(e){"track"===e.type&&e.trackIdentifier===t.id&&i.push(e)})),i.forEach((function(t){e.forEach((function(r){r.type===n&&r.trackId===t.id&&k(e,r,o)}))})),o}function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}var P=g;function C(e){var t=e&&e.navigator;if(t.mediaDevices){var r=w(e),n=function(e){if("object"!==R(e)||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach((function(r){if("require"!==r&&"advanced"!==r&&"mediaSource"!==r){var n="object"===R(e[r])?e[r]:{ideal:e[r]};void 0!==n.exact&&"number"==typeof n.exact&&(n.min=n.max=n.exact);var o=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==n.ideal){t.optional=t.optional||[];var i={};"number"==typeof n.ideal?(i[o("min",r)]=n.ideal,t.optional.push(i),(i={})[o("max",r)]=n.ideal,t.optional.push(i)):(i[o("",r)]=n.ideal,t.optional.push(i))}void 0!==n.exact&&"number"!=typeof n.exact?(t.mandatory=t.mandatory||{},t.mandatory[o("",r)]=n.exact):["min","max"].forEach((function(e){void 0!==n[e]&&(t.mandatory=t.mandatory||{},t.mandatory[o(e,r)]=n[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},o=function(e,o){if(r.version>=61)return o(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===R(e.audio)){var i=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])};i((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),i(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=n(e.audio)}if(e&&"object"===R(e.video)){var a=e.video.facingMode;a=a&&("object"===R(a)?a:{ideal:a});var s,c=r.version<66;if(a&&("user"===a.exact||"environment"===a.exact||"user"===a.ideal||"environment"===a.ideal)&&(!t.mediaDevices.getSupportedConstraints||!t.mediaDevices.getSupportedConstraints().facingMode||c)&&(delete e.video.facingMode,"environment"===a.exact||"environment"===a.ideal?s=["back","rear"]:"user"!==a.exact&&"user"!==a.ideal||(s=["front"]),s))return t.mediaDevices.enumerateDevices().then((function(t){var r=(t=t.filter((function(e){return"videoinput"===e.kind}))).find((function(e){return s.some((function(t){return e.label.toLowerCase().includes(t)}))}));return!r&&t.length&&s.includes("back")&&(r=t[t.length-1]),r&&(e.video.deviceId=a.exact?{exact:r.deviceId}:{ideal:r.deviceId}),e.video=n(e.video),P("chrome: "+JSON.stringify(e)),o(e)}));e.video=n(e.video)}return P("chrome: "+JSON.stringify(e)),o(e)},i=function(e){return r.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(t.getUserMedia=function(e,r,n){o(e,(function(e){t.webkitGetUserMedia(e,r,(function(e){n&&n(i(e))}))}))}.bind(t),t.mediaDevices.getUserMedia){var a=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return o(e,(function(e){return a(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException("","NotFoundError");return t}),(function(e){return Promise.reject(i(e))}))}))}}}}function O(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(r){return t(r).then((function(t){var n=r.video&&r.video.width,o=r.video&&r.video.height,i=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:i||3}},n&&(r.video.mandatory.maxWidth=n),o&&(r.video.mandatory.maxHeight=o),e.navigator.mediaDevices.getUserMedia(r)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}function E(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==T(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==T(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===T(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function T(e){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T(e)}function j(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function D(e){if("object"===T(e)&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var r=this;return this._ontrackpoly||(this._ontrackpoly=function(t){t.stream.addEventListener("addtrack",(function(n){var o;o=e.RTCPeerConnection.prototype.getReceivers?r.getReceivers().find((function(e){return e.track&&e.track.id===n.track.id})):{track:n.track};var i=new Event("track");i.track=n.track,i.receiver=o,i.transceiver={receiver:o},i.streams=[t.stream],r.dispatchEvent(i)})),t.stream.getTracks().forEach((function(n){var o;o=e.RTCPeerConnection.prototype.getReceivers?r.getReceivers().find((function(e){return e.track&&e.track.id===n.id})):{track:n};var i=new Event("track");i.track=n,i.receiver=o,i.transceiver={receiver:o},i.streams=[t.stream],r.dispatchEvent(i)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else m(e,"track",(function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e}))}function L(e){if("object"===T(e)&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){var o=r.apply(this,arguments);return o||(o=t(this,e),this._senders.push(o)),o};var n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){n.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var o=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;this._senders=this._senders||[],o.apply(this,[e]),e.getTracks().forEach((function(e){r._senders.push(t(r,e))}))};var i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach((function(e){var r=t._senders.find((function(t){return t.track===e}));r&&t._senders.splice(t._senders.indexOf(r),1)}))}}else if("object"===T(e)&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var a=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=a.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function I(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=this,r=Array.prototype.slice.call(arguments),n=r[0],o=r[1],i=r[2];if(arguments.length>0&&"function"==typeof n)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof n))return t.apply(this,[]);var a=function(e){var t={};return e.result().forEach((function(e){var r={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((function(t){r[t]=e.stat(t)})),t[r.id]=r})),t},s=function(e){return new Map(Object.keys(e).map((function(t){return[t,e[t]]})))};return arguments.length>=2?t.apply(this,[function(e){o(s(a(e)))},n]):new Promise((function(r,n){t.apply(e,[function(e){r(s(a(e)))},n])})).then(o,i)}}}function M(e){if("object"===T(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t.apply(this,[]);return r.forEach((function(t){return t._pc=e})),r});var r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return x(t,e.track,!0)}))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var n=e.RTCPeerConnection.prototype.getReceivers;n&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=n.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t}),m(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return x(t,e.track,!1)}))}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t,r,n,i=arguments[0];return this.getSenders().forEach((function(e){e.track===i&&(t?n=!0:t=e)})),this.getReceivers().forEach((function(e){return e.track===i&&(r?n=!0:r=e),e.track===i})),n||t&&r?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():r?r.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return o.apply(this,arguments)}}}}function A(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((function(t){return e._shimmedLocalStreams[t][0]}))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){if(!r)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var n=t.apply(this,arguments);return this._shimmedLocalStreams[r.id]?-1===this._shimmedLocalStreams[r.id].indexOf(n)&&this._shimmedLocalStreams[r.id].push(n):this._shimmedLocalStreams[r.id]=[r,n],n};var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((function(e){if(t.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")}));var n=this.getSenders();r.apply(this,arguments);var o=this.getSenders().filter((function(e){return-1===n.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(o)};var n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],n.apply(this,arguments)};var o=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((function(r){var n=t._shimmedLocalStreams[r].indexOf(e);-1!==n&&t._shimmedLocalStreams[r].splice(n,1),1===t._shimmedLocalStreams[r].length&&delete t._shimmedLocalStreams[r]})),o.apply(this,arguments)}}function N(e){if(e.RTCPeerConnection){var t=w(e);if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return A(e);var r=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=r.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map((function(t){return e._reverseStreams[t.id]}))};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var r=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((function(e){if(r.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){var o=new e.MediaStream(t.getTracks());this._streams[t.id]=o,this._reverseStreams[o.id]=t,t=o}n.apply(this,[t])};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},o.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,r){var n=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var o=[].slice.call(arguments,1);if(1!==o.length||!o[0].getTracks().find((function(e){return e===t})))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((function(e){return e.track===t})))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var i=this._streams[r.id];if(i)i.addTrack(t),Promise.resolve().then((function(){n.dispatchEvent(new Event("negotiationneeded"))}));else{var a=new e.MediaStream([t]);this._streams[r.id]=a,this._reverseStreams[a.id]=r,this.addStream(a)}return this.getSenders().find((function(e){return e.track===t}))},["createOffer","createAnswer"].forEach((function(t){var r=e.RTCPeerConnection.prototype[t],n=E({},t,(function(){var e=this,t=arguments;return arguments.length&&"function"==typeof arguments[0]?r.apply(this,[function(r){var n=s(e,r);t[0].apply(null,[n])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):r.apply(this,arguments).then((function(t){return s(e,t)}))}));e.RTCPeerConnection.prototype[t]=n[t]}));var i=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){var r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var n=e._reverseStreams[t],o=e._streams[n.id];r=r.replace(new RegExp(n.id,"g"),o.id)})),new RTCSessionDescription({type:t.type,sdp:r})}(this,arguments[0]),i.apply(this,arguments)):i.apply(this,arguments)};var a=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=a.get.apply(this);return""===e.type?e:s(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t,r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{},Object.keys(this._streams).forEach((function(n){r._streams[n].getTracks().find((function(t){return e.track===t}))&&(t=r._streams[n])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function s(e,t){var r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var n=e._reverseStreams[t],o=e._streams[n.id];r=r.replace(new RegExp(o.id,"g"),n.id)})),new RTCSessionDescription({type:t.type,sdp:r})}}function F(e){var t=w(e);if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection){var r=0===e.RTCPeerConnection.prototype.addIceCandidate.length;t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var r=e.RTCPeerConnection.prototype[t],n=E({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=n[t]}));var n=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return r||arguments[0]?t.version<78&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}}function B(e){m(e,"negotiationneeded",(function(e){if("stable"===e.target.signalingState)return e}))}var G=r(7513),V=r.n(G);function U(e){var t=e&&e.navigator,r=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return r(e).catch((function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))}))}}function q(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}function z(e){var t=w(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var r=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){r.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var n=V()(e,t.version);e.RTCPeerConnection=function(e){var r,o;return e&&e.iceServers&&(e.iceServers=(r=e.iceServers,t.version,o=!1,(r=JSON.parse(JSON.stringify(r))).filter((function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&b("RTCIceServer.url","RTCIceServer.urls");var r="string"==typeof t;return r&&(t=[t]),t=t.filter((function(e){if(0===e.indexOf("stun:"))return!1;var t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!o?(o=!0,!0):t&&!o})),delete e.url,e.urls=r?t[0]:t,!!t.length}}))),g("ICE servers after filtering:",e.iceServers)),new n(e)},e.RTCPeerConnection.prototype=n.prototype}function W(e){e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)&&(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)}function K(e){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},K(e)}function H(e){var t=w(e),r=e&&e.navigator,n=e&&e.MediaStreamTrack;if(r.getUserMedia=function(e,t,n){b("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(e).then(t,n)},!(t.version>55&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){var o=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])},i=r.mediaDevices.getUserMedia.bind(r.mediaDevices);if(r.mediaDevices.getUserMedia=function(e){return"object"===K(e)&&"object"===K(e.audio)&&(e=JSON.parse(JSON.stringify(e)),o(e.audio,"autoGainControl","mozAutoGainControl"),o(e.audio,"noiseSuppression","mozNoiseSuppression")),i(e)},n&&n.prototype.getSettings){var a=n.prototype.getSettings;n.prototype.getSettings=function(){var e=a.apply(this,arguments);return o(e,"mozAutoGainControl","autoGainControl"),o(e,"mozNoiseSuppression","noiseSuppression"),e}}if(n&&n.prototype.applyConstraints){var s=n.prototype.applyConstraints;n.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===K(e)&&(e=JSON.parse(JSON.stringify(e)),o(e,"autoGainControl","mozAutoGainControl"),o(e,"noiseSuppression","mozNoiseSuppression")),s.apply(this,[e])}}}}function Y(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(r){if(!r||!r.video){var n=new DOMException("getDisplayMedia without video constraints is undefined");return n.name="NotFoundError",n.code=8,Promise.reject(n)}return!0===r.video?r.video={mediaSource:t}:r.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(r)})}function $(){return $=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$.apply(this,arguments)}function J(e){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},J(e)}function X(e){"object"===J(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function Q(e){var t=w(e);if("object"===J(e)&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){if(!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var r,n,o,i=e.RTCPeerConnection.prototype[t],a=(r={},o=function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)},(n=function(e){var t=function(e,t){if("object"!==J(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==J(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===J(t)?t:String(t)}(n=t))in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r);e.RTCPeerConnection.prototype[t]=a[t]})),t.version<68){var r=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}var n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=Array.prototype.slice.call(arguments),r=e[0],i=e[1],a=e[2];return o.apply(this,[r||null]).then((function(e){if(t.version<53&&!i)try{e.forEach((function(e){e.type=n[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach((function(t,r){e.set(r,$({},t,{type:n[t.type]||t.type}))}))}return e})).then(i,a)}}}function Z(e){if("object"===J(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpSender.prototype))){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t.apply(this,[]);return r.forEach((function(t){return t._pc=e})),r});var r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}}function ee(e){if("object"===J(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpReceiver.prototype))){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,r=t.apply(this,[]);return r.forEach((function(t){return t._pc=e})),r}),m(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}}function te(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;b("removeStream","removeTrack"),this.getSenders().forEach((function(r){r.track&&e.getTracks().includes(r.track)&&t.removeTrack(r)}))})}function re(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function ne(e){if("object"===J(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1],r=e&&"sendEncodings"in e;r&&e.sendEncodings.forEach((function(e){if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));var n=t.apply(this,arguments);if(r){var o=n.sender,i=o.getParameters();"encodings"in i||(i.encodings=e.sendEncodings,this.setParametersPromises.push(o.setParameters(i).catch((function(){}))))}return n})}}function oe(e){if("object"===J(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){var e=arguments,r=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(r,e)})).finally((function(){r.setParametersPromises=[]})):t.apply(this,arguments)}}}function ie(e){if("object"===J(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){var e=arguments,r=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(r,e)})).finally((function(){r.setParametersPromises=[]})):t.apply(this,arguments)}}}function ae(){return ae=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ae.apply(this,arguments)}function se(e){return se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},se(e)}function ce(e){if("object"===se(e)&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((function(n){return t.call(r,n,e)})),e.getVideoTracks().forEach((function(n){return t.call(r,n,e)}))},e.RTCPeerConnection.prototype.addTrack=function(e){for(var r=this,n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];return o&&o.forEach((function(e){r._localStreams?r._localStreams.includes(e)||r._localStreams.push(e):r._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var r=this._localStreams.indexOf(e);if(-1!==r){this._localStreams.splice(r,1);var n=e.getTracks();this.getSenders().forEach((function(e){n.includes(e.track)&&t.removeTrack(e)}))}})}}function ue(e){if("object"===se(e)&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach((function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var r=new Event("addstream");r.stream=e,t.dispatchEvent(r)}}))})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var r=new Event("addstream");r.stream=t,e.dispatchEvent(r)}}))}),t.apply(e,arguments)}}}function pe(e){if("object"===se(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,r=t.createOffer,n=t.createAnswer,o=t.setLocalDescription,i=t.setRemoteDescription,a=t.addIceCandidate;t.createOffer=function(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],o=r.apply(this,[n]);return t?(o.then(e,t),Promise.resolve()):o},t.createAnswer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],o=n.apply(this,[r]);return t?(o.then(e,t),Promise.resolve()):o};var s=function(e,t,r){var n=o.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n};t.setLocalDescription=s,s=function(e,t,r){var n=i.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.setRemoteDescription=s,s=function(e,t,r){var n=a.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.addIceCandidate=s}}function le(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var r=t.mediaDevices,n=r.getUserMedia.bind(r);t.mediaDevices.getUserMedia=function(e){return n(de(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,r,n){t.mediaDevices.getUserMedia(e).then(r,n)}.bind(t))}function de(e){return e&&void 0!==e.video?ae({},e,{video:S(e.video)}):e}function fe(e){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,r){if(e&&e.iceServers){for(var n=[],o=0;o<e.iceServers.length;o++){var i=e.iceServers[o];!i.hasOwnProperty("urls")&&i.hasOwnProperty("url")?(b("RTCIceServer.url","RTCIceServer.urls"),(i=JSON.parse(JSON.stringify(i))).urls=i.url,delete i.url,n.push(i)):n.push(e.iceServers[o])}e.iceServers=n}return new t(e,r)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})}function he(e){"object"===se(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function me(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var r=this.getTransceivers().find((function(e){return"audio"===e.receiver.track.kind}));!1===e.offerToReceiveAudio&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveAudio||r||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var n=this.getTransceivers().find((function(e){return"video"===e.receiver.track.kind}));!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video")}return t.apply(this,arguments)}}var ve=r(3074),ye=r.n(ve);function ge(){return ge=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ge.apply(this,arguments)}function be(e){return be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},be(e)}function we(e){if(!(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===be(e)&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var r=ge(new t(e),ye().parseCandidate(e.candidate));return r.toJSON=function(){return{candidate:r.candidate,sdpMid:r.sdpMid,sdpMLineIndex:r.sdpMLineIndex,usernameFragment:r.usernameFragment}},r}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,m(e,"icecandidate",(function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t}))}}function _e(e){if(e.RTCPeerConnection){var t=w(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e,n;if(this._sctp=null,"chrome"===t.browser&&t.version>=76&&"plan-b"===this.getConfiguration().sdpSemantics&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0}),function(e){if(!e||!e.sdp)return!1;var t=ye().splitSections(e.sdp);return t.shift(),t.some((function(e){var t=ye().parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))}(arguments[0])){var o,i=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var r=parseInt(t[1],10);return r!=r?-1:r}(arguments[0]),a=(e=i,n=65536,"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n),s=function(e,r){var n=65536;"firefox"===t.browser&&57===t.version&&(n=65535);var o=ye().matchPrefix(e.sdp,"a=max-message-size:");return o.length>0?n=parseInt(o[0].substr(19),10):"firefox"===t.browser&&-1!==r&&(n=2147483637),n}(arguments[0],i);o=0===a&&0===s?Number.POSITIVE_INFINITY:0===a||0===s?Math.max(a,s):Math.min(a,s);var c={};Object.defineProperty(c,"maxMessageSize",{get:function(){return o}}),this._sctp=c}return r.apply(this,arguments)}}}function Se(e){if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=t.apply(this,arguments);return r(e,this),e},m(e,"datachannel",(function(e){return r(e.channel,e.target),e}))}function r(e,t){var r=e.send;e.send=function(){var n=arguments[0],o=n.length||n.size||n.byteLength;if("open"===e.readyState&&t.sctp&&o>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return r.apply(e,arguments)}}}function ke(e){if(e.RTCPeerConnection&&!("connectionState"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((function(e){var r=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var r=new Event("connectionstatechange",e);t.dispatchEvent(r)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}}))}}function xe(e){if(e.RTCPeerConnection){var t=w(e);if(!("chrome"===t.browser&&t.version>=71)){var r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(e){return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(e.sdp=e.sdp.split("\n").filter((function(e){return"a=extmap-allow-mixed"!==e.trim()})).join("\n")),r.apply(this,arguments)}}}}var Re=function(){var r=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).window,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},s=g,c=w(r),u={browserDetails:c,commonShim:a,extractVersion:h,disableLog:v,disableWarnings:y};switch(c.browser){case"chrome":if(!e||!F||!n.shimChrome)return s("Chrome shim is not included in this adapter release."),u;s("adapter.js shimming chrome."),u.browserShim=e,C(r),j(r),F(r),D(r),N(r),L(r),I(r),M(r),B(r),we(r),ke(r),_e(r),Se(r),xe(r);break;case"firefox":if(!o||!Q||!n.shimFirefox)return s("Firefox shim is not included in this adapter release."),u;s("adapter.js shimming firefox."),u.browserShim=o,H(r),Q(r),X(r),te(r),Z(r),ee(r),re(r),ne(r),oe(r),ie(r),we(r),ke(r),_e(r),Se(r);break;case"edge":if(!t||!z||!n.shimEdge)return s("MS edge shim is not included in this adapter release."),u;s("adapter.js shimming edge."),u.browserShim=t,U(r),q(r),z(r),W(r),_e(r),Se(r);break;case"safari":if(!i||!n.shimSafari)return s("Safari shim is not included in this adapter release."),u;s("adapter.js shimming safari."),u.browserShim=i,fe(r),me(r),pe(r),ce(r),ue(r),he(r),le(r),we(r),_e(r),Se(r),xe(r);break;default:s("Unsupported browser!")}return u}({window});const Pe=Re;Pe.options=Pe.options||{},Pe.onwebrtcreadyDone=!1,Pe.WebRTCPlugin={plugin:null},Pe._onwebrtcreadies=[],Pe.webRTCReady=function(e){if("function"!=typeof e)throw new Error("Callback provided is not a function");var t=function(){"function"==typeof window.require&&"function"==typeof Pe._defineMediaSourcePolyfill&&Pe._defineMediaSourcePolyfill(),e(null!==Pe.WebRTCPlugin.plugin)};!0===Pe.onwebrtcreadyDone?t():Pe._onwebrtcreadies.push(t)},Pe.maybeThroughWebRTCReady=function(){Pe.onwebrtcreadyDone||(Pe.onwebrtcreadyDone=!0,Pe._onwebrtcreadies.length?Pe._onwebrtcreadies.forEach((function(e){"function"==typeof e&&e(null!==Pe.WebRTCPlugin.plugin)})):"function"==typeof Pe.onwebrtcready&&Pe.onwebrtcready(null!==Pe.WebRTCPlugin.plugin))},window.webrtcDetectedBrowser=null,window.webrtcDetectedVersion=null,window.webrtcMinimumVersion=null,window.webrtcDetectedDCSupport=null,Pe.parseWebrtcDetectedBrowser=function(){var e=null;if(window.navigator.userAgent.match(/React-Native/gi)||navigator.userAgent.match(/React-Native/gi))window.webrtcDetectedBrowser="react-native",window.webrtcDetectedVersion="",window.webrtcMinimumVersion=0,window.webrtcDetectedType="react-native",window.webrtcDetectedDCSupport=null;else if(window.opr&&window.opr.addons||window.opera||navigator.userAgent.indexOf(" OPR/")>=0)e=navigator.userAgent.match(/OPR\/(\d+)/i)||[],window.webrtcDetectedBrowser="opera",window.webrtcDetectedVersion=parseInt(e[1]||"0",10),window.webrtcMinimumVersion=26,window.webrtcDetectedType="webkit",window.webrtcDetectedDCSupport="SCTP";else if(navigator.userAgent.match(/Bowser\/[0-9.]*/g)){e=navigator.userAgent.match(/Bowser\/[0-9.]*/g)||[];var t=parseInt((navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./i)||[])[2]||"0",10);window.webrtcDetectedBrowser="bowser",window.webrtcDetectedVersion=parseFloat((e[0]||"0/0").split("/")[1],10),window.webrtcMinimumVersion=0,window.webrtcDetectedType="webkit",window.webrtcDetectedDCSupport=t>30?"SCTP":"RTP"}else if(navigator.userAgent.indexOf("OPiOS")>0)e=navigator.userAgent.match(/OPiOS\/([0-9]+)\./),window.webrtcDetectedBrowser="opera",window.webrtcDetectedVersion=parseInt(e[1]||"0",10),window.webrtcMinimumVersion=0,window.webrtcDetectedType=null,window.webrtcDetectedDCSupport=null;else if(navigator.userAgent.indexOf("CriOS")>0)e=navigator.userAgent.match(/CriOS\/([0-9]+)\./)||[],navigator.userAgent.match(/CPU OS ([0-9]+)_([0-9]+)/g)[0].split(" ")[2].split("_")[0]>13?(window.webrtcDetectedVersion=parseInt(e[1]||"0",10),window.webrtcMinimumVersion=53,window.webrtcDetectedType="AppleWebKit",window.webrtcDetectedBrowser="chrome",window.webrtcDetectedDCSupport=null):(window.webrtcDetectedVersion=parseInt(e[1]||"0",10),window.webrtcMinimumVersion=0,window.webrtcDetectedType=null,window.webrtcDetectedBrowser="chrome",window.webrtcDetectedDCSupport=null);else if(navigator.userAgent.indexOf("FxiOS")>0)e=navigator.userAgent.match(/FxiOS\/([0-9]+)\./)||[],window.webrtcDetectedBrowser="firefox",window.webrtcDetectedVersion=parseInt(e[1]||"0",10),window.webrtcMinimumVersion=0,window.webrtcDetectedType=null,window.webrtcDetectedDCSupport=null;else if(document.documentMode)e=/\brv[ :]+(\d+)/g.exec(navigator.userAgent)||[],window.webrtcDetectedBrowser="IE",window.webrtcDetectedVersion=parseInt(e[1],10),window.webrtcMinimumVersion=9,window.webrtcDetectedType="plugin",window.webrtcDetectedDCSupport="SCTP",window.webrtcDetectedVersion||(e=/\bMSIE[ :]+(\d+)/g.exec(navigator.userAgent)||[],window.webrtcDetectedVersion=parseInt(e[1]||"0",10));else if(window.StyleMedia||navigator.userAgent.match(/Edge\/(\d+).(\d+)$/))e=navigator.userAgent.match(/Edge\/(\d+).(\d+)$/)||[],window.webrtcDetectedBrowser="edge",window.webrtcDetectedVersion=parseFloat((e[0]||"0/0").split("/")[1],10),window.webrtcMinimumVersion=13.10547,window.webrtcDetectedType="ms",window.webrtcDetectedDCSupport=null;else if("undefined"!=typeof InstallTrigger||navigator.userAgent.indexOf("irefox")>0)e=navigator.userAgent.match(/Firefox\/([0-9]+)\./)||[],window.webrtcDetectedBrowser="firefox",window.webrtcDetectedVersion=parseInt(e[1]||"0",10),window.webrtcMinimumVersion=33,window.webrtcDetectedType="moz",window.webrtcDetectedDCSupport="SCTP";else if(window.chrome&&window.chrome.webstore||navigator.userAgent.indexOf("Chrom")>0)e=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./i)||[],window.webrtcDetectedBrowser="chrome",window.webrtcDetectedVersion=parseInt(e[2]||"0",10),window.webrtcMinimumVersion=38,window.webrtcDetectedType="webkit",window.webrtcDetectedDCSupport=window.webrtcDetectedVersion>30?"SCTP":"RTP";else if(/constructor/i.test(window.HTMLElement)||"[object SafariRemoteNotification]"===(!window.safari||safari.pushNotification).toString()||navigator.userAgent.match(/AppleWebKit\/(\d+)\./)||navigator.userAgent.match(/Version\/(\d+).(\d+)/)){e=navigator.userAgent.match(/version\/(\d+)\.(\d+)/i)||[];var r=navigator.userAgent.match(/AppleWebKit\/(\d+)/i)||[],n=navigator.userAgent.match(/(iPhone|iPad)/gi),o=r.length>=1&&r[1]>=604;if(window.webrtcDetectedBrowser="safari",window.webrtcDetectedVersion=parseInt(e[1]||"0",10),window.webrtcMinimumVersion=7,n)window.webrtcDetectedType=o?"AppleWebKit":null;else{var i=window.webrtcDetectedVersion,a=parseInt(e[2]||"0",10),s=11==i&&a<2;window.webrtcDetectedType=!o||Pe.options.forceSafariPlugin&&s?"plugin":"AppleWebKit"}window.webrtcDetectedDCSupport="SCTP"}Pe.webrtcDetectedBrowser=window.webrtcDetectedBrowser,Pe.webrtcDetectedVersion=window.webrtcDetectedVersion,Pe.webrtcMinimumVersion=window.webrtcMinimumVersion,Pe.webrtcDetectedType=window.webrtcDetectedType,Pe.webrtcDetectedDCSupport=window.webrtcDetectedDCSupport},Pe.addExtensions=function(){var e=null,t=null;navigator.mozGetUserMedia?(e=function(e,t){return e.srcObject=t,e},t=function(e,t){return e.srcObject=t.srcObject,e}):navigator.webkitGetUserMedia?(e=function(e,t){return Pe.webrtcDetectedVersion>=43?e.srcObject=t:void 0!==e.src?e.src=URL.createObjectURL(t):console.error("Error attaching stream to element."),e},t=function(e,t){return Pe.webrtcDetectedVersion>=43?e.srcObject=t.srcObject:e.src=t.src,e}):"AppleWebKit"===Pe.webrtcDetectedType&&("chrome"===Pe.webrtcDetectedBrowser?e=function(e,t){return Pe.webrtcDetectedVersion>=43?e.srcObject=t:console.error("Error attaching stream to element."),e}:(e=function(e,t){return e.srcObject=t,e},t=function(e,t){return e.srcObject=t.srcObject,e})),window.attachMediaStream=e,window.reattachMediaStream=t,Pe.attachMediaStream=e,Pe.reattachMediaStream=t},Pe.parseWebrtcDetectedBrowser(),Pe.addExtensions(),Pe.maybeThroughWebRTCReady();const Ce=Pe;var Oe="onIncomingStream",Ee="onIncomingScreenStream",Te="streamEnded",je="streamMuted",De="loggedOnConsole",Le="channelOpen",Ie="channelReopen",Me="channelClose",Ae="channelMessage",Ne="channelError",Fe="channelRetry";function Be(e){return Be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Be(e)}function Ge(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==Be(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==Be(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===Be(o)?o:String(o)),n)}var o}function Ve(e,t,r){return t&&Ge(e.prototype,t),r&&Ge(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}const Ue=Ve((function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=t,this.detail=r}));var qe=s,ze={qvga:{width:{ideal:320},height:{ideal:240}},vga:{width:{ideal:640},height:{ideal:480}},hd:{width:{ideal:1280},height:{ideal:720}}},We="SDK EVENT";const Ke={ERRORS:{NO_ADAPTER:"AdapterJS dependency is not loaded or incorrect AdapterJS dependency is used",NO_SOCKET_IO:"Socket.io not loaded - Please load socket.io",NO_SOCKET_HOST_PARAM:"Error host param"},INCOMPATIBLE_BROWSER:"Incompatible browser agent detected",INFO:{API_SUCCESS:"Promise resolved: APP Authenticated Successfully!"}},He={ABORT_RECONNECT:"Aborting socket reconnect",FALIED_LINK:"socket link failed"},Ye={EVENT_DISPATCHED:"Event dispatched",EVENT_REGISTERED:"Event successfully registered",EVENT_UNREGISTERED:"Event successfully unregistered",EVENT_DISPATCH_ERROR:"Error dispatching event",EVENT_REGISTER_ERROR:"Error registering event",EVENT_UNREGISTER_ERROR:"Error unregistering event",LOGS_NOT_STORED:"Store logs feature is not enabled.",LOGS_CLEARED:"Stored logs cleared",INVALID_CB:"Dropping listener as it is not a function"},$e={ERROR_CODES:{INVALID_KEY:"INVALID_KEY",INVALID_OPERATION:"INVALID_OPERATION",INVALID_LOCAL_STREAM:"INVALID_LOCAL_STREAM",INVALID_REMOTE_STREAM:"INVALID_REMOTE_STREAM",SOCKET_ERROR:"SOCKET_ERROR",SOCKET_DISCONNECTED:"SOCKET_DISCONNECTED",PEERCONNECTION_FAILED:"PEERCONNECTION_FAILED",CONNECT_GATEWAY_ERROR:"CONNECT_GATEWAY_ERROR",SERVICE_NOT_AVAILABLE:"SERVICE_NOT_AVAILABLE",JOIN_CHANNEL_FAILED:"JOIN_CHANNEL_FAILED",PUBLISH_STREAM_FAILED:"PUBLISH_STREAM_FAILED",UNPUBLISH_STREAM_FAILED:"UNPUBLISH_STREAM_FAILED",SUBSCRIBE_STREAM_FAILED:"SUBSCRIBE_STREAM_FAILED",UNSUBSCRIBE_STREAM_FAILED:"UNSUBSCRIBE_STREAM_FAILED"}};function Je(e){return Je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Je(e)}function Xe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==Je(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==Je(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===Je(o)?o:String(o)),n)}var o}var Qe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.events={},this.privateEvents={},this.on=this.addEventListener.bind(this)}var t,r;return t=e,(r=[{key:"addPrivateEventListener",value:function(e,t){this.addListener(e,t,!0)}},{key:"addEventListener",value:function(e,t){this.addListener(e,t,!1)}},{key:"addListener",value:function(e,t,r){try{var n=r?"privateEvents":"events";if(!ft(t))return void pt.log.DEBUG([null,We,e,Ye.INVALID_CB]);this[n][e]||(this[n][e]={}),this[n][e].callbacks||(this[n][e].callbacks=[]),this[n][e].callbacks.push(t),r||pt.log.DEBUG([null,We,e,Ye.EVENT_REGISTERED])}catch(t){pt.log.ERROR([null,We,e,Ye.EVENT_REGISTER_ERROR],t)}}},{key:"dispatchEvent",value:function(e){var t=e.type;if(t!==qe.LOGGED_ON_CONSOLE){var r=[];if(this.events[t]){var n=this.events[t].callbacks;r=r.concat(n)}else pt.log.DEBUG([null,We,t,Ye.EVENT_DISPATCHED]);if(this.privateEvents[t]){var o=this.privateEvents[t]?this.privateEvents[t].callbacks:[];r=r.concat(o)}r.forEach((function(r){try{r(e.detail)}catch(e){pt.log.ERROR([null,We,t,Ye.EVENT_DISPATCH_ERROR],e)}}))}}},{key:"removeEventListener",value:function(e,t){this.removeListener(e,t,!1)}},{key:"removePrivateEventListener",value:function(e,t){this.removeListener(e,t,!0)}},{key:"removeListener",value:function(e,t,r){var n=this,o=r?"privateEvents":"events";if(r||this.events[e]&&this.events[e].callbacks)try{this[o][e].callbacks.forEach((function(i,a){i===t&&(delete n[o][e].callbacks[a],r||pt.log.DEBUG([null,We,e,Ye.EVENT_UNREGISTERED]))}))}catch(t){pt.log.ERROR([null,We,e,Ye.EVENT_DISPATCH_ERROR],t)}else pt.log.WARN([null,We,e,Ye.EVENT_UNREGISTERED])}}])&&Xe(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Ze=new Qe,et=(Ze.addPrivateEventListener.bind(Ze),Ze.removePrivateEventListener.bind(Ze),Ze.dispatchEvent.bind(Ze));const tt=Qe;function rt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var nt=["trace","debug","info","warn","error"],ot="loglevel:GmRTC",it=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o="[".concat((new Date).toISOString(),"]"),i=e.level,a=e.logLevels;if(i<=t&&i!==a.SILENT){var s=nt[t],c=function(e){var t=!0;return("undefined"==typeof console||void 0===console[e])&&(t=!1),t}(s);if(!c)return;var u=function(e){var t="".concat(e);if(Array.isArray(e)){var r=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return rt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?rt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e,4),n=r[0],o=r[1],i=r[2],a=r[3];if(t=n?"[".concat(n,"]"):"",t+=o?" <<".concat(o,">>"):n?"":" <<Method>>",i)if(Array.isArray(i))for(var s=0;s<i.length;s+=1)t+=" (".concat(i[s],")");else t+=" (".concat(i,")");a&&(t+=" ".concat(a))}return t}(r),p=Array.prototype.slice.call(arguments,4);0===p.length&&(p=""),console[s](o,s,"GmRTC -",u,n||"",p);var l=function(){return new Ue(De,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}({level:s,message:u,debugObject:n});if(et(l),pt.storeLogs){var d=[o,s.toUpperCase(),u];n&&d.push(n),pt.storedLogs.push(d)}}};function at(e){return at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},at(e)}function st(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==at(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==at(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===at(o)?o:String(o)),n)}var o}var ct=function(){function e(){var t,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.logLevels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},this.level=(t=this.logLevels,null===(r=window.localStorage.getItem(ot))||Number.isNaN(+r)?t.TRACE:+r),this.storeLogs=!0,this.storedLogs=[]}var t,r;return t=e,r=[{key:"setLevel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.levels.ERROR,t=arguments.length>1?arguments[1]:void 0;dt(e)?(this.level=e,function(e){window.localStorage.setItem(ot,e)}(this.level)):this.level=this.levels.ERROR,t&&(this.storeLogs=t)}},{key:"enableAll",value:function(){this.setLevel(this.logLevels.TRACE)}},{key:"disableAll",value:function(){this.setLevel(this.logLevels.SILENT)}},{key:"getLogs",value:function(){return this.storeLogs?this.storedLogs:(this.log.WARN(Ye.LOGS_NOT_STORED),null)}},{key:"clearLogs",value:function(){this.log.INFO(Ye.LOGS_CLEARED),this.storedLogs=[]}}],r&&st(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),ut=new ct;ct.prototype.log={TRACE:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];it.apply(void 0,[ut,ut.logLevels.TRACE].concat(t))},DEBUG:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];it.apply(void 0,[ut,ut.logLevels.DEBUG].concat(t))},INFO:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];it.apply(void 0,[ut,ut.logLevels.INFO].concat(t))},WARN:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];it.apply(void 0,[ut,ut.logLevels.WARN].concat(t))},ERROR:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];it.apply(void 0,[ut,ut.logLevels.ERROR].concat(t))}};const pt=ut;var lt=function(){var e=arguments[0];if("function"==typeof e){var t=Array.prototype.slice.call(arguments,1);e.apply(null,t)}},dt=function(e){return"number"==typeof e},ft=function(e){return"function"==typeof e},ht=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};function mt(e){return mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mt(e)}var vt=function(e){var t={video:e.video,audio:e.audio,fake:e.fake};if(e.screen)t={video:e.video,audio:e.audio,screen:!0,attributes:e.screenAttributes,fake:e.fake};else{var r=15,n=15;void 0!==e.attributes.minFrameRate&&(n=e.attributes.minFrameRate),void 0!==e.attributes.maxFrameRate&&(r=e.attributes.maxFrameRate),null!==window.navigator.userAgent.match("Firefox")?!0===t.video?(t.video={width:{exact:e.videoSize[0]},height:{exact:e.videoSize[1]},framerate:{ideal:n,max:r}},e.setVideoBitRate([500,500])):"object"===mt(t.video)&&(t.video.framerate={ideal:n,max:r}):!0===t.video?(t.video={mandatory:{minWidth:e.videoSize[0],minHeight:e.videoSize[1],maxWidth:e.videoSize[2],maxHeight:e.videoSize[3],minFrameRate:n,maxFrameRate:r}},e.setVideoBitRate([500,500])):"object"===mt(t.video)&&void 0!==t.video.mandatory&&(t.video.mandatory.maxFrameRate=r,t.video.mandatory.minFrameRate=n),void 0!==e.options.cameraId&&""!==e.options.cameraId&&(t.video.optional=[{sourceId:e.options.cameraId}]),void 0!==e.options.microphoneId&&""!==e.options.microphoneId&&(t.audio=[{sourceId:e.options.microphoneId}])}return t};function yt(e){return yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yt(e)}function gt(){gt=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function p(e,t,r,n){var i=t&&t.prototype instanceof y?t:y,a=Object.create(i.prototype),s=new T(n||[]);return o(a,"_invoke",{value:P(e,r,s)}),a}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=p;var d="suspendedStart",f="suspendedYield",h="executing",m="completed",v={};function y(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(j([])));S&&S!==r&&n.call(S,a)&&(w=S);var k=b.prototype=y.prototype=Object.create(w);function x(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function R(e,t){function r(o,i,a,s){var c=l(e[o],e,i);if("throw"!==c.type){var u=c.arg,p=u.value;return p&&"object"==yt(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(p).then((function(e){u.value=e,a(u)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function P(t,r,n){var o=d;return function(i,a){if(o===h)throw new Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=C(s,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=h;var u=l(t,r,n);if("normal"===u.type){if(o=n.done?m:f,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=m,n.method="throw",n.arg=u.arg)}}}function C(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=l(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function j(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(yt(t)+" is not iterable")}return g.prototype=b,o(k,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,c,"GeneratorFunction")),e.prototype=Object.create(k),e},t.awrap=function(e){return{__await:e}},x(R.prototype),u(R.prototype,s,(function(){return this})),t.AsyncIterator=R,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new R(p(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},x(k),u(k,c,"Generator"),u(k,a,(function(){return this})),u(k,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=j,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;E(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:j(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),v}},t}function bt(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function wt(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){bt(i,n,o,a,s,"next",e)}function s(e){bt(i,n,o,a,s,"throw",e)}a(void 0)}))}}function _t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==yt(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==yt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===yt(o)?o:String(o)),n)}var o}function St(e,t){return St=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},St(e,t)}function kt(e){return kt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},kt(e)}const xt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&St(e,t)}(c,e);var t,r,n,o,i,a,s=(i=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=kt(i);if(a){var r=kt(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===yt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=s.call(this)).options=e||{},t.stream=e.stream,t.audioStream=void 0,t.url=e.url,t.onClose=void 0,t.local=!1,t.video=Boolean(e.video),t.audio=Boolean(e.audio),t.screen=Boolean(e.screen),t.screenAttributes={width:1920,height:1080,maxFr:5,minFr:1},t.videoSize=e.videoSize,t.attributes=e.attributes||{},t.videoEnabled=!0,t.audioEnabled=!0,t.videoConsumer=null,t.audioConsumer=null,t.playerShowing=!1,void 0!==e.local&&!0!==e.local||(t.local=!0),void 0!==t.videoSize||t.videoSize instanceof Array&&4===t.videoSize.length||(t.videoSize=[640,480,640,480]),t.initialized=!t.local,t.unmuteAudio=void 0,t.muteAudio=void 0,t.unmuteVideo=void 0,t.muteVideo=void 0,t}return t=c,r=[{key:"initFailed",value:function(e,t,r){var n=this;switch((r={type:"error",msg:r.name||r}).msg){case"Starting video failed":case"TrackStartError":if(this.setVideo("unspecified"),this.videoSize=void 0,this.loopNum>0)return void setTimeout((function(){n.init(e,t)}),1);r.msg="MEDIA_OPTION_INVALID";break;case"DevicesNotFoundError":r.msg="DEVICES_NOT_FOUND";break;case"NotSupportedError":r.msg="NOT_SUPPORTED";break;case"PermissionDeniedError":r.msg="PERMISSION_DENIED";break;case"PERMISSION_DENIED":break;case"ConstraintNotSatisfiedError":r.msg="CONSTRAINT_NOT_SATISFIED";break;default:r.msg||(r.msg="UNDEFINED")}lt(t,r)}},{key:"init",value:function(e,t){var r=this;if(!0===this.initialized)return lt(t,{type:"warning",msg:"STREAM_ALREADY_INITIALIZED"});if(!0!==this.local)return lt(t,{type:"warning",msg:"STREAM_NOT_LOCAL"});if(!(this.audio||this.video||this.screen)||void 0!==this.url)return lt(t,{type:"warning",msg:"STREAM_HAS_NO_MEDIA_ATTRIBUTES"});try{var n=vt(this);Cr.getUserMedia(n,(function(t,n){r.stream=t,r.audioStream=n,r.initialized=!0,lt(e),pt.log.INFO("getUserMedia sucess",r.allMediaTrack())}),(function(n){r.initFailed(e,t,n)}))}catch(e){return lt(t,{type:"error",msg:e.message||e})}}},{key:"setLocalStreamTrack",value:(o=wt(gt().mark((function e(){var t,r,n,o=this;return gt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.stream){e.next=2;break}return e.abrupt("return",!1);case 2:if(t=!1,this.video&&(r=this.getVideoTracks()[0],t=r&&"ended"===r.readyState),!t&&this.audio&&(n=this.getAudioTracks()[0],t=n&&"ended"===n.readyState),t){e.next=8;break}return pt.log.INFO(["setLocalStreamTrack",t],this.allMediaTrack()),e.abrupt("return",!1);case 8:return e.abrupt("return",new Promise((function(e,r){var n=vt(o);Cr.getUserMedia(n,(function(r,n){o.stream=r,o.audioStream=n,pt.log.INFO(["setLocalStreamTrack sucess",t],o.allMediaTrack()),e()}),(function(e){pt.log.INFO(["setLocalStreamTrack failed",t],e),r({error:e,type:"getUserMedia"})}))})));case 9:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"allMediaTrack",value:function(){return{audioTrack:this.getAudioTracks(),videoTrack:this.getVideoTracks()}}},{key:"stopTrack",value:function(e){if(!e)return!1}},{key:"close",value:function(){this.stopTrack(this.stream),this.stopTrack(this.audioStream),this.stream=void 0,this.audioStream=void 0,this.initialized=!1,this.unmuteAudio=void 0,this.muteAudio=void 0,this.unmuteVideo=void 0,this.muteVideo=void 0,this.closeConsumer(this.videoConsumer),this.closeConsumer(this.audioConsumer),void 0!==this.pc&&this.pc.close&&this.pc.close(),this.pc=void 0}},{key:"closeConsumer",value:function(e){if(!e)return!1;"video"===e.kind?(this.videoConsumer=null,this.videoRemoteData=null,this.video=!1,this.screen=!1):"audio"===e.kind&&(this.audioConsumer=null,this.audioRemoteData=null,this.audio=!1)}},{key:"setRemoteStream",value:function(e,t,r){var n=t.type,o=t.producerPaused,i=r.parseScalabilityMode(e.rtpParameters.encodings[0].scalabilityMode),a=i.spatialLayers,s=i.temporalLayers,c={id:e.id,type:n,locallyPaused:!1,remotelyPaused:o,rtpParameters:e.rtpParameters,spatialLayers:a,temporalLayers:s,preferredSpatialLayer:a-1,preferredTemporalLayer:s-1,priority:1,codec:e.rtpParameters.codecs[0].mimeType.split("/")[1],track:e.track};"video"===e.kind?(this.videoConsumer=e,this.videoRemoteData=c,this.screen||(this.video=!0)):"audio"===e.kind&&(this.audioConsumer=e,this.audioRemoteData=c,this.audio=!0)}},{key:"getAudioStream",value:function(){if(!this.local){var e=this.audioConsumer&&this.audioConsumer.track||null,t=new MediaStream;return e||pt.log.ERROR("getVideoStream no track",{track:e}),e&&t.addTrack(e),t}return this.local&&this.screen?this.audioStream:this.stream}},{key:"getVideoStream",value:function(){if(!this.local){var e=this.videoConsumer&&this.videoConsumer.track||null;e||pt.log.ERROR("getVideoStream no track",{track:e});var t=new MediaStream;return e&&t.addTrack(e),t}return this.stream}},{key:"getVideoTracks",value:function(){return this.getVideoStream().getVideoTracks()}},{key:"getAudioTracks",value:function(){return this.getAudioStream().getAudioTracks()}},{key:"hasVideoeEabled",value:function(){return(this.hasVideo()||this.hasScreen())&&this.getVideoTracks()[0].enabled||!1}},{key:"hasAudioEabled",value:function(){return this.hasAudio()&&this.getVideoTracks()[0].enabled||!1}},{key:"enableAudio",value:function(){return this.hasAudioEabled()||(void 0!==this.unmuteAudio&&this.unmuteAudio(),this.audioEnabled=!0,this.getAudioTracks()[0].enabled=!0),!1}},{key:"disableAudio",value:function(){return this.hasAudioEabled()&&(void 0!==this.muteAudio&&this.muteAudio(),this.audioEnabled=!1,this.getAudioTracks()[0].enabled=!1),!1}},{key:"enableVideo",value:function(){return this.hasVideoeEabled()||(void 0!==this.unmuteVideo&&this.unmuteVideo(),this.videoEnabled=!0,this.getVideoTracks()[0].enabled=!0),!1}},{key:"disableVideo",value:function(){return this.hasVideoeEabled()&&(void 0!==this.muteVideo&&this.muteVideo(),this.videoEnabled=!1,this.getVideoTracks()[0].enabled=!1),!1}},{key:"play",value:(n=wt(gt().mark((function e(t){var r,n,o=this;return gt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.elementID=t,this.playerShowing=!0,r=[],n=new Promise((function(e){e(null)})),pt.log.INFO(["play---player",this.getId()],{elementID:t,playerShowing:this.playerShowing}),this.playerVideo||!this.video&&!this.screen?r.push(n):(pt.log.INFO(["play---playerVideo- start",this.getId()],{media:this.playerVideo}),this.playerVideo=Cr.videoPlayer({id:this.getId(),stream:this,elementID:t,options:void 0}),r.push(this.playerVideo.mediaPlay()),pt.log.INFO(["play---playerVideo- end",this.getId()],{media:this.playerVideo})),!this.playerAudio&&this.hasAudio()?(pt.log.INFO(["play---playerAudio- start",this.getId()],{media:this.playerAudio}),this.playerAudio=Cr.audioPlayer({id:this.getId(),stream:this,elementID:t,options:void 0}),r.push(this.playerAudio.mediaPlay()),pt.log.INFO(["play---playerAudio- end",this.getId()],{media:this.playerAudio})):r.push(n),e.abrupt("return",new Promise((function(e,t){var n={video:null,audio:null};pt.log.INFO(["play---return allPromise success",o.getId()],r),Promise.all(r).then((function(t){n.video=t[0],n.audio=t[1],pt.log.INFO(["play---return statu success",o.getId()],n),e(n)})).catch((function(e){pt.log.ERROR(["play---return statu failed",o.getId()],{error:e}),t(e)}))})));case 8:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"stop",value:function(){this.playerVideo&&this.playerVideo.destroy(),this.playerAudio&&this.playerAudio.destroy(),this.playerVideo=void 0,this.playerAudio=void 0,this.playerShowing=null}},{key:"setVideoResolution",value:function(e){return void 0!==this[e]&&(this.options.attributes=this.options.attributes||{},this.options.attributes.resolution=e,!0)}},{key:"setVideoFrameRate",value:function(e){return"object"===yt(e)&&e instanceof Array&&1<e.length&&(this.options.attributes=this.options.attributes||{},this.options.attributes.minFrameRate=e[0],this.options.attributes.maxFrameRate=e[1],!0)}},{key:"setVideoBitRate",value:function(e){return"object"===yt(e)&&e instanceof Array&&1<e.length&&(this.options.attributes=this.options.attributes||{},this.options.attributes.minVideoBW=e[0],this.options.attributes.maxVideoBW=e[1],!0)}},{key:"setScreenProfile",value:function(e){if("string"==typeof e){switch(e){case"480p_1":this.screenAttributes.width=640,this.screenAttributes.height=480,this.screenAttributes.maxFr=5,this.screenAttributes.minFr=1;break;case"480p_2":this.screenAttributes.width=640,this.screenAttributes.height=480,this.screenAttributes.maxFr=30,this.screenAttributes.minFr=25;break;case"720p_1":this.screenAttributes.width=1280,this.screenAttributes.height=720,this.screenAttributes.maxFr=5,this.screenAttributes.minFr=1;break;case"720p_2":this.screenAttributes.width=1280,this.screenAttributes.height=720,this.screenAttributes.maxFr=30,this.screenAttributes.minFr=25;break;case"1080p_1":this.screenAttributes.width=1920,this.screenAttributes.height=1080,this.screenAttributes.maxFr=5,this.screenAttributes.minFr=1;break;case"1080p_2":this.screenAttributes.width=1920,this.screenAttributes.height=1080,this.screenAttributes.maxFr=30,this.screenAttributes.minFr=25}return!0}return!1}},{key:"setVideoProfile",value:function(e){if("string"==typeof e){switch(e){case"120p_1":this.setVideoResolution("120p"),this.setVideoFrameRate([15,15]),this.setVideoBitRate([10,80]);break;case"240p_1":this.setVideoResolution("240p"),this.setVideoFrameRate([15,15]),this.setVideoBitRate([10,200]);break;case"480p_1":default:this.setVideoResolution("480p"),this.setVideoFrameRate([15,15]),this.setVideoBitRate([20,500]);break;case"480p_2":this.setVideoResolution("480p"),this.setVideoFrameRate([30,30]),this.setVideoBitRate([20,1e3]);break;case"480p_3":this.setVideoResolution("480p"),this.setVideoFrameRate([25,25]),this.setVideoBitRate([20,750]);break;case"720p_1":this.setVideoResolution("720p"),this.setVideoFrameRate([15,15]),this.setVideoBitRate([30,1e3]);break;case"720p_2":this.setVideoResolution("720p"),this.setVideoFrameRate([30,30]),this.setVideoBitRate([30,2e3]);break;case"720p_3":this.setVideoResolution("720p"),this.setVideoFrameRate([25,25]),this.setVideoBitRate([30,1500]);break;case"1080p_1":this.setVideoResolution("1080p"),this.setVideoFrameRate([15,15]),this.setVideoBitRate([50,1500]);break;case"1080p_2":this.setVideoResolution("1080p"),this.setVideoFrameRate([30,30]),this.setVideoBitRate([50,3e3])}return!0}return!1}},{key:"getId",value:function(){return this.options.streamID}},{key:"getAttributes",value:function(){return this.attributes}},{key:"hasAudio",value:function(){return this.audio}},{key:"hasVideo",value:function(){return this.video}},{key:"hasScreen",value:function(){return this.screen}},{key:"isVideoOn",value:function(){return(this.hasVideo()||this.hasScreen())&&this.videoEnabled}},{key:"isAudioOn",value:function(){return this.hasAudio()&&this.audioEnabled}},{key:"isPlaying",value:function(){return this.playerShowing}},{key:"unmutePlayerAudio",value:function(){try{this.playerAudio&&this.playerAudio.mediaPause(),this.audioConsumer&&this.audioConsumer.pause()}catch(e){pt.log.ERROR("unmutePlayerAudio() | failed",e)}}},{key:"mutePlayerAudio",value:function(){try{this.playerAudio&&this.playerAudio.mediaResume(),this.audioConsumer&&this.audioConsumer.resume()}catch(e){pt.log.ERROR("mutePlayerAudio() | failed",e)}}},{key:"unmutePlayerVideo",value:function(){try{this.playerVideo&&this.playerVideo.mediaPause(),this.videoConsumer&&this.videoConsumer.pause()}catch(e){pt.log.ERROR("unmutePlayerVideo() | failed",e)}}},{key:"mutePlayerVideo",value:function(){try{this.playerVideo&&this.playerVideo.mediaResume(),this.videoConsumer&&this.videoConsumer.resume()}catch(e){pt.log.ERROR("mutePlayerVideo() | failed",e)}}}],r&&_t(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),c}(tt);var Rt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new Ue(e.type,e);return t.stream=e.stream,t.msg=e.msg,t},Pt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new Ue(e.type,e);return t.uid=e.uid,t.attr=e.attr,t.stream=e.stream,t},Ct=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new Ue(e.type,e);return t.msg=e.msg,t},Ot=r(1733);function Et(e){return Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Et(e)}function Tt(){Tt=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function p(e,t,r,n){var i=t&&t.prototype instanceof y?t:y,a=Object.create(i.prototype),s=new T(n||[]);return o(a,"_invoke",{value:P(e,r,s)}),a}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=p;var d="suspendedStart",f="suspendedYield",h="executing",m="completed",v={};function y(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(j([])));S&&S!==r&&n.call(S,a)&&(w=S);var k=b.prototype=y.prototype=Object.create(w);function x(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function R(e,t){function r(o,i,a,s){var c=l(e[o],e,i);if("throw"!==c.type){var u=c.arg,p=u.value;return p&&"object"==Et(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(p).then((function(e){u.value=e,a(u)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function P(t,r,n){var o=d;return function(i,a){if(o===h)throw new Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=C(s,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=h;var u=l(t,r,n);if("normal"===u.type){if(o=n.done?m:f,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=m,n.method="throw",n.arg=u.arg)}}}function C(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=l(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function j(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(Et(t)+" is not iterable")}return g.prototype=b,o(k,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,c,"GeneratorFunction")),e.prototype=Object.create(k),e},t.awrap=function(e){return{__await:e}},x(R.prototype),u(R.prototype,s,(function(){return this})),t.AsyncIterator=R,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new R(p(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},x(k),u(k,c,"Generator"),u(k,a,(function(){return this})),u(k,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=j,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;E(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:j(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),v}},t}function jt(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}var Dt=function(){var e,t=(e=Tt().mark((function e(t,r){var n,o,i,a,s,c,u,p,l,d,f,h,m,v,y,g,b,w,_,S,k;return Tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:pt.log.INFO("IO notificationEvent()",this,t),e.t0=t.method,e.next="producerScore"===e.t0?4:"newPeer"===e.t0?6:"peerClosed"===e.t0?8:"peerDisplayNameChanged"===e.t0?17:"downlinkBwe"===e.t0?19:"consumerClosed"===e.t0?21:"consumerPaused"===e.t0?30:"consumerResumed"===e.t0?38:"consumerLayersChanged"===e.t0?46:"consumerScore"===e.t0?51:"dataConsumerClosed"===e.t0?53:"activeSpeaker"===e.t0?61:63;break;case 4:return(n=t.data).producerId,n.score,e.abrupt("break",64);case 6:return t.data,e.abrupt("break",64);case 8:if(o=t.data.peerId,i=r.remoteStreams[o]){e.next=12;break}return e.abrupt("break",64);case 12:return a=Pt({type:"peer-leave",uid:o,stream:i}),r.dispatchEvent(a),i.close(),delete r.remoteStreams[o],e.abrupt("break",64);case 17:return(s=t.data).peerId,s.displayName,s.oldDisplayName,e.abrupt("break",64);case 19:return pt.log.INFO("'downlinkBwe' event:%o",t.data),e.abrupt("break",64);case 21:if(c=t.data.consumerId,u=this._consumers.get(c),p=u.appData.peerId,l=r.remoteStreams[p]){e.next=27;break}return e.abrupt("break",64);case 27:return l.closeConsumer(u),l.hasVideo()||l.hasAudio()||l.hasScreen()||(delete r.remoteStreams[p],d=Rt({type:"stream-removed",stream:l}),r.dispatchEvent(d),l.close()),e.abrupt("break",64);case 30:if(f=t.data.consumerId,h=this._consumers.get(f),m=h.appData.peerId,r.remoteStreams[m]){e.next=36;break}return e.abrupt("break",64);case 36:return h.pause(),e.abrupt("break",64);case 38:if(v=t.data.consumerId,y=this._consumers.get(v),g=y.appData.peerId,r.remoteStreams[g]){e.next=44;break}return e.abrupt("break",64);case 44:return y.resume(),e.abrupt("break",64);case 46:if(b=t.data,w=b.consumerId,b.spatialLayer,b.temporalLayer,this._consumers.get(w)){e.next=50;break}return e.abrupt("break",64);case 50:return e.abrupt("break",64);case 51:return(_=t.data).consumerId,_.score,e.abrupt("break",64);case 53:if(S=t.data.dataConsumerId,k=this._dataConsumers.get(S)){e.next=57;break}return e.abrupt("break",64);case 57:return k.close(),this._dataConsumers.delete(S),k.appData.peerId,e.abrupt("break",64);case 61:return t.data.peerId,e.abrupt("break",64);case 63:pt.log.ERROR('unknown protoo response.method "%s"',t.method);case 64:case"end":return e.stop()}}),e,this)})),function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){jt(i,n,o,a,s,"next",e)}function s(e){jt(i,n,o,a,s,"throw",e)}a(void 0)}))});return function(e,r){return t.apply(this,arguments)}}();function Lt(e){return Lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lt(e)}function It(){It=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function p(e,t,r,n){var i=t&&t.prototype instanceof y?t:y,a=Object.create(i.prototype),s=new T(n||[]);return o(a,"_invoke",{value:P(e,r,s)}),a}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=p;var d="suspendedStart",f="suspendedYield",h="executing",m="completed",v={};function y(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(j([])));S&&S!==r&&n.call(S,a)&&(w=S);var k=b.prototype=y.prototype=Object.create(w);function x(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function R(e,t){function r(o,i,a,s){var c=l(e[o],e,i);if("throw"!==c.type){var u=c.arg,p=u.value;return p&&"object"==Lt(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(p).then((function(e){u.value=e,a(u)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function P(t,r,n){var o=d;return function(i,a){if(o===h)throw new Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=C(s,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=h;var u=l(t,r,n);if("normal"===u.type){if(o=n.done?m:f,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=m,n.method="throw",n.arg=u.arg)}}}function C(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=l(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function j(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(Lt(t)+" is not iterable")}return g.prototype=b,o(k,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,c,"GeneratorFunction")),e.prototype=Object.create(k),e},t.awrap=function(e){return{__await:e}},x(R.prototype),u(R.prototype,s,(function(){return this})),t.AsyncIterator=R,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new R(p(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},x(k),u(k,c,"Generator"),u(k,a,(function(){return this})),u(k,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=j,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;E(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:j(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),v}},t}function Mt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function At(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Mt(Object(r),!0).forEach((function(t){var n,o,i;n=e,o=t,i=r[t],(o=function(e){var t=function(e,t){if("object"!==Lt(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==Lt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Lt(t)?t:String(t)}(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Mt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Nt(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function Ft(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){Nt(i,n,o,a,s,"next",e)}function s(e){Nt(i,n,o,a,s,"throw",e)}a(void 0)}))}}var Bt=function(){var e=Ft(It().mark((function e(t,r,n){var o,i,a,s,c,u,p,l,d,f,h,m=this;return It().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.peerId,i=t.producerId,a=t.id,s=t.kind,c=t.rtpParameters,t.type,u=t.appData,p=t.producerPaused,e.prev=1,e.next=4,this._recvTransport.consume({id:a,producerId:i,kind:s,rtpParameters:c,appData:At(At({},u),{},{peerId:o})});case 4:l=e.sent,this._consumers.set(l.id,l),l.on("transportclose",(function(){m._consumers.delete(l.id)})),d=function(e){window.clearTimeout(m.throttleTime),e.initAddEvent=!0,pt.log.INFO(["play---remoteStream create start",o],e);var t=Rt({type:"stream-added",stream:e});r.dispatchEvent(t),pt.log.INFO(["play---remoteStream create end",o],e)},void 0===r.remoteStreams[o]?((f=Cr.createStream({streamID:o,local:!1,screen:u.screen,attributes:u.attributes})).setRemoteStream(l,t,n),r.remoteStreams[o]=f,d(f)):((h=r.remoteStreams[o]).setRemoteStream(l,t,n),h.playerShowing?(pt.log.INFO(["play---remoteStream YES playerShowing start",o],h),h.stop(),h.play(h.elementID),pt.log.INFO(["play---remoteStream YES playerShowing end",o],h)):pt.log.INFO(["play---remoteStream NO playerShowing",o],h)),"paused"===p&&this._pauseConsumer(l),e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(1),pt.log.ERROR('"newConsumer" request failed:%o',e.t0),e.t0;case 16:case"end":return e.stop()}}),e,this,[[1,12]])})));return function(t,r,n){return e.apply(this,arguments)}}(),Gt=function(){var e=Ft(It().mark((function e(t,r,n){var o,i,a,s,c,u,p,l,d=this;return It().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.peerId,i=t.dataProducerId,a=t.id,s=t.sctpStreamParameters,c=t.label,u=t.protocol,p=t.appData,e.prev=1,e.next=4,this._recvTransport.consumeData({id:a,dataProducerId:i,sctpStreamParameters:s,label:c,protocol:u,appData:At(At({},p),{},{peerId:o})});case 4:l=e.sent,this._dataConsumers.set(l.id,l),l.on("transportclose",(function(){d._dataConsumers.delete(l.id)})),l.on("open",(function(){pt.log.INFO('DataConsumer "open" event')})),l.on("close",(function(){pt.log.WARN('DataConsumer "close" event'),d._dataConsumers.delete(l.id)})),l.on("error",(function(e){pt.log.ERROR('DataConsumer "error" event:%o',e)})),l.on("message",(function(e){if(pt.log.INFO('DataConsumer "message" event [streamId:%d]',l.sctpStreamParameters.streamId),window.DC_MESSAGE=e,e instanceof ArrayBuffer){var t=new DataView(e).getUint32();return t==Math.pow(2,32)-1?(pt.log.WARN("dataChannelTest finished!"),void(d._nextDataChannelTestNumber=0)):(t>d._nextDataChannelTestNumber&&pt.log.WARN("dataChannelTest: %s packets missing",t-d._nextDataChannelTestNumber),void(d._nextDataChannelTestNumber=t+1))}"string"==typeof e?l.label:pt.log.WARN('ignoring DataConsumer "message" (not a string)')})),window.DC=l,e.next=18;break;case 14:throw e.prev=14,e.t0=e.catch(1),pt.log.ERROR('"newDataConsumer" request failed:%o',e.t0),e.t0;case 18:case"end":return e.stop()}}),e,this,[[1,14]])})));return function(t,r,n){return e.apply(this,arguments)}}(),Vt=function(){var e=Ft(It().mark((function e(t,r,n,o,i){var a;return It().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:pt.log.INFO("IO requestEvent()",this,t),a=t.data,e.t0=t.method,e.next="newConsumer"===e.t0?5:"newDataConsumer"===e.t0?8:17;break;case 5:return Bt.call(this,a,o,i),r(),e.abrupt("break",17);case 8:if(this._consume){e.next=11;break}return n(403,"I do not want to data consume"),e.abrupt("break",17);case 11:if(this._useDataChannel){e.next=14;break}return n(403,"I do not want DataChannels"),e.abrupt("break",17);case 14:return Gt.call(this,a,r,n),r(),e.abrupt("break",17);case 17:case"end":return e.stop()}}),e,this)})));return function(t,r,n,o,i){return e.apply(this,arguments)}}(),Ut=r(5522);function qt(e){return qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qt(e)}function zt(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Wt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Wt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function Wt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Kt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ht(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Kt(Object(r),!0).forEach((function(t){var n,o,i;n=e,o=t,i=r[t],(o=Qt(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Kt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Yt(){Yt=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function p(e,t,r,n){var i=t&&t.prototype instanceof y?t:y,a=Object.create(i.prototype),s=new T(n||[]);return o(a,"_invoke",{value:P(e,r,s)}),a}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=p;var d="suspendedStart",f="suspendedYield",h="executing",m="completed",v={};function y(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(j([])));S&&S!==r&&n.call(S,a)&&(w=S);var k=b.prototype=y.prototype=Object.create(w);function x(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function R(e,t){function r(o,i,a,s){var c=l(e[o],e,i);if("throw"!==c.type){var u=c.arg,p=u.value;return p&&"object"==qt(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(p).then((function(e){u.value=e,a(u)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function P(t,r,n){var o=d;return function(i,a){if(o===h)throw new Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=C(s,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=h;var u=l(t,r,n);if("normal"===u.type){if(o=n.done?m:f,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=m,n.method="throw",n.arg=u.arg)}}}function C(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=l(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function j(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(qt(t)+" is not iterable")}return g.prototype=b,o(k,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,c,"GeneratorFunction")),e.prototype=Object.create(k),e},t.awrap=function(e){return{__await:e}},x(R.prototype),u(R.prototype,s,(function(){return this})),t.AsyncIterator=R,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new R(p(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},x(k),u(k,c,"Generator"),u(k,a,(function(){return this})),u(k,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=j,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;E(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:j(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),v}},t}function $t(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function Jt(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){$t(i,n,o,a,s,"next",e)}function s(e){$t(i,n,o,a,s,"throw",e)}a(void 0)}))}}function Xt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qt(n.key),n)}}function Qt(e){var t=function(e,t){if("object"!==qt(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==qt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===qt(t)?t:String(t)}const Zt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.socket=void 0,this.client=null,this.timeRelink=null,this.ioSuccessFN=null,this.ioFailedFN=null,this._mediasoupDevice=null,this.ioTimeMap={},this._consumers=new Map}var t,r,n,o,i,a,s,c,u,p,l,d,f,h,m,v,y,g,b,w,_,S,k,x,R,P,C,O,E,T,j,D,L,I,M,A,N,F,B,G,V,U,q,z,W,K,H;return t=e,r=[{key:"link",value:function(e){var t=function(e){var t=e.host,r=void 0===t?"":t,n=e.roomId,o=e.peerId,i=e.consumerReplicas;"https:"==document.location.protocol&&(r=r&&r.replace("http","https"));var a=window.location.hostname,s=r||"".concat(a,":").concat(4443);return"wss://".concat(s,"/?roomId=").concat(n,"&peerId=").concat(o,"&consumerReplicas=").concat(i,"&token=token&time=1702515166518&EIO=3&transport=websocket")}({host:e.host,roomId:e.channel,peerId:e.uid,consumerReplicas:""}),r=new Ut.qo(t);this.socket=new Ut._z(r),pt.log.INFO(["io link _protoo"],this.socket)}},{key:"callbackSuccess",value:function(e,t){this.ioSuccessFN&&(this.ioSuccessFN=null,lt(e,t))}},{key:"callbackFailed",value:function(e,t){this.ioFailedFN&&(this.ioFailedFN=null,lt(e,t||He.FALIED_LINK))}},{key:"reConnect",value:function(){var e=this;if(pt.log.INFO(["io reConnect"],this),!this.client)return this.disconnect(),!1;var t=this.client.token,r=this.client.channel,n=this.client.uid;this.client.join(t,r,n,this.ioSuccessFN||function(t){if(void 0!==e.client.localStreams[t]){var r=e.client.localStreams[t];delete e.client.localStreams[t],void 0!==r.pc&&(r.pc.close(),r.pc=void 0),e.client.publish(r,(function(){}),(function(){}))}},this.ioFailedFN||function(){})}},{key:"connect",value:(H=Jt(Yt().mark((function e(t,r,n){var o=this;return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===this.socket){e.next=2;break}return e.abrupt("return",this.socket.connect());case 2:this.client=t,this.ioSuccessFN=r,this.ioFailedFN=n,this.link(t),this.socket.on("open",(function(e){pt.log.INFO(["io open",e],o),t.attemps=1,t.state=2,o._joinRoom(r,n)})),this.socket.on("failed",(function(e){pt.log.INFO(["io failed",t.attemps,e],o)})),this.socket.on("disconnected",(function(e){if(pt.log.INFO(["io disconnect",t.attemps,e],o),0!==t.state){for(var r in t.timers)ht(t.timers,r)&&clearInterval(t.timers[r]);for(var i in t.remoteStreams)if(ht(t.remoteStreams,i)){var a=t.remoteStreams[i],s=Pt({type:"stream-removed",uid:a.getId(),stream:a});t.dispatchEvent(s),delete t.remoteStreams[i],void 0!==a.pc&&(a.pc.close(),a.pc=void 0)}o._sendTransport&&(o._sendTransport.close(),o._sendTransport=null),o._recvTransport&&(o._recvTransport.close(),o._recvTransport=null),t.state=0,o.socket.destroy(),o.socket=void 0,lt(n,$e.ERROR_CODES.SOCKET_DISCONNECTED),o.timeRelink=window.setTimeout((function(){t.attemps++,o.reConnect()}),1e3)}})),this.socket.on("close",(function(){o._closed||o.disconnect()})),this.socket.on("failed",(function(e){var r=Ct({type:"error",msg:e});t.dispatchEvent(r)})),this.socket.on("request",function(){var e=Jt(Yt().mark((function e(r,n,i){return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return pt.log.INFO('IO "request" event',r.method,r.data),e.next=3,Vt.call(o,r,n,i,t,Ot);case 3:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()),this.socket.on("notification",(function(e){pt.log.INFO('IO "notification" event ',e.method,e.data),Dt.call(o,e,t)}));case 14:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return H.apply(this,arguments)})},{key:"_joinRoom",value:(K=Jt(Yt().mark((function e(t,r){var n,o,i;return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return pt.log.INFO(["io _joinRoom"],this),e.prev=1,this._mediasoupDevice=new Ot.Device,e.next=5,this.request("getRouterRtpCapabilities");case 5:return n=e.sent,e.next=8,this._mediasoupDevice.load({routerRtpCapabilities:n});case 8:return e.next=10,this._consumeRoom();case 10:return e.next=12,this.request("join",{displayName:this.client.uid,rtpCapabilities:this._mediasoupDevice.rtpCapabilities,sctpCapabilities:this._mediasoupDevice.sctpCapabilities});case 12:o=e.sent,i=o.peers,this.client.peers=i,this.callbackSuccess(t,this.client.uid),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(1),this.callbackFailed(r,e.t0),this.disconnect();case 22:case"end":return e.stop()}}),e,this,[[1,18]])}))),function(e,t){return K.apply(this,arguments)})},{key:"_produceRoom",value:(W=Jt(Yt().mark((function e(t,r){var n,o,i,a,s,c,u=this;return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return pt.log.INFO(["io _produceRoom"],t),e.prev=1,e.next=4,this.request("createWebRtcTransport",{forceTcp:this._forceTcp,producing:!0,consuming:!1,sctpCapabilities:this._mediasoupDevice.sctpCapabilities});case 4:return n=e.sent,o=n.id,i=n.iceParameters,a=n.iceCandidates,s=n.dtlsParameters,c=n.sctpParameters,this._sendTransport=this._mediasoupDevice.createSendTransport({id:o,iceParameters:i,iceCandidates:a,dtlsParameters:s,sctpParameters:c,iceServers:[]}),this._sendTransport.on("connect",(function(e,t,r){var n=e.dtlsParameters;u.request("connectWebRtcTransport",{transportId:u._sendTransport.id,dtlsParameters:n}).then(t).catch(r)})),this._sendTransport.on("produce",function(){var e=Jt(Yt().mark((function e(t,r,n){var o,i,a,s,c;return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.kind,i=t.rtpParameters,a=t.appData,e.prev=1,e.next=4,u.request("produce",{transportId:u._sendTransport.id,kind:o,rtpParameters:i,appData:a});case 4:s=e.sent,c=s.id,r({id:c}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),n(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,r,n){return e.apply(this,arguments)}}()),this._sendTransport.on("producedata",function(){var e=Jt(Yt().mark((function e(t,r,n){var o,i,a,s,c,p;return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.sctpStreamParameters,i=t.label,a=t.protocol,s=t.appData,e.prev=1,e.next=4,u.request("produceData",{transportId:u._sendTransport.id,sctpStreamParameters:o,label:i,protocol:a,appData:s});case 4:c=e.sent,p=c.id,r({id:p}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),n(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,r,n){return e.apply(this,arguments)}}()),e.next=12,t.setLocalStreamTrack();case 12:if(!t.video){e.next=17;break}return e.next=15,this.enableWebcam(t);case 15:e.next=20;break;case 17:if(!t.screen){e.next=20;break}return e.next=20,this.enableShare(t);case 20:if(!t.audio){e.next=23;break}return e.next=23,this.enableMic(t);case 23:this._sendTransport.on("connectionstatechange",(function(e){"connected"===e&&(u.enableChatDataProducer(),u.enableBotDataProducer())})),t.pc.onsignalingmessage(t),e.next=30;break;case 27:e.prev=27,e.t0=e.catch(1),lt(r,e.t0);case 30:case"end":return e.stop()}}),e,this,[[1,27]])}))),function(e,t){return W.apply(this,arguments)})},{key:"_unProduceRoom",value:(z=Jt(Yt().mark((function e(t,r,n){return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.video){e.next=5;break}return e.next=3,this.disableWebcam(t);case 3:e.next=8;break;case 5:if(!t.screen){e.next=8;break}return e.next=8,this.disableShare(t);case 8:if(!t.audio){e.next=11;break}return e.next=11,this.disableMic(t);case 11:this._sendTransport&&this._sendTransport.close(),lt(r);case 13:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return z.apply(this,arguments)})},{key:"_consumeRoom",value:(q=Jt(Yt().mark((function e(t){var r,n,o,i,a,s,c=this;return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.request("createWebRtcTransport",{forceTcp:this._forceTcp,producing:!1,consuming:!0,sctpCapabilities:this._mediasoupDevice.sctpCapabilities});case 3:r=e.sent,n=r.id,o=r.iceParameters,i=r.iceCandidates,a=r.dtlsParameters,s=r.sctpParameters,this._recvTransport=this._mediasoupDevice.createRecvTransport({id:n,iceParameters:o,iceCandidates:i,dtlsParameters:a,sctpParameters:s,iceServers:[]}),this._recvTransport.on("connect",(function(e,t,r){var n=e.dtlsParameters;c.request("connectWebRtcTransport",{transportId:c._recvTransport.id,dtlsParameters:n}).then(t).catch(r)})),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),lt(t,e.t0),pt.log.INFO("_consumeRoom()",e.t0);case 13:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(e){return q.apply(this,arguments)})},{key:"enableShare",value:(U=Jt(Yt().mark((function e(t){var r,n,o=this;return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(pt.log.INFO("enableShare()"),!this._shareProducer){e.next=5;break}return e.abrupt("return");case 5:if(!this._webcamProducer){e.next=8;break}return e.next=8,this.disableWebcam();case 8:return e.prev=8,pt.log.INFO("enableShare() | calling getUserMedia()"),r=t.getVideoTracks()[0],n={videoGoogleStartBitrate:1e3},e.next=14,this._sendTransport.produce({track:r,encodings:void 0,codecOptions:n,codec:void 0,appData:{share:!0}});case 14:this._shareProducer=e.sent,this._shareProducer.on("transportclose",(function(){o._shareProducer=null})),this._shareProducer.on("trackended",(function(){pt.log.ERROR("enableShare() Share disconnected!"),o.disableShare().catch((function(){}))})),e.next=23;break;case 19:e.prev=19,e.t0=e.catch(8),pt.log.ERROR("enableShare() | failed:%o",e.t0),r&&r.stop();case 23:case"end":return e.stop()}}),e,this,[[8,19]])}))),function(e){return U.apply(this,arguments)})},{key:"disableShare",value:(V=Jt(Yt().mark((function e(){return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(pt.log.INFO("disableShare()"),this._shareProducer){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,this._shareProducer.close(),e.next=7,this.request("closeProducer",{producerId:this._shareProducer.id});case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),pt.log.ERROR("disableShare() | failed:%o",e.t0);case 12:this._shareProducer=null;case 13:case"end":return e.stop()}}),e,this,[[3,9]])}))),function(){return V.apply(this,arguments)})},{key:"enableWebcam",value:(G=Jt(Yt().mark((function e(t){var r,n,o=this;return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._webcamProducer){e.next=2;break}return e.abrupt("return");case 2:return r=t.getVideoTracks()[0],e.prev=3,n={videoGoogleStartBitrate:1e3},e.next=7,this._sendTransport.produce({track:r,encodings:void 0,codecOptions:n,codec:void 0});case 7:this._webcamProducer=e.sent,this._webcamProducer.on("transportclose",(function(){o._webcamProducer=null})),this._webcamProducer.on("trackended",(function(){o.disableWebcam().catch((function(){}))})),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),r&&r.stop();case 15:case"end":return e.stop()}}),e,this,[[3,12]])}))),function(e){return G.apply(this,arguments)})},{key:"enableMic",value:(B=Jt(Yt().mark((function e(t){var r,n=this;return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._micProducer){e.next=2;break}return e.abrupt("return");case 2:return r=t.getAudioTracks()[0],e.prev=3,e.next=6,this._sendTransport.produce({track:r,codecOptions:{opusStereo:1,opusDtx:1}});case 6:this._micProducer=e.sent,this._micProducer.on("transportclose",(function(){n._micProducer=null})),this._micProducer.on("trackended",(function(){n.disableMic().catch((function(){}))})),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),r&&r.stop();case 14:case"end":return e.stop()}}),e,this,[[3,11]])}))),function(e){return B.apply(this,arguments)})},{key:"enableChatDataProducer",value:(F=Jt(Yt().mark((function e(){var t=this;return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(pt.log.INFO("enableChatDataProducer()"),this._useDataChannel){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,this._sendTransport.produceData({ordered:!1,maxRetransmits:1,label:"chat",priority:"medium",appData:{info:"my-chat-DataProducer"}});case 6:this._chatDataProducer=e.sent,this._chatDataProducer.on("transportclose",(function(){t._chatDataProducer=null})),this._chatDataProducer.on("open",(function(){pt.log.INFO('chat DataProducer "open" event')})),this._chatDataProducer.on("close",(function(){t._chatDataProducer=null})),this._chatDataProducer.on("error",(function(e){pt.log.ERROR('chat DataProducer "error" event:%o',e)})),this._chatDataProducer.on("bufferedamountlow",(function(){pt.log.INFO('chat DataProducer "bufferedamountlow" event')})),e.next=18;break;case 14:throw e.prev=14,e.t0=e.catch(3),pt.log.ERROR("enableChatDataProducer() | failed:%o",e.t0),e.t0;case 18:case"end":return e.stop()}}),e,this,[[3,14]])}))),function(){return F.apply(this,arguments)})},{key:"enableBotDataProducer",value:(N=Jt(Yt().mark((function e(){var t=this;return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(pt.log.INFO("enableBotDataProducer()"),this._useDataChannel){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,this._sendTransport.produceData({ordered:!1,maxPacketLifeTime:2e3,label:"bot",priority:"medium",appData:{info:"my-bot-DataProducer"}});case 6:this._botDataProducer=e.sent,this._botDataProducer.on("transportclose",(function(){t._botDataProducer=null})),this._botDataProducer.on("open",(function(){pt.log.INFO('bot DataProducer "open" event')})),this._botDataProducer.on("close",(function(){t._botDataProducer=null})),this._botDataProducer.on("error",(function(e){pt.log.ERROR('bot DataProducer "error" event:%o',e)})),this._botDataProducer.on("bufferedamountlow",(function(){pt.log.INFO('bot DataProducer "bufferedamountlow" event')})),e.next=18;break;case 14:throw e.prev=14,e.t0=e.catch(3),pt.log.ERROR("enableBotDataProducer() | failed:%o",e.t0),e.t0;case 18:case"end":return e.stop()}}),e,this,[[3,14]])}))),function(){return N.apply(this,arguments)})},{key:"disableWebcam",value:(A=Jt(Yt().mark((function e(){return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._webcamProducer){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,this._webcamProducer.close(),e.next=6,this.request("closeProducer",{producerId:this._webcamProducer.id});case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),pt.log.INFO("Error closing server-side webcam Producer: ".concat(e.t0));case 11:this._webcamProducer=null;case 12:case"end":return e.stop()}}),e,this,[[2,8]])}))),function(){return A.apply(this,arguments)})},{key:"disableMic",value:(M=Jt(Yt().mark((function e(){return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._micProducer){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,this._micProducer.close(),e.next=6,this.request("closeProducer",{producerId:this._micProducer.id});case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),pt.log.INFO("Error closing server-side mic Producer: ".concat(e.t0));case 11:this._micProducer=null;case 12:case"end":return e.stop()}}),e,this,[[2,8]])}))),function(){return M.apply(this,arguments)})},{key:"muteVideo",value:(I=Jt(Yt().mark((function e(){return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this._webcamProducer.pause(),e.next=4,this.request("pauseProducer",{producerId:this._webcamProducer.id});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),pt.log.ERROR("muteMic() | failed: %o",e.t0);case 9:case"end":return e.stop()}}),e,this,[[0,6]])}))),function(){return I.apply(this,arguments)})},{key:"unmuteVideo",value:(L=Jt(Yt().mark((function e(){return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this._webcamProducer.resume(),e.next=4,this.request("resumeProducer",{producerId:this._webcamProducer.id});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),pt.log.ERROR("unmuteMic() | failed: %o",e.t0);case 9:case"end":return e.stop()}}),e,this,[[0,6]])}))),function(){return L.apply(this,arguments)})},{key:"muteMic",value:(D=Jt(Yt().mark((function e(){return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this._micProducer.pause(),e.next=4,this.request("pauseProducer",{producerId:this._micProducer.id});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),pt.log.ERROR("muteMic() | failed: %o",e.t0);case 9:case"end":return e.stop()}}),e,this,[[0,6]])}))),function(){return D.apply(this,arguments)})},{key:"unmuteMic",value:(j=Jt(Yt().mark((function e(){return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this._micProducer.resume(),e.next=4,this.request("resumeProducer",{producerId:this._micProducer.id});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),pt.log.ERROR("unmuteMic() | failed: %o",e.t0);case 9:case"end":return e.stop()}}),e,this,[[0,6]])}))),function(){return j.apply(this,arguments)})},{key:"_pauseConsumer",value:(T=Jt(Yt().mark((function e(t){return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&!t.paused){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,this.request("pauseConsumer",{consumerId:t.id});case 5:t.pause(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),pt.log.ERROR("_pauseConsumer() | failed:%o",e.t0);case 11:case"end":return e.stop()}}),e,this,[[2,8]])}))),function(e){return T.apply(this,arguments)})},{key:"_resumeConsumer",value:(E=Jt(Yt().mark((function e(t){return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.paused){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,this.request("resumeConsumer",{consumerId:t.id});case 5:t.resume(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),pt.log.ERROR("_resumeConsumer() | failed:%o",e.t0);case 11:case"end":return e.stop()}}),e,this,[[2,8]])}))),function(e){return E.apply(this,arguments)})},{key:"request",value:function(e,t){return this.socket.request(e,t)}},{key:"send",value:function(e,t,r,n){if(void 0===this.socket)return lt(n,$e.ERROR_CODES.INVALID_OPERATION);try{this.socket.request(e,t).then((function(e){lt(r,e)})).catch((function(e){lt(n,e)}))}catch(e){lt(n,$e.ERROR_CODES.SOCKET_ERROR)}}},{key:"changeWebcam",value:(O=Jt(Yt().mark((function e(){var t,r,n,o,i,a;return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return pt.log.INFO("changeWebcam()"),e.prev=1,e.next=4,this._updateWebcams();case 4:if(t=Array.from(this._webcams.keys()),r=t.length,n=this._webcam.device?this._webcam.device.deviceId:void 0,(o=t.indexOf(n))<r-1?o++:o=0,this._webcam.device=this._webcams.get(t[o]),this._webcam.resolution="hd",this._webcam.device){e.next=13;break}throw new Error("no webcam devices");case 13:return this._webcamProducer.track.stop(),e.next=16,navigator.mediaDevices.getUserMedia({video:Ht({deviceId:{exact:this._webcam.device.deviceId}},ze[this._webcam.resolution])});case 16:return i=e.sent,a=i.getVideoTracks()[0],e.next=20,this._webcamProducer.replaceTrack({track:a});case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(1),pt.log.ERROR("changeWebcam() | failed: %o",e.t0);case 25:case"end":return e.stop()}}),e,this,[[1,22]])}))),function(){return O.apply(this,arguments)})},{key:"_updateWebcams",value:(C=Jt(Yt().mark((function e(){var t,r,n,o,i,a,s;return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return pt.log.INFO("_updateWebcams()"),this._webcams=new Map,e.next=4,navigator.mediaDevices.enumerateDevices();case 4:t=e.sent,r=zt(t),e.prev=6,r.s();case 8:if((n=r.n()).done){e.next=15;break}if("videoinput"===(o=n.value).kind){e.next=12;break}return e.abrupt("continue",13);case 12:this._webcams.set(o.deviceId,o);case 13:e.next=8;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(6),r.e(e.t0);case 20:return e.prev=20,r.f(),e.finish(20);case 23:i=Array.from(this._webcams.values()),a=i.length,s=this._webcam.device?this._webcam.device.deviceId:void 0,pt.log.INFO("_updateWebcams() [webcams:%o]",i),0===a?this._webcam.device=null:this._webcams.has(s)||(this._webcam.device=i[0]);case 28:case"end":return e.stop()}}),e,this,[[6,17,20,23]])}))),function(){return C.apply(this,arguments)})},{key:"changeWebcamResolution",value:(P=Jt(Yt().mark((function e(){var t,r;return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:pt.log.INFO("changeWebcamResolution()"),e.prev=1,e.t0=this._webcam.resolution,e.next="qvga"===e.t0?5:"vga"===e.t0?7:"hd"===e.t0?9:11;break;case 5:return this._webcam.resolution="vga",e.abrupt("break",12);case 7:return this._webcam.resolution="hd",e.abrupt("break",12);case 9:return this._webcam.resolution="qvga",e.abrupt("break",12);case 11:this._webcam.resolution="hd";case 12:return e.next=14,navigator.mediaDevices.getUserMedia({video:Ht({deviceId:{exact:this._webcam.device.deviceId}},ze[this._webcam.resolution])});case 14:return t=e.sent,r=t.getVideoTracks()[0],e.next=18,this._webcamProducer.replaceTrack({track:r});case 18:e.next=23;break;case 20:e.prev=20,e.t1=e.catch(1),pt.log.ERROR("changeWebcamResolution() | failed: %o",e.t1);case 23:case"end":return e.stop()}}),e,this,[[1,20]])}))),function(){return P.apply(this,arguments)})},{key:"restartIce",value:(R=Jt(Yt().mark((function e(){var t,r;return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this._sendTransport){e.next=7;break}return e.next=4,this.request("restartIce",{transportId:this._sendTransport.id});case 4:return t=e.sent,e.next=7,this._sendTransport.restartIce({iceParameters:t});case 7:if(!this._recvTransport){e.next=13;break}return e.next=10,this.request("restartIce",{transportId:this._recvTransport.id});case 10:return r=e.sent,e.next=13,this._recvTransport.restartIce({iceParameters:r});case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),pt.log.ERROR("restartIce() | failed:%o",e.t0);case 18:case"end":return e.stop()}}),e,this,[[0,15]])}))),function(){return R.apply(this,arguments)})},{key:"setMaxSendingSpatialLayer",value:(x=Jt(Yt().mark((function e(t){return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(pt.log.INFO("setMaxSendingSpatialLayer() [spatialLayer:%s]",t),e.prev=1,!this._webcamProducer){e.next=7;break}return e.next=5,this._webcamProducer.setMaxSpatialLayer(t);case 5:e.next=10;break;case 7:if(!this._shareProducer){e.next=10;break}return e.next=10,this._shareProducer.setMaxSpatialLayer(t);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),pt.log.ERROR("setMaxSendingSpatialLayer() | failed:%o",e.t0);case 15:case"end":return e.stop()}}),e,this,[[1,12]])}))),function(e){return x.apply(this,arguments)})},{key:"setConsumerPreferredLayers",value:(k=Jt(Yt().mark((function e(t,r,n){return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.request("setConsumerPreferredLayers",{consumerId:t,spatialLayer:r,temporalLayer:n});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),pt.log.ERROR("setConsumerPreferredLayers() | failed:%o",e.t0);case 8:case"end":return e.stop()}}),e,this,[[0,5]])}))),function(e,t,r){return k.apply(this,arguments)})},{key:"setConsumerPriority",value:(S=Jt(Yt().mark((function e(t,r){return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.request("setConsumerPriority",{consumerId:t,priority:r});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),pt.log.ERROR("setConsumerPriority() | failed:%o",e.t0);case 8:case"end":return e.stop()}}),e,this,[[0,5]])}))),function(e,t){return S.apply(this,arguments)})},{key:"requestConsumerKeyFrame",value:(_=Jt(Yt().mark((function e(t){return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.request("requestConsumerKeyFrame",{consumerId:t});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),pt.log.ERROR("requestConsumerKeyFrame() | failed:%o",e.t0);case 8:case"end":return e.stop()}}),e,this,[[0,5]])}))),function(e){return _.apply(this,arguments)})},{key:"sendChatMessage",value:(w=Jt(Yt().mark((function e(t){return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._chatDataProducer){e.next=2;break}return e.abrupt("return");case 2:try{this._chatDataProducer.send(t)}catch(e){pt.log.ERROR("chat DataProducer.send() failed:%o",e)}case 3:case"end":return e.stop()}}),e,this)}))),function(e){return w.apply(this,arguments)})},{key:"sendBotMessage",value:(b=Jt(Yt().mark((function e(t){return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._botDataProducer){e.next=2;break}return e.abrupt("return");case 2:try{this._botDataProducer.send(t)}catch(e){pt.log.ERROR("bot DataProducer.send() failed:%o",e)}case 3:case"end":return e.stop()}}),e,this)}))),function(e){return b.apply(this,arguments)})},{key:"changeDisplayName",value:(g=Jt(Yt().mark((function e(t){return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.request("changeDisplayName",{displayName:t});case 3:this._displayName=t,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),pt.log.ERROR("changeDisplayName() | failed: %o",e.t0);case 9:case"end":return e.stop()}}),e,this,[[0,6]])}))),function(e){return g.apply(this,arguments)})},{key:"getSendTransportRemoteStats",value:(y=Jt(Yt().mark((function e(){return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(pt.log.INFO("getSendTransportRemoteStats()"),this._sendTransport){e.next=3;break}return e.abrupt("return");case 3:return e.abrupt("return",this.request("getTransportStats",{transportId:this._sendTransport.id}));case 4:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"getRecvTransportRemoteStats",value:(v=Jt(Yt().mark((function e(){return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._recvTransport){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",this.request("getTransportStats",{transportId:this._recvTransport.id}));case 3:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"getAudioRemoteStats",value:(m=Jt(Yt().mark((function e(){return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._micProducer){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",this.request("getProducerStats",{producerId:this._micProducer.id}));case 3:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"getVideoRemoteStats",value:(h=Jt(Yt().mark((function e(){var t;return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._webcamProducer||this._shareProducer){e.next=3;break}return e.abrupt("return");case 3:return e.abrupt("return",this.request("getProducerStats",{producerId:t.id}));case 4:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"getConsumerRemoteStats",value:(f=Jt(Yt().mark((function e(t){return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._consumers.get(t)){e.next=3;break}return e.abrupt("return");case 3:return e.abrupt("return",this.request("getConsumerStats",{consumerId:t}));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"getChatDataProducerRemoteStats",value:(d=Jt(Yt().mark((function e(){var t;return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._chatDataProducer){e.next=3;break}return e.abrupt("return");case 3:return e.abrupt("return",this.request("getDataProducerStats",{dataProducerId:t.id}));case 4:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"getBotDataProducerRemoteStats",value:(l=Jt(Yt().mark((function e(){var t;return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._botDataProducer){e.next=3;break}return e.abrupt("return");case 3:return e.abrupt("return",this.request("getDataProducerStats",{dataProducerId:t.id}));case 4:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"getDataConsumerRemoteStats",value:(p=Jt(Yt().mark((function e(t){return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._dataConsumers.get(t)){e.next=3;break}return e.abrupt("return");case 3:return e.abrupt("return",this.request("getDataConsumerStats",{dataConsumerId:t}));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"getSendTransportLocalStats",value:(u=Jt(Yt().mark((function e(){return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._sendTransport){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",this._sendTransport.getStats());case 3:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"getRecvTransportLocalStats",value:(c=Jt(Yt().mark((function e(){return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._recvTransport){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",this._recvTransport.getStats());case 3:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"getAudioLocalStats",value:(s=Jt(Yt().mark((function e(){return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._micProducer){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",this._micProducer.getStats());case 3:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"getVideoLocalStats",value:(a=Jt(Yt().mark((function e(){var t;return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._webcamProducer||this._shareProducer){e.next=3;break}return e.abrupt("return");case 3:return e.abrupt("return",t.getStats());case 4:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"getConsumerLocalStats",value:(i=Jt(Yt().mark((function e(t){var r;return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this._consumers.get(t)){e.next=3;break}return e.abrupt("return");case 3:return e.abrupt("return",r.getStats());case 4:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"applyNetworkThrottle",value:(o=Jt(Yt().mark((function e(t){var r,n,o,i;return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.uplink,n=t.downlink,o=t.rtt,i=t.secret,e.prev=1,e.next=4,this.request("applyNetworkThrottle",{uplink:r,downlink:n,rtt:o,secret:i});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),pt.log.ERROR("applyNetworkThrottle() | failed:%o",e.t0);case 9:case"end":return e.stop()}}),e,this,[[1,6]])}))),function(e){return o.apply(this,arguments)})},{key:"resetNetworkThrottle",value:(n=Jt(Yt().mark((function e(t){var r,n,o;return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.silent,n=void 0!==r&&r,o=t.secret,e.prev=1,e.next=4,this.request("resetNetworkThrottle",{secret:o});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),n||pt.log.ERROR("resetNetworkThrottle() | failed:%o",e.t0);case 9:case"end":return e.stop()}}),e,this,[[1,6]])}))),function(e){return n.apply(this,arguments)})},{key:"_getWebcamType",value:function(e){return/(back|rear)/i.test(e.label)?(pt.log.INFO("_getWebcamType() | it seems to be a back camera"),"back"):(pt.log.INFO("_getWebcamType() | it seems to be a front camera"),"front")}},{key:"disconnect",value:function(){this.socket&&this.socket.close(),this.socket=void 0,this.client=null,this.ioSuccessFN=null,this.ioFailedFN=null,window.clearTimeout(this.timeRelink),this.close()}},{key:"close",value:function(){this._sendTransport&&this._sendTransport.close(),this._recvTransport&&this._recvTransport.close()}}],r&&Xt(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function er(e){return er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},er(e)}function tr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==er(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==er(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===er(o)?o:String(o)),n)}var o}function rr(e,t){return rr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},rr(e,t)}function nr(e){return nr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},nr(e)}const or=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rr(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=nr(n);if(o){var r=nr(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===er(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this)).options=e||{},t.localStreams={},t.remoteStreams={},t.socket=void 0,t.state=0,t.host="",t.mode=t.options.mode,t.timers={},t.attemps=1,t}return t=a,r=[{key:"init",value:function(e,t,r){var n=e.appID,o=e.host;if(pt.log.INFO([n,o],this),!o||"string"!=typeof o)return lt(r,Ke.ERRORS.NO_SOCKET_HOST_PARAM);this.appID=n,this.host=o,this.socket=new Zt,lt(t)}},{key:"join",value:function(e,t,r,n,o){var i=this;if(0!==this.state)return lt(o,$e.ERROR_CODES.INVALID_OPERATION);this.token=e,this.uid=r,this.channel=t,this.state=1,this.socket.connect(this,(function(e){i.uid=e,i.state=2,lt(n,i.uid)}),(function(e){lt(o,e)}))}},{key:"leave",value:function(e,t){if(2!==this.state)return lt(t,$e.ERROR_CODES.INVALID_OPERATION);for(var r in this.localStreams)if(ht(this.localStreams,r)){var n=this.localStreams[r];delete this.localStreams[r],void 0!==n.pc&&n.pc&&n.pc.close&&n.pc.close(),n.pc=void 0}for(var o in this.remoteStreams)if(ht(this.remoteStreams,o)){var i=this.remoteStreams[o];delete this.remoteStreams[o],void 0!==i.pc&&i.pc&&i.pc.close&&i.pc.close(),i.pc=void 0}try{this.state=0,this.socket.disconnect(),this.socket=void 0,lt(e)}catch(e){lt(t,e)}}},{key:"publish",value:function(e,t,r){var n=this;return"object"!==er(e)||null===e||null===e.stream&&void 0===e.url?lt(r,$e.ERROR_CODES.INVALID_LOCAL_STREAM):2!==this.state?lt(r,$e.ERROR_CODES.INVALID_OPERATION):!e.local||this.localStreams[e.getId()]?lt(r,$e.ERROR_CODES.INVALID_LOCAL_STREAM):e.hasAudio()||e.hasVideo()||e.hasScreen()?(this.localStreams[e.getId()]=e,e.pc={},e.pc.close=function(){},e.pc.onsignalingmessage=function(r){e.onClose=function(){n.unpublish(r)},e.unmuteAudio=function(){n.socket.unmuteMic()},e.unmuteVideo=function(){n.socket.unmuteVideo()},e.muteAudio=function(){n.socket.muteMic()},e.muteVideo=function(){n.socket.muteVideo()};var o=Rt({type:"stream-published",stream:n.localStreams[e.getId()]});n.dispatchEvent(o),lt(t)},void this.socket._produceRoom(e,r)):lt(r,$e.ERROR_CODES.INVALID_LOCAL_STREAM)}},{key:"unpublish",value:function(e,t,r){var n=this;return"object"!==er(e)||null===e||null===e.stream&&void 0===e.url?lt(r,$e.ERROR_CODES.INVALID_LOCAL_STREAM):2!==this.state?lt(r,$e.ERROR_CODES.INVALID_OPERATION):e.local&&this.localStreams[e.getId()]?void this.socket._unProduceRoom(e,(function(){delete n.localStreams[e.getId()],(e.hasAudio()||e.hasVideo()||e.hasScreen())&&void 0!==e.pc&&(e.pc.close&&e.pc.close(),e.pc=void 0),e.onClose=void 0,e.unmuteAudio=void 0,e.muteAudio=void 0,e.unmuteVideo=void 0,e.muteVideo=void 0,lt(t)}),r):lt(r,$e.ERROR_CODES.INVALID_LOCAL_STREAM)}},{key:"subscribe",value:function(e,t,r){var n=this;return"object"!==er(e)||null===e?lt(r,$e.ERROR_CODES.INVALID_REMOTE_STREAM):2!==this.state?lt(r,$e.ERROR_CODES.INVALID_OPERATION):e.local?lt(r,$e.ERROR_CODES.INVALID_REMOTE_STREAM):e.hasAudio()||e.hasVideo()||e.hasScreen()?(e.pc={},e.pc.close=function(){window.clearTimeout(e.timerSubscribedEvent),e.timerSubscribedEvent=null},e.pc.onaddstream=function(r){var o=n.remoteStreams[e.getId()];o.stream=r.stream,e.unmuteAudio=function(){n.socket._resumeConsumer(e.audioConsumer),e.unmutePlayerAudio()},e.muteAudio=function(){n.socket._pauseConsumer(e.audioConsumer),e.mutePlayerAudio()},e.unmuteVideo=function(){n.socket._resumeConsumer(e.videoConsumer),e.unmutePlayerVideo()},e.muteVideo=function(){n.socket._pauseConsumer(e.videoConsumer),e.mutePlayerVideo()},window.clearTimeout(e.timerSubscribedEvent),e.timerSubscribedEvent=window.setTimeout((function(){!function(){pt.log.INFO(["play---remoteStream subscribed start",e.getId()],o);var t=Rt({type:"stream-subscribed",stream:n.remoteStreams[e.getId()]});n.dispatchEvent(t),pt.log.INFO(["play---remoteStream subscribed end",e.getId()],o)}(),lt(t)}),100)},void e.pc.onaddstream(e)):lt(r,$e.ERROR_CODES.INVALID_REMOTE_STREAM)}},{key:"unsubscribe",value:function(e,t,r){return"object"!==er(e)||null===e?lt(r,$e.ERROR_CODES.INVALID_REMOTE_STREAM):2!==this.state?lt(r,$e.ERROR_CODES.INVALID_OPERATION):e.local?lt(r,$e.ERROR_CODES.INVALID_REMOTE_STREAM):(e.pc&&e.pc.close&&e.pc.close(),e.close(),void lt(t))}},{key:"sendClientMessage",value:function(){var e=Rt({type:"definedMessage",stream:this,msg:arguments});this.dispatchEvent(e)}}],r&&tr(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(tt);function ir(e){return ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ir(e)}function ar(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==ir(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==ir(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===ir(o)?o:String(o)),n)}var o}const sr=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t||{},this.id=t.id,this.stream=t.stream,this.elementID=t.elementID,this.createDom()}var t,r;return t=e,(r=[{key:"destroy",value:function(){this.audio.pause();var e=document.body;void 0!==this.elementID&&(e=this.div.parentNode),e&&e.removeChild(this.div)}},{key:"createDom",value:function(){var e=document.createElement("audio");if(e.setAttribute("id","stream-audio"+this.id),e.setAttribute("style","width: 100%; height: 100%; position: absolute"),e.muted=!0,this.stream.local?e.volume=0:e.volume=1,void 0!==this.elementID){var t=document.getElementById("player_"+this.id);t||((t=document.createElement("div")).setAttribute("id","player_"+this.id),t.setAttribute("style","width: 100%; height: 100%; position: relative; overflow: hidden;")),t.appendChild(e),this.div=t,this.container=document.getElementById(this.elementID),this.container.appendChild(t)}else document.body.appendChild(e);this.audio=e;var r=this.stream.getAudioStream();pt.log.INFO("AudioPlayer attachMediaStream ",r),window.attachMediaStream(document.getElementById("stream-audio"+this.id),r)}},{key:"mediaPause",value:function(){this.audio.muted=!0,this.audio.pause()}},{key:"mediaResume",value:function(){this.stream.local?this.audio.volume=0:this.audio.volume=1,this.audio.muted=!1,this.audio.play()}},{key:"mediaPlay",value:function(){var e=this;return new Promise((function(t,r){return e.audio?e.audio.play().then((function(r){pt.log.INFO(["play-- audio.play() success",e.id],r),t(r||null)})).catch((function(r){pt.log.INFO(["play-- audio.play() failed:%o",e.id],r),t(r)})):t(null)}))}}])&&ar(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function cr(e){return cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cr(e)}function ur(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==cr(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==cr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===cr(o)?o:String(o)),n)}var o}const pr=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t||{},this.id=t.id,this.stream=t.stream,this.elementID=t.elementID,this.container=null,this.createDom()}var t,r;return t=e,(r=[{key:"destroy",value:function(){this.video.pause(),delete this.resizer;var e=document.body;void 0!==this.elementID&&(e=this.div.parentNode),e&&e.removeChild(this.div)}},{key:"createDom",value:function(){var e=document.getElementById("player_"+this.id);e||(e=document.createElement("div")).setAttribute("id","player_"+this.id),this.stream.video?e.setAttribute("style","width: 100%; height: 100%; position: relative; background-color: black; overflow: hidden;"):e.setAttribute("style","width: 100%; height: 100%; position: relative; overflow: hidden;");var t=document.createElement("video");t.setAttribute("id","stream-video"+this.id),this.stream.local&&!this.stream.screen?t.setAttribute("style","width: 100%; height: 100%; position: absolute; transform: rotateY(0deg);"):this.stream.video?t.setAttribute("style","width: 100%; height: 100%; position: absolute;"):t.setAttribute("style","width: 100%; height: 100%; position: absolute; display: none;"),t.muted=!0,t.setAttribute("playsinline",""),void 0!==this.elementID?(document.getElementById(this.elementID).appendChild(e),this.container=document.getElementById(this.elementID)):(document.body.appendChild(e),this.container=document.body),e.appendChild(t),this.div=e,this.video=t;var r=this.stream.getVideoStream();pt.log.INFO("VideoPlayer attachMediaStream",r),window.attachMediaStream(document.getElementById("stream-video"+this.id),r)}},{key:"resize",value:function(){var e=this.container.offsetWidth,t=this.container.offsetHeight;this.stream.screen?.75*e<t?(this.video.style.width=e+"px",this.video.style.height=.75*e+"px",this.video.style.top=-(.75*e/2-t/2)+"px",this.video.style.left="0px"):(this.video.style.height=t+"px",this.video.style.width=4/3*t+"px",this.video.style.left=-(4/3*t/2-e/2)+"px",this.video.style.top="0px"):e===this.containerWidth&&t===this.containerHeight||(.75*e>t?(this.video.style.width=e+"px",this.video.style.height=.75*e+"px",this.video.style.top=-(.75*e/2-t/2)+"px",this.video.style.left="0px"):(this.video.style.height=t+"px",this.video.style.width=4/3*t+"px",this.video.style.left=-(4/3*t/2-e/2)+"px",this.video.style.top="0px")),this.containerWidth=e,this.containerHeight=t}},{key:"mediaPause",value:function(){this.video.pause()}},{key:"mediaResume",value:function(){this.video.muted=!0,this.video.play()}},{key:"mediaPlay",value:function(){var e=this;return new Promise((function(t,r){return e.video?e.video.play().then((function(r){pt.log.INFO(["play-- video.play() success",e.id],r),t(r||null)})).catch((function(r){pt.log.INFO(["play-- video.play() failed:%o",e.id],r),t(r)})):t(null)}))}}])&&ur(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function lr(e){return lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lr(e)}function dr(){dr=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function p(e,t,r,n){var i=t&&t.prototype instanceof y?t:y,a=Object.create(i.prototype),s=new T(n||[]);return o(a,"_invoke",{value:P(e,r,s)}),a}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=p;var d="suspendedStart",f="suspendedYield",h="executing",m="completed",v={};function y(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(j([])));S&&S!==r&&n.call(S,a)&&(w=S);var k=b.prototype=y.prototype=Object.create(w);function x(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function R(e,t){function r(o,i,a,s){var c=l(e[o],e,i);if("throw"!==c.type){var u=c.arg,p=u.value;return p&&"object"==lr(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(p).then((function(e){u.value=e,a(u)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function P(t,r,n){var o=d;return function(i,a){if(o===h)throw new Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=C(s,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=h;var u=l(t,r,n);if("normal"===u.type){if(o=n.done?m:f,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=m,n.method="throw",n.arg=u.arg)}}}function C(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=l(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function j(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(lr(t)+" is not iterable")}return g.prototype=b,o(k,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,c,"GeneratorFunction")),e.prototype=Object.create(k),e},t.awrap=function(e){return{__await:e}},x(R.prototype),u(R.prototype,s,(function(){return this})),t.AsyncIterator=R,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new R(p(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},x(k),u(k,c,"Generator"),u(k,a,(function(){return this})),u(k,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=j,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;E(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:j(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),v}},t}function fr(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}var hr=function(){var e,t=(e=dr().mark((function e(t,r,n){var o;return dr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.getMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,pt.log.INFO("navigator getUserMedia",t),e.prev=2,t.screen){e.next=6;break}return navigator.getMedia(t,r,n),e.abrupt("return",!0);case 6:return e.next=8,navigator.mediaDevices.getDisplayMedia({audio:!1,video:{displaySurface:"monitor",logicalSurface:!0,cursor:!0,width:{max:1920},height:{max:1080},frameRate:{max:30}}});case 8:o=e.sent,t.audio?navigator.getMedia(t,(function(e){lt(r,o,e)}),n):lt(r,o),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),lt(n,e.t0);case 15:case"end":return e.stop()}}),e,null,[[2,12]])})),function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){fr(i,n,o,a,s,"next",e)}function s(e){fr(i,n,o,a,s,"throw",e)}a(void 0)}))});return function(e,r,n){return t.apply(this,arguments)}}();function mr(e){return mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mr(e)}function vr(){vr=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function p(e,t,r,n){var i=t&&t.prototype instanceof y?t:y,a=Object.create(i.prototype),s=new T(n||[]);return o(a,"_invoke",{value:P(e,r,s)}),a}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=p;var d="suspendedStart",f="suspendedYield",h="executing",m="completed",v={};function y(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(j([])));S&&S!==r&&n.call(S,a)&&(w=S);var k=b.prototype=y.prototype=Object.create(w);function x(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function R(e,t){function r(o,i,a,s){var c=l(e[o],e,i);if("throw"!==c.type){var u=c.arg,p=u.value;return p&&"object"==mr(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(p).then((function(e){u.value=e,a(u)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function P(t,r,n){var o=d;return function(i,a){if(o===h)throw new Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=C(s,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=h;var u=l(t,r,n);if("normal"===u.type){if(o=n.done?m:f,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=m,n.method="throw",n.arg=u.arg)}}}function C(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=l(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function j(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(mr(t)+" is not iterable")}return g.prototype=b,o(k,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,c,"GeneratorFunction")),e.prototype=Object.create(k),e},t.awrap=function(e){return{__await:e}},x(R.prototype),u(R.prototype,s,(function(){return this})),t.AsyncIterator=R,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new R(p(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},x(k),u(k,c,"Generator"),u(k,a,(function(){return this})),u(k,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=j,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;E(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:j(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),v}},t}function yr(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function gr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==mr(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==mr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===mr(o)?o:String(o)),n)}var o}const br=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n,o;return t=e,r=[{key:"getUserMedia",value:(n=vr().mark((function e(t,r,n){return vr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",hr(t,r,n));case 1:case"end":return e.stop()}}),e)})),o=function(){var e=this,t=arguments;return new Promise((function(r,o){var i=n.apply(e,t);function a(e){yr(i,r,o,a,s,"next",e)}function s(e){yr(i,r,o,a,s,"throw",e)}a(void 0)}))},function(e,t,r){return o.apply(this,arguments)})},{key:"getDevices",value:function(e){navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices().then((function(t){e(t)}))}},{key:"checkSystemRequirements",value:function(){}},{key:"createClient",value:function(){return new or(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}},{key:"createStream",value:function(){return new xt(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}},{key:"videoPlayer",value:function(){return new pr(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}},{key:"audioPlayer",value:function(){return new sr(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}}],r&&gr(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function wr(e){return wr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wr(e)}function _r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==wr(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==wr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===wr(o)?o:String(o)),n)}var o}function Sr(e,t){return Sr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Sr(e,t)}function kr(e){return kr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},kr(e)}window.AdapterJS=Ce,window.io=u(),pt.log.INFO([null,window],window);var xr={},Rr={},Pr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Sr(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=kr(n);if(o){var r=kr(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===wr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(e=i.call(this)).VERSION="1.0.0",a.setInitOptions(t),e}return t=a,r=[{key:"getInitOptions",value:function(){return xr}},{key:"setInitOptions",value:function(e){xr=e}},{key:"setUserInitOptions",value:function(e){Rr=e}},{key:"getUserInitOptions",value:function(){return Rr}}],null&&_r(t.prototype,null),r&&_r(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(br);window.GmRTC=new Pr;const Cr=window.GmRTC})(),n})()));